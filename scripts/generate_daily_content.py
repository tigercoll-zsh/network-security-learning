#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
生成 90 天的每日学习卡片 Markdown 文件。
每个文件包含：目标、内容、实践任务、巩固、评估标准、学习成果达成情况。
默认输出到 ../daily/ 目录，可通过参数指定开始日期与目录。

使用：
    python scripts/generate_daily_content.py -s 2025-12-25 -o ./daily

注意：本脚本仅生成学习卡片文本，不包含任何非法或未授权的攻击指令。
所有实验应在合法授权与自建靶场范围内进行。
"""

import argparse
import datetime
import os
from textwrap import dedent

# 课程数据：按天详细内容（90 天）
# 为保证“详细完整”，每一天给出模块、主题、目标、内容要点、实践任务、巩固与评估标准。
# 学习成果达成情况留给学习者每日填写。

CURRICULUM = [
    # Week 1
    {
        "day": 1,
        "module": "网络与协议基础",
        "topic": "网络总览与模型",
        "objectives": [
            "理解 OSI 与 TCP/IP 模型的层次与职责",
            "认识常用网络术语（主机、接口、路由、网关、子网等）",
        ],
        "content": [
            "阅读：OSI 七层与 TCP/IP 四层模型概述",
            "理解数据在各层的封装与解封装过程",
            "认识网络路径与转发的基本概念（路由与交换）",
        ],
        "labs": [
            "在本机使用 ipconfig/ifconfig 查看网络配置，识别网关与子网掩码",
            "画出本地网络示意图（主机、交换机/路由器、网关）",
        ],
        "reinforce": [
            "用自己的话总结 OSI 与 TCP/IP 的层级映射",
            "小测：指出 HTTP/TCP/IP/以太网分别位于哪一层",
        ],
        "criteria": [
            "能正确解释每层的职责并给出示例协议",
            "能根据输出识别本机网络的关键参数",
        ],
    },
    {
        "day": 2,
        "module": "网络与协议基础",
        "topic": "以太网、MAC 与 ARP",
        "objectives": [
            "理解二层寻址（MAC）与 ARP 的工作流程",
            "认识广播域与交换机学习机制（理论）",
        ],
        "content": [
            "ARP 请求/应答报文结构与作用",
            "交换机的 MAC 地址表与转发决策（理论）",
        ],
        "labs": [
            "使用 Wireshark 抓取本地 ARP 流量并标注字段",
            "在受控网络中观察 ARP 缓存（arp -a），理解条目含义",
        ],
        "reinforce": [
            "问答：为何需要 ARP？它解决了什么问题？",
            "练习：识别抓包中 ARP 的请求/应答并解释发送者/目标字段",
        ],
        "criteria": [
            "能在抓包中准确定位与解释 ARP 报文",
            "能说明 ARP 工作原理与安全注意事项（仅理论）",
        ],
    },
    {
        "day": 3,
        "module": "网络与协议基础",
        "topic": "IP、ICMP 与路由基础",
        "objectives": [
            "理解 IP 寻址与子网划分",
            "掌握 Ping/Traceroute 的用途与差异",
        ],
        "content": [
            "IPv4 地址、子网掩码、网关与路由表",
            "ICMP Echo 与 Traceroute 工作机理（不同实现）",
        ],
        "labs": [
            "在本机查看路由表（route print / ip route）并解释默认路由",
            "使用 ping 与 tracert/traceroute 分析到指定合法目标（如公共 DNS）的路径",
        ],
        "reinforce": [
            "题目：给出一个网段，计算可用主机数与广播地址",
            "总结：Traceroute 报文 TTL 的作用",
        ],
        "criteria": [
            "能正确读取并解释本机路由表",
            "能画出到目标的路径示意并解释跳数",
        ],
    },
    {
        "day": 4,
        "module": "网络与协议基础",
        "topic": "TCP/UDP 与会话",
        "objectives": [
            "掌握 TCP 三次握手与四次挥手",
            "理解 UDP 的无连接特性与适用场景",
        ],
        "content": [
            "TCP 状态机：SYN、SYN-ACK、ACK；FIN/ACK",
            "端口与会话标识（五元组）",
        ],
        "labs": [
            "Wireshark 观察浏览器访问站点的 TCP 握手与挥手",
            "构造 UDP 流量（如 DNS 查询）并抓包对比 TCP",
        ],
        "reinforce": [
            "题目：为什么有些应用更适合 UDP？举例说明",
            "练习：从抓包中提取一个 TCP 会话的五元组",
        ],
        "criteria": [
            "能准确解释握手/挥手报文字段及顺序",
            "能清晰区分 TCP 与 UDP 的差异",
        ],
    },
    {
        "day": 5,
        "module": "网络与协议基础",
        "topic": "DNS 工作流",
        "objectives": [
            "理解解析流程与常见记录类型（A/AAAA/CNAME/MX/TXT）",
            "能抓包与解释一次 DNS 解析",
        ],
        "content": [
            "递归与迭代解析；根、TLD、权威服务器的角色",
            "缓存与 TTL 的作用",
        ],
        "labs": [
            "抓取对一个域名的查询与响应，标注查询类型与响应记录",
            "使用 nslookup/dig 执行不同类型查询并记录结果",
        ],
        "reinforce": [
            "题目：CNAME 与 A 记录的关系是什么？",
            "练习：解释一次失败解析的可能原因",
        ],
        "criteria": [
            "能独立分析一条 DNS 查询的全过程",
            "能说明 TTL 对缓存的影响",
        ],
    },
    {
        "day": 6,
        "module": "网络与协议基础",
        "topic": "HTTP 基础",
        "objectives": [
            "理解请求/响应结构与常见头部",
            "认识明文 HTTP 的安全风险",
        ],
        "content": [
            "方法（GET/POST/PUT/DELETE）、状态码、头部与正文",
            "Cookie/Session 的基本概念（预告后续深入）",
        ],
        "labs": [
            "抓包一次 HTTP 请求，标注方法、路径、头部与响应码",
            "在本地搭建一个简单 HTTP 服务并访问观察",
        ],
        "reinforce": [
            "题目：301 与 302 的区别是什么？",
            "练习：写出 5 个常见 HTTP 请求头并解释作用",
        ],
        "criteria": [
            "能熟练阅读请求/响应报文",
            "能说明为何生产环境优先使用 HTTPS",
        ],
    },
    {
        "day": 7,
        "module": "网络与协议基础",
        "topic": "Wireshark 入门与综合分析",
        "objectives": [
            "熟练使用过滤器（显示/捕获）",
            "完成一次综合流量分析与报告",
        ],
        "content": [
            "常用过滤表达式（ip.addr、tcp.port、http）",
            "导出/标注/书签与报告导出",
        ],
        "labs": [
            "捕获包含 DNS、HTTP、TCP 握手的综合流量并标注关键报文",
            "输出一份简短分析报告（含截图）",
        ],
        "reinforce": [
            "练习：为常见分析场景编写 5 条过滤表达式",
            "自测：解释一次异常重传与超时的可能原因",
        ],
        "criteria": [
            "能独立完成抓包过滤与标注",
            "提交一份结构清晰的分析报告",
        ],
    },

    # Week 2
    {
        "day": 8,
        "module": "安全协议与加密",
        "topic": "TLS 概念与握手",
        "objectives": [
            "理解 TLS 握手流程与密码套件的作用",
            "识别握手中的关键消息（ClientHello/ServerHello 等）",
        ],
        "content": [
            "TLS 版本与弃用状况（如 TLS 1.0/1.1）",
            "握手阶段与会话密钥协商",
        ],
        "labs": [
            "抓取一次 HTTPS 握手并标注关键消息类型",
            "使用 openssl s_client 查看服务器支持的套件/证书信息",
        ],
        "reinforce": [
            "题目：前向保密（PFS）的意义是什么？",
            "练习：解释一次握手失败的常见原因",
        ],
        "criteria": [
            "能在抓包与 openssl 输出中定位关键信息",
            "能阐述密码套件选择的安全影响",
        ],
    },
    {
        "day": 9,
        "module": "安全协议与加密",
        "topic": "证书与信任链",
        "objectives": [
            "理解证书、CA、链验证与撤销",
            "会用 OpenSSL 检查证书与链",
        ],
        "content": [
            "X.509 证书结构与常见字段（CN/SAN/KeyUsage）",
            "CRL/OCSP 与撤销机制",
        ],
        "labs": [
            "用 openssl x509 -in cert.pem -text 查看证书细节",
            "验证链与主机名匹配；观察 SAN 字段",
        ],
        "reinforce": [
            "题目：为何不再使用仅 CN 的匹配？",
            "练习：给出一个证书，指出其有效期与用途",
        ],
        "criteria": [
            "能检查证书并解释关键字段",
            "能说明链验证失败的常见原因",
        ],
    },
    {
        "day": 10,
        "module": "安全协议与加密",
        "topic": "HTTPS 抓包与安全特性",
        "objectives": [
            "认识 HTTPS 加密不可见正文的特性",
            "理解 HSTS 的作用（理论）",
        ],
        "content": [
            "HTTPS 抓包的关注点：握手、证书、加密套件",
            "中间人攻击的理论风险与防护（仅理论）",
        ],
        "labs": [
            "抓取访问常见站点的 HTTPS 流量并记录握手细节",
            "比较两个站点的证书链与套件差异",
        ],
        "reinforce": [
            "题目：为什么抓包看不到 HTTPS 正文？",
            "练习：解释 HSTS 的效果与限制",
        ],
        "criteria": [
            "能清晰描述 HTTPS 分析的关注点",
            "能解释关键安全特性的意义",
        ],
    },
    {
        "day": 11,
        "module": "安全协议与加密",
        "topic": "SSH 与密钥认证",
        "objectives": [
            "理解 SSH 工作原理与密钥认证流程",
            "掌握基本安全配置建议",
        ],
        "content": [
            "SSH 协议握手与 HostKey 验证",
            "禁用密码登录、仅允许强密钥、限制用户/来源",
        ],
        "labs": [
            "在自建 Linux 虚拟机上配置 SSH 密钥登录（授权范围）",
            "检查 sshd_config 中的关键安全项并记录",
        ],
        "reinforce": [
            "题目：为何建议禁用 root 直登？",
            "练习：生成 Ed25519 密钥并配置",
        ],
        "criteria": [
            "能完成密钥登录并说明配置项意义",
            "形成 SSH 加固检查清单",
        ],
    },
    {
        "day": 12,
        "module": "安全协议与加密",
        "topic": "加密基础：哈希/对称/非对称",
        "objectives": [
            "区分哈希、对称与非对称加密的用途",
            "理解签名与密钥交换的基本原理",
        ],
        "content": [
            "常见算法：SHA-2/3、AES、RSA、ECDSA、ChaCha20",
            "安全使用注意事项：盐、迭代、随机性",
        ],
        "labs": [
            "用 Python 对文本做哈希与校验",
            "生成密钥对并演示签名与验签",
        ],
        "reinforce": [
            "题目：哈希与加密的区别是什么？",
            "练习：简述一次签名流程",
        ],
        "criteria": [
            "能实现基础哈希与签名演示",
            "能说明各算法适用场景",
        ],
    },
    {
        "day": 13,
        "module": "安全协议与加密",
        "topic": "加密应用与场景",
        "objectives": [
            "理解加密在传输、存储与认证中的应用",
            "识别常见错误配置与风险",
        ],
        "content": [
            "传输层安全、静态数据加密、密码存储最佳实践",
            "密钥管理与轮换",
        ],
        "labs": [
            "对一个示例应用的密码存储进行安全性评估（理论/代码审阅）",
            "提出改进建议并记录",
        ],
        "reinforce": [
            "题目：为什么不能用明文或可逆加密存储密码？",
            "练习：设计一套密码存储策略",
        ],
        "criteria": [
            "能提出合理的密码存储改进建议",
            "形成应用加密检查清单",
        ],
    },
    {
        "day": 14,
        "module": "安全协议与加密",
        "topic": "周综合实验与测评",
        "objectives": [
            "完成 TLS/SSH/加密基础的整体验证",
            "形成一份周度总结报告",
        ],
        "content": [
            "回顾本周知识点与实验记录",
            "整理问题与改进项",
        ],
        "labs": [
            "选择 2-3 个场景进行复现与截图记录",
            "输出周报（含证据与结论）",
        ],
        "reinforce": [
            "题目：选择一项本周内容做 5 分钟讲解提纲",
            "练习：补充错题与易错点",
        ],
        "criteria": [
            "提交结构完整的周报",
            "覆盖关键知识点复现",
        ],
    },

    # Week 3 (sample entries, the rest will follow similar detail)
    {
        "day": 15,
        "module": "操作系统与脚本",
        "topic": "Linux 安全基础",
        "objectives": [
            "理解用户/组、权限、服务与日志基础",
            "会做基础加固（仅自建环境）",
        ],
        "content": [
            "用户/权限模型、sudo、安全日志位置",
            "服务管理与开机项",
        ],
        "labs": [
            "创建受限用户与最小权限配置",
            "查看/分析常见安全日志并记录",
        ],
        "reinforce": [
            "题目：解释 755/644 权限含义",
            "练习：写 5 条加固检查项",
        ],
        "criteria": [
            "完成最小权限配置与日志审阅",
            "形成加固清单",
        ],
    },
    {
        "day": 16,
        "module": "操作系统与脚本",
        "topic": "Windows 安全基础",
        "objectives": [
            "理解本地用户、组与权限模型",
            "掌握常见审计日志位置与查看方法",
            "认识服务与启动项的安全影响",
        ],
        "content": [
            "本地安全策略（secpol.msc）与事件查看器",
            "UAC、远程桌面与防火墙基础配置",
            "常见攻击面（SMB、RDP 等）的最小化暴露原则",
        ],
        "labs": [
            "创建受限用户并配置 UAC 安全级别，记录变更",
            "使用事件查看器定位登录事件与安全日志，并导出样例",
        ],
        "reinforce": [
            "题目：解释为何不建议启用匿名共享",
            "练习：列出 5 条 Windows 主机加固项并说明原因",
        ],
        "criteria": [
            "提交加固变更记录与日志截图",
            "能说明关键安全事件的含义与排查路径",
        ],
    },
    {
        "day": 17,
        "module": "操作系统与脚本",
        "topic": "Shell 脚本入门与批处理",
        "objectives": [
            "掌握基本语法：变量、条件、循环、函数",
            "能编写批量处理与日志整理脚本",
        ],
        "content": [
            "Bash 与 PowerShell 基本语法对照",
            "文本处理（grep/sed/awk）与管道组合",
        ],
        "labs": [
            "编写脚本批量解析日志，统计错误类型与次数",
            "将结果输出为 CSV 并按时间排序",
        ],
        "reinforce": [
            "题目：描述管道与重定向的区别",
            "练习：写出一个带函数与循环的实用脚本",
        ],
        "criteria": [
            "脚本可重复运行并生成正确的输出",
            "提交脚本与运行截图/结果文件",
        ],
    },
    {
        "day": 18,
        "module": "操作系统与脚本",
        "topic": "Python 脚本入门（文本与网络）",
        "objectives": [
            "能进行文件读写与正则匹配",
            "能发起 HTTP 请求并解析响应",
        ],
        "content": [
            "标准库：pathlib、re、json、urllib/requests（任选其一）",
            "基本异常处理与日志记录",
        ],
        "labs": [
            "编写脚本读取日志并用正则提取字段（时间/级别/消息）",
            "请求公开 API 并解析 JSON，输出关键信息",
        ],
        "reinforce": [
            "题目：简述 try/except 的用途与最佳实践",
            "练习：完成一个可配置的日志过滤器",
        ],
        "criteria": [
            "脚本能稳定运行并处理异常",
            "提交源码与示例输出",
        ],
    },
    {
        "day": 19,
        "module": "操作系统与脚本",
        "topic": "Nmap 端口扫描安全使用",
        "objectives": [
            "理解不同扫描方式与适用场景（仅授权环境）",
            "掌握常用参数与输出解析",
        ],
        "content": [
            "TCP SYN、TCP Connect、UDP 扫描差异",
            "服务版本识别（-sV）与脚本（-sC）",
        ],
        "labs": [
            "在自建靶场对目标进行端口扫描并导出结果",
            "编写解析脚本，将 Nmap 输出转换为结构化数据",
        ],
        "reinforce": [
            "题目：解释 -sS 与 -sT 的差异与影响",
            "练习：设计一套稳妥的扫描参数组合",
        ],
        "criteria": [
            "输出包含端口/服务/版本的清单",
            "记录授权范围与安全注意事项",
        ],
    },
    {
        "day": 20,
        "module": "操作系统与脚本",
        "topic": "服务枚举与指纹识别",
        "objectives": [
            "能识别常见服务的特征与版本",
            "能结合脚本实现批量枚举",
        ],
        "content": [
            "Banner 抓取、协议握手与响应解析",
            "组合使用 Nmap + 自编脚本进行指纹识别",
        ],
        "labs": [
            "针对靶场多个主机进行服务枚举并汇总",
            "输出版本矩阵与潜在风险提示（理论）",
        ],
        "reinforce": [
            "题目：为什么 Banner 可能不可靠？",
            "练习：用两种方法交叉验证版本信息",
        ],
        "criteria": [
            "提交服务矩阵与验证方法说明",
            "脚本化输出可复用",
        ],
    },
    {
        "day": 21,
        "module": "操作系统与脚本",
        "topic": "周综合实验与测评（OS+枚举+脚本）",
        "objectives": [
            "完成从主机加固到端口与服务枚举的闭环",
            "形成结构化周报与改进项",
        ],
        "content": [
            "回顾本周练习与脚本库",
            "整理问题、记录风险与建议",
        ],
        "labs": [
            "选择一台 Linux 与一台 Windows 完成加固与审计",
            "对靶场执行枚举并完成报告（含脚本与输出）",
        ],
        "reinforce": [
            "题目：总结本周最有价值的 3 条经验",
            "练习：完善脚本库的 README 与使用说明",
        ],
        "criteria": [
            "提交周报与证据链（截图/日志/脚本）",
            "明确后续优化计划",
        ],
    },

    # Week 4：漏洞扫描、基线与加固（Day022 ~ Day028）
    {
        "day": 22,
        "module": "漏洞扫描与基线",
        "topic": "漏洞类型与编号体系",
        "objectives": [
            "理解 CVE/CWE/CVSS 的含义与用途",
            "能根据 CVSS 评分初步判断风险等级",
        ],
        "content": [
            "常见漏洞类别（配置、逻辑、输入校验等）",
            "CVE 数据库与 CWE 类别，CVSS 各维度解释",
        ],
        "labs": [
            "选择 3 个 CVE 阅读官方描述与缓解建议",
            "为一个示例漏洞计算/解释 CVSS 分值",
        ],
        "reinforce": [
            "题目：CVSS 中的攻击向量与复杂度如何影响评分？",
            "练习：对一个案例做风险陈述",
        ],
        "criteria": [
            "提交分析笔记与评分解释",
            "能正确归类漏洞类型",
        ],
    },
    {
        "day": 23,
        "module": "漏洞扫描与基线",
        "topic": "扫描器安装与合规使用",
        "objectives": [
            "理解扫描器原理与探测方式",
            "能在授权靶场安全配置并运行",
        ],
        "content": [
            "扫描模式（轻量/深度）、认证扫描与无认证",
            "报告结构与误报/漏报的识别",
        ],
        "labs": [
            "在靶场运行一次基线扫描并导出报告",
            "标注 3 个高风险项并查阅修复建议",
        ],
        "reinforce": [
            "题目：如何区分误报与真风险？",
            "练习：编写报告摘要与处置建议",
        ],
        "criteria": [
            "输出扫描报告与关键项说明",
            "记录授权范围与合规声明",
        ],
    },
    {
        "day": 24,
        "module": "漏洞扫描与基线",
        "topic": "系统基线与审计",
        "objectives": [
            "掌握通用系统基线项（口令策略、补丁、服务）",
            "能执行脚本化检查并输出结果",
        ],
        "content": [
            "弱口令与口令策略、补丁与更新、暴露服务清单",
            "常见审计命令与脚本（Linux/Windows）",
        ],
        "labs": [
            "编写脚本检查本机/靶机的关键基线项并输出 CSV",
            "对异常项给出加固建议与记录",
        ],
        "reinforce": [
            "题目：列举 5 条常见基线项",
            "练习：设计检查脚本的可扩展结构",
        ],
        "criteria": [
            "提交检查脚本与输出文件",
            "对异常给出合理建议",
        ],
    },
    {
        "day": 25,
        "module": "漏洞扫描与基线",
        "topic": "Web 中间件暴露面与加固",
        "objectives": [
            "识别常见中间件的默认配置与风险",
            "能给出基础加固建议",
        ],
        "content": [
            "Nginx/Apache/IIS 的目录/头部/日志相关配置",
            "关闭目录列出、隐藏版本、限制方法与来源",
        ],
        "labs": [
            "在靶场中调整 Web 中间件配置并记录前后差异",
            "检查头部与暴露信息的变化（抓包/响应）",
        ],
        "reinforce": [
            "题目：为何建议隐藏版本信息？",
            "练习：给出一个安全的基础配置示例",
        ],
        "criteria": [
            "配置文件与验证截图齐备",
            "能说明加固项的影响",
        ],
    },
    {
        "day": 26,
        "module": "漏洞扫描与基线",
        "topic": "自动化基线检查与报告",
        "objectives": [
            "将基线检查与导出报告脚本化",
            "保证可复用与扩展",
        ],
        "content": [
            "脚本参数化与模块化设计",
            "导出为 CSV/JSON 并生成简要汇总",
        ],
        "labs": [
            "完善基线检查脚本，支持多主机批量输出",
            "生成汇总报告并标注异常项",
        ],
        "reinforce": [
            "题目：如何避免脚本硬编码？",
            "练习：加入日志与错误处理",
        ],
        "criteria": [
            "脚本具备参数与错误处理",
            "汇总报告结构清晰",
        ],
    },
    {
        "day": 27,
        "module": "漏洞扫描与基线",
        "topic": "加固复验与变更记录",
        "objectives": [
            "能复验加固效果并形成变更记录",
            "理解回归与兼容性风险",
        ],
        "content": [
            "复验流程与对比方法",
            "变更记录模板与审批流程（理论）",
        ],
        "labs": [
            "对前日加固项进行复验并记录差异",
            "形成变更记录与回滚策略",
        ],
        "reinforce": [
            "题目：如何处理加固引发的兼容问题？",
            "练习：撰写变更记录示例",
        ],
        "criteria": [
            "提交复验报告与变更记录",
            "能说明风险与回滚方案",
        ],
    },
    {
        "day": 28,
        "module": "漏洞扫描与基线",
        "topic": "周综合实验与测评（扫描+基线+加固）",
        "objectives": [
            "完成一次从扫描到加固的闭环",
            "输出结构化周报与改进清单",
        ],
        "content": [
            "汇总本周的报告与脚本",
            "梳理误报/漏报与处置策略",
        ],
        "labs": [
            "在靶场选择一个目标完成扫描、基线检查与加固复验",
            "提交完整报告与证据链",
        ],
        "reinforce": [
            "题目：本周最易忽视的风险是什么？",
            "练习：完善加固检查清单",
        ],
        "criteria": [
            "周报完整、逻辑清晰、证据充分",
            "提出可执行的改进计划",
        ],
    },

    # Week 5：日志、可观测性、SIEM 入门（Day029 ~ Day035）
    {
        "day": 29,
        "module": "日志与可观测性",
        "topic": "日志类型与字段规范",
        "objectives": [
            "识别不同类型日志及其关键字段",
            "理解规范化与合规要求的意义",
        ],
        "content": [
            "系统/应用/安全/访问日志的字段定义",
            "时间戳、主机名、用户、事件类型与上下文",
        ],
        "labs": [
            "采集两类日志并对字段进行标准化映射",
            "输出统一格式样例（JSON/CSV）",
        ],
        "reinforce": [
            "题目：为何需要统一字段？",
            "练习：设计一份日志规范草案",
        ],
        "criteria": [
            "提交规范草案与样例数据",
            "能说明规范化的好处",
        ],
    },
    {
        "day": 30,
        "module": "日志与可观测性",
        "topic": "收集与传输：Syslog/Filebeat 入门",
        "objectives": [
            "理解收集与传输链路",
            "能配置基础数据管道",
        ],
        "content": [
            "Syslog 协议与 Filebeat 采集配置",
            "缓冲与重试策略、简单过滤",
        ],
        "labs": [
            "搭建本地采集与转发（本机→收集端）",
            "验证数据到达与格式正确",
        ],
        "reinforce": [
            "题目：传输失败如何兜底？",
            "练习：加入简单的过滤规则",
        ],
        "criteria": [
            "数据端到端可见",
            "提交配置文件与验证截图",
        ],
    },
    {
        "day": 31,
        "module": "日志与可观测性",
        "topic": "存储与查询：Elastic/OpenSearch 概览",
        "objectives": [
            "理解索引与映射",
            "能执行基础查询与可视化",
        ],
        "content": [
            "索引设计、字段映射与分片副本",
            "查询 DSL 与聚合",
        ],
        "labs": [
            "创建索引并导入样例日志",
            "编写查询与聚合，制作一个简单图表",
        ],
        "reinforce": [
            "题目：映射不当会带来什么问题？",
            "练习：优化一个查询的性能",
        ],
        "criteria": [
            "索引与查询工作正常",
            "提交查询与图表截图",
        ],
    },
    {
        "day": 32,
        "module": "日志与可观测性",
        "topic": "可视化与告警策略",
        "objectives": [
            "搭建基础仪表盘",
            "设计简单告警规则",
        ],
        "content": [
            "关键指标选择与阈值设定",
            "告警抑制与噪声控制",
        ],
        "labs": [
            "创建一个仪表盘监控 3 项指标",
            "配置 2 条告警并触发验证",
        ],
        "reinforce": [
            "题目：如何减少告警噪声？",
            "练习：编写告警分级策略",
        ],
        "criteria": [
            "仪表盘可用，告警可触发",
            "提交策略说明与验证证据",
        ],
    },
    {
        "day": 33,
        "module": "日志与可观测性",
        "topic": "日志规范与字段统一",
        "objectives": [
            "将不同来源日志统一字段",
            "形成规范文档",
        ],
        "content": [
            "字段映射策略与标准化约定",
            "兼容与扩展考虑",
        ],
        "labs": [
            "将 2 种来源日志映射到统一规范并落地",
            "补充缺失字段与默认值策略",
        ],
        "reinforce": [
            "题目：统一字段对跨系统分析的意义？",
            "练习：为新增系统设计映射方案",
        ],
        "criteria": [
            "提交规范与映射样例",
            "验证查询可跨来源一致",
        ],
    },
    {
        "day": 34,
        "module": "日志与可观测性",
        "topic": "事件响应初步：从日志到推理",
        "objectives": [
            "能从日志中识别异常并初步推理",
            "形成简单处置建议",
        ],
        "content": [
            "常见异常模式与关联分析",
            "从告警到初步处置的流程",
        ],
        "labs": [
            "构造一段异常日志，进行定位与关联分析",
            "输出初步处置建议与证据",
        ],
        "reinforce": [
            "题目：如何避免误判？",
            "练习：完善证据链条",
        ],
        "criteria": [
            "提交分析与建议",
            "证据链条清晰",
        ],
    },
    {
        "day": 35,
        "module": "日志与可观测性",
        "topic": "周综合实验与测评（日志链路+告警）",
        "objectives": [
            "搭建从采集到告警的最小闭环",
            "形成周报与改进项",
        ],
        "content": [
            "回顾数据管道与规范化成果",
            "评估告警质量与噪声",
        ],
        "labs": [
            "演示一次异常的发现与告警触发",
            "提交管道配置与仪表盘截图",
        ],
        "reinforce": [
            "题目：总结本周告警优化策略",
            "练习：完善日志规范",
        ],
        "criteria": [
            "周报完整、证据充分",
            "提出可执行优化",
        ],
    },

    # Week 6：Web 安全（OWASP Top 10）（Day036 ~ Day042）
    {
        "day": 36,
        "module": "Web 安全",
        "topic": "OWASP 与威胁建模基础",
        "objectives": [
            "理解 OWASP Top 10 范畴与意义",
            "掌握简单威胁建模方法",
        ],
        "content": [
            "OWASP Top 10 总览与示例",
            "威胁建模流程与边界设置（仅授权靶场）",
        ],
        "labs": [
            "为一个示例应用做简单威胁建模",
            "输出风险与缓解策略列表",
        ],
        "reinforce": [
            "题目：为何需要威胁建模？",
            "练习：完善模型中的证据项",
        ],
        "criteria": [
            "提交模型与缓解清单",
            "风险陈述清晰",
        ],
    },
    {
        "day": 37,
        "module": "Web 安全",
        "topic": "身份认证与会话安全（CSRF）",
        "objectives": [
            "理解认证与会话的常见风险",
            "认识 CSRF 原理与防护",
        ],
        "content": [
            "认证流程、会话管理、令牌与过期策略",
            "CSRF 与 SameSite/CORS 设置",
        ],
        "labs": [
            "在靶场演示不安全的会话管理（仅演示合法靶场）",
            "配置防护策略并验证效果",
        ],
        "reinforce": [
            "题目：为什么会话固定是风险？",
            "练习：设计合理的会话过期与再认证",
        ],
        "criteria": [
            "提交演示与修复前后对比",
            "能解释各设置的作用",
        ],
    },
    {
        "day": 38,
        "module": "Web 安全",
        "topic": "输入校验与注入（SQLi/XSS）",
        "objectives": [
            "理解注入的根因与防护",
            "能在授权靶场进行演示与修复",
        ],
        "content": [
            "参数化查询、输出编码与白名单校验",
            "反射/存储 XSS 与上下文编码",
        ],
        "labs": [
            "在靶场演示一次 SQLi 与 XSS（严格授权范围）",
            "应用修复并验证不再复现",
        ],
        "reinforce": [
            "题目：为什么黑名单校验不可靠？",
            "练习：编写输入校验策略",
        ],
        "criteria": [
            "提交演示与修复证据",
            "能说明修复原理",
        ],
    },
    {
        "day": 39,
        "module": "Web 安全",
        "topic": "文件上传与路径风险",
        "objectives": [
            "理解上传与路径穿越的风险",
            "会设计安全的上传策略",
        ],
        "content": [
            "白名单扩展名、MIME 验证与存储位置隔离",
            "路径规范化与权限控制",
        ],
        "labs": [
            "在靶场验证不安全上传策略可能的后果（理论演示）",
            "实施安全策略并复验",
        ],
        "reinforce": [
            "题目：为何需要目录隔离？",
            "练习：撰写上传安全检查清单",
        ],
        "criteria": [
            "提交前后对比与检查清单",
            "能说明策略的具体效果",
        ],
    },
    {
        "day": 40,
        "module": "Web 安全",
        "topic": "API 安全与限流鉴权",
        "objectives": [
            "识别 API 常见风险",
            "掌握速率限制、鉴权与授权策略",
        ],
        "content": [
            "鉴权方案（JWT/OAuth2 等）与作用域",
            "速率限制与防刷策略",
        ],
        "labs": [
            "为示例 API 配置限流与鉴权并验证",
            "编写文档说明使用与错误码",
        ],
        "reinforce": [
            "题目：JWT 的风险点在哪？",
            "练习：设计权限模型与作用域",
        ],
        "criteria": [
            "提交配置与验证截图",
            "说明安全收益与边界",
        ],
    },
    {
        "day": 41,
        "module": "Web 安全",
        "topic": "错误处理、日志与 WAF 边界",
        "objectives": [
            "理解错误信息暴露的风险",
            "认识 WAF 的作用与边界",
        ],
        "content": [
            "统一错误处理与安全日志记录",
            "WAF 规则基础与绕过可能（理论）",
        ],
        "labs": [
            "实现统一错误输出并记录安全日志",
            "配置基础 WAF 规则并观察效果",
        ],
        "reinforce": [
            "题目：为什么不能输出堆栈到用户界面？",
            "练习：撰写日志字段清单",
        ],
        "criteria": [
            "错误输出规范化，日志字段完整",
            "能说明 WAF 的边界",
        ],
    },
    {
        "day": 42,
        "module": "Web 安全",
        "topic": "周综合实验与测评（Top 10 选题）",
        "objectives": [
            "完成两个以上 OWASP 风险的演示与修复",
            "形成周报与检查清单",
        ],
        "content": [
            "汇总演示、修复方案与证据",
            "记录误报与边界",
        ],
        "labs": [
            "在靶场选择 2-3 项 Top 10 风险进行演示与修复",
            "输出报告与检查清单",
        ],
        "reinforce": [
            "题目：总结最有效的防护策略",
            "练习：完善项目的安全基线",
        ],
        "criteria": [
            "周报完整、证据充分",
            "提出后续优化计划",
        ],
    },

    # Week 7：网络防护与设备（Day043 ~ Day049）
    {
        "day": 43,
        "module": "网络防护",
        "topic": "防火墙类型与规则设计",
        "objectives": [
            "理解不同类型防火墙的工作方式",
            "能编写最小权限的访问控制规则",
        ],
        "content": [
            "包过滤/状态检测/应用层防火墙",
            "规则设计与顺序、日志与审计",
        ],
        "labs": [
            "在实验环境中编写入站/出站规则并验证",
            "记录命中与阻断的日志",
        ],
        "reinforce": [
            "题目：默认拒绝策略的好处是什么？",
            "练习：为一个服务设计白名单规则",
        ],
        "criteria": [
            "规则生效并有审计记录",
            "说明最小权限原则应用",
        ],
    },
    {
        "day": 44,
        "module": "网络防护",
        "topic": "IDS/IPS 原理与告警分析",
        "objectives": [
            "理解 IDS/IPS 的工作方式与差异",
            "能分析基础告警事件",
        ],
        "content": [
            "特征与行为检测、告警分类",
            "误报与调优",
        ],
        "labs": [
            "部署简易 IDS 并触发样例告警（授权环境）",
            "分析告警并记录调整建议",
        ],
        "reinforce": [
            "题目：如何降低误报？",
            "练习：编写告警调优清单",
        ],
        "criteria": [
            "提交告警截图与分析",
            "提出合理调优建议",
        ],
    },
    {
        "day": 45,
        "module": "网络防护",
        "topic": "网络分段与访问控制、零信任初步",
        "objectives": [
            "理解分段的意义与策略",
            "认识零信任的基本理念",
        ],
        "content": [
            "VLAN/子网分段与 ACL",
            "身份驱动的访问策略（理论）",
        ],
        "labs": [
            "设计一个简易的分段方案并实现基本 ACL",
            "验证跨段访问的限制与日志",
        ],
        "reinforce": [
            "题目：为什么分段能降低风险？",
            "练习：撰写零信任的落地要点",
        ],
        "criteria": [
            "分段与 ACL 生效",
            "提交验证与日志",
        ],
    },
    {
        "day": 46,
        "module": "网络防护",
        "topic": "VPN 与远程接入安全",
        "objectives": [
            "理解隧道与加密的作用",
            "能配置基础安全策略",
        ],
        "content": [
            "常见 VPN 类型与身份认证",
            "最小权限与分离策略",
        ],
        "labs": [
            "为测试环境配置安全的远程接入策略",
            "验证访问范围与日志记录",
        ],
        "reinforce": [
            "题目：远程接入的风险与防范？",
            "练习：设计接入审批与审计流程",
        ],
        "criteria": [
            "策略生效并记录访问日志",
            "说明安全收益与限制",
        ],
    },
    {
        "day": 47,
        "module": "网络防护",
        "topic": "边界与内部防护协同",
        "objectives": [
            "认识边界与内部防护的配合",
            "避免常见误区",
        ],
        "content": [
            "边界策略、内部监控与响应联动",
            "隔离、蜜罐与引诱（理论）",
        ],
        "labs": [
            "编写一个简单的联动流程图与规则清单",
            "模拟一次内部异常并记录响应",
        ],
        "reinforce": [
            "题目：为何仅边界防护不足？",
            "练习：提出内部监控的关键点",
        ],
        "criteria": [
            "流程图与规则清单完整",
            "说明联动的价值",
        ],
    },
    {
        "day": 48,
        "module": "网络防护",
        "topic": "策略编排与变更流程",
        "objectives": [
            "掌握策略编排的基础方法",
            "形成规范的变更流程",
        ],
        "content": [
            "策略模板与审批、回滚计划",
            "变更影响分析与测试",
        ],
        "labs": [
            "编写一份策略变更模板并演练",
            "记录影响分析与测试结果",
        ],
        "reinforce": [
            "题目：如何避免策略冲突？",
            "练习：设计审批与回滚机制",
        ],
        "criteria": [
            "模板完整、演练通过",
            "有影响分析与记录",
        ],
    },
    {
        "day": 49,
        "module": "网络防护",
        "topic": "周综合实验与测评（网络防护）",
        "objectives": [
            "完成防火墙/IDS/分段的综合演练",
            "形成周报与改进项",
        ],
        "content": [
            "汇总策略与日志",
            "评估误报与性能影响",
        ],
        "labs": [
            "对靶场实施综合防护演练并提交证据链",
            "输出报告与建议",
        ],
        "reinforce": [
            "题目：本周最有效的策略是什么？",
            "练习：完善规则与监控",
        ],
        "criteria": [
            "周报完整、证据充分",
            "提出优化计划",
        ],
    },

    # Week 8：渗透测试方法论与合规（Day050 ~ Day056）
    {
        "day": 50,
        "module": "渗透测试方法论",
        "topic": "流程与范围（严格授权）",
        "objectives": [
            "理解渗测流程与范围控制",
            "掌握证据与记录要求",
        ],
        "content": [
            "信息收集、攻击面分析、验证与复现",
            "授权文件与边界声明",
        ],
        "labs": [
            "在靶场制定一次渗测计划与范围",
            "准备证据记录模板",
        ],
        "reinforce": [
            "题目：为何必须有授权？",
            "练习：编写边界声明样例",
        ],
        "criteria": [
            "提交计划与模板",
            "说明合规边界",
        ],
    },
    {
        "day": 51,
        "module": "渗透测试方法论",
        "topic": "靶场搭建与用例设计",
        "objectives": [
            "能搭建基本靶场",
            "设计验证用例",
        ],
        "content": [
            "靶机与防护配置、数据回放（理论）",
            "用例编排与风险分级",
        ],
        "labs": [
            "搭建最小可用靶场并记录配置",
            "设计 5 个用例并定义预期结果",
        ],
        "reinforce": [
            "题目：用例如何覆盖关键面？",
            "练习：优化用例的证据项",
        ],
        "criteria": [
            "靶场可用，用例明确",
            "提交配置与用例文档",
        ],
    },
    {
        "day": 52,
        "module": "渗透测试方法论",
        "topic": "工具链（枚举/字典/弱口令）",
        "objectives": [
            "熟悉工具链的合法使用",
            "能在范围内进行验证",
        ],
        "content": [
            "枚举与目录、字典策略（仅授权）",
            "登录与弱口令验证（靶场）",
        ],
        "labs": [
            "对靶场执行枚举并记录证据",
            "验证弱口令用例并给出加固建议",
        ],
        "reinforce": [
            "题目：字典策略的风险与限制？",
            "练习：设计合理的限速与锁定策略",
        ],
        "criteria": [
            "证据清晰、范围合规",
            "提出修复建议",
        ],
    },
    {
        "day": 53,
        "module": "渗透测试方法论",
        "topic": "验证与复现记录",
        "objectives": [
            "能规范化记录复现步骤与证据",
            "形成可审阅材料",
        ],
        "content": [
            "截图、日志、命令与输出记录",
            "版本与环境说明",
        ],
        "labs": [
            "为一个用例撰写完整复现文档",
            "提交证据与结论",
        ],
        "reinforce": [
            "题目：证据不足会导致什么问题？",
            "练习：完善文档结构",
        ],
        "criteria": [
            "文档完整、可复审",
            "证据链条完整",
        ],
    },
    {
        "day": 54,
        "module": "渗透测试方法论",
        "topic": "报告撰写与评分参考（CVSS）",
        "objectives": [
            "掌握报告结构与评分说明",
            "能给出修复建议",
        ],
        "content": [
            "报告结构：概览、技术细节、影响与建议",
            "CVSS 评分与业务影响",
        ],
        "labs": [
            "撰写一个示例报告并附评分与建议",
            "提交评审版",
        ],
        "reinforce": [
            "题目：如何面向业务方解释风险？",
            "练习：完善建议的可执行性",
        ],
        "criteria": [
            "报告结构清晰、评分合理",
            "建议可落地",
        ],
    },
    {
        "day": 55,
        "module": "渗透测试方法论",
        "topic": "复测与修复跟踪、沟通要点",
        "objectives": [
            "能进行复测并跟踪修复进度",
            "掌握沟通与记录的关键点",
        ],
        "content": [
            "复测流程与版本管理",
            "跨团队沟通要点",
        ],
        "labs": [
            "对一个已修复用例进行复测与记录",
            "形成跟踪表与结案说明",
        ],
        "reinforce": [
            "题目：如何避免复测的偏差？",
            "练习：完善跟踪表字段",
        ],
        "criteria": [
            "复测证据完整",
            "结案记录规范",
        ],
    },
    {
        "day": 56,
        "module": "渗透测试方法论",
        "topic": "周综合实验与测评（方法论）",
        "objectives": [
            "完成方法论闭环演练",
            "形成周报与模板库",
        ],
        "content": [
            "汇总计划、用例、报告与复测记录",
            "完善模板与清单",
        ],
        "labs": [
            "选择一个主题完成闭环演练并提交证据",
            "整理模板库（计划/报告/复测）",
        ],
        "reinforce": [
            "题目：本周流程中最易遗漏的环节？",
            "练习：完善证据模板",
        ],
        "criteria": [
            "周报与证据完整",
            "模板库可复用",
        ],
    },

    # Week 9：内网与横向基础（Day057 ~ Day063）
    {
        "day": 57,
        "module": "内网基础",
        "topic": "AD/域基础与风险面",
        "objectives": [
            "理解域与身份的基本概念",
            "识别常见风险面（理论）",
        ],
        "content": [
            "域结构与组策略",
            "常见暴露点与最小化原则",
        ],
        "labs": [
            "在实验环境中查看示例组策略与权限设置",
            "记录潜在风险点与加固建议",
        ],
        "reinforce": [
            "题目：为何最小权限对域至关重要？",
            "练习：提出 5 条域加固建议",
        ],
        "criteria": [
            "提交风险与建议清单",
            "能说明域结构与影响",
        ],
    },
    {
        "day": 58,
        "module": "内网基础",
        "topic": "凭据与会话管理",
        "objectives": [
            "理解凭据与会话的安全要点",
            "能最小化暴露与泄漏风险",
        ],
        "content": [
            "凭据存储与转移（理论）",
            "会话保护与过期策略",
        ],
        "labs": [
            "检查实验主机的凭据暴露面并记录",
            "制定最小化策略并验证",
        ],
        "reinforce": [
            "题目：为什么要避免共享凭据？",
            "练习：撰写会话保护策略",
        ],
        "criteria": [
            "提出可执行的最小化措施",
            "验证效果与记录",
        ],
    },
    {
        "day": 59,
        "module": "内网基础",
        "topic": "横向常见手段（理论与模拟）",
        "objectives": [
            "认识横向移动的常见方法（理论）",
            "仅做模拟与防护演练",
        ],
        "content": [
            "常见横向路径与防护点（理论）",
            "日志与检测的关注点",
        ],
        "labs": [
            "模拟横向场景的日志与告警（不做未授权操作）",
            "记录检测与处置流程",
        ],
        "reinforce": [
            "题目：横向检测的关键证据是什么？",
            "练习：设计防护策略",
        ],
        "criteria": [
            "提交模拟日志与流程图",
            "说明防护要点",
        ],
    },
    {
        "day": 60,
        "module": "内网基础",
        "topic": "日志追踪与证据链",
        "objectives": [
            "能通过日志构建证据链条",
            "形成追踪报告",
        ],
        "content": [
            "时间线与会话关联",
            "多源日志的整合方法",
        ],
        "labs": [
            "为模拟场景构建一条时间线与证据链",
            "提交追踪报告",
        ],
        "reinforce": [
            "题目：如何避免证据链断裂？",
            "练习：设计日志字段要求",
        ],
        "criteria": [
            "时间线完整、证据清晰",
            "报告可复审",
        ],
    },
    {
        "day": 61,
        "module": "内网基础",
        "topic": "加固与策略优化",
        "objectives": [
            "针对内网风险提出加固措施",
            "优化策略与流程",
        ],
        "content": [
            "权限最小化、隔离与监控",
            "审批与审计流程",
        ],
        "labs": [
            "为实验环境制定加固清单并实施部分",
            "提交验证与记录",
        ],
        "reinforce": [
            "题目：哪些加固最优先？",
            "练习：完善流程文档",
        ],
        "criteria": [
            "清单明确、实施有效",
            "有证据与记录",
        ],
    },
    {
        "day": 62,
        "module": "内网基础",
        "topic": "蓝队视角：检测与处置",
        "objectives": [
            "从蓝队视角设计检测与处置流程",
            "明确触发与响应",
        ],
        "content": [
            "告警分级与处置步骤",
            "证据采集与保全",
        ],
        "labs": [
            "编写一份检测处置流程并演练",
            "记录处置与证据",
        ],
        "reinforce": [
            "题目：如何保证证据可用？",
            "练习：完善流程的触发条件",
        ],
        "criteria": [
            "流程清晰、演练通过",
            "证据规范",
        ],
    },
    {
        "day": 63,
        "module": "内网基础",
        "topic": "周综合实验与测评（内网）",
        "objectives": [
            "完成内网基础与蓝队演练",
            "形成周报与优化计划",
        ],
        "content": [
            "汇总风险、日志与处置",
            "评估优化效果",
        ],
        "labs": [
            "选择一个内网主题完成演练并提交证据",
            "输出周报与计划",
        ],
        "reinforce": [
            "题目：本周最关键的检测点？",
            "练习：完善加固清单",
        ],
        "criteria": [
            "周报完整、证据充分",
            "优化计划明确",
        ],
    },

    # Week 10：云与容器安全（Day064 ~ Day070）
    {
        "day": 64,
        "module": "云与容器安全",
        "topic": "云共享责任模型与账号权限",
        "objectives": [
            "理解共享责任模型",
            "掌握账号与权限的安全实践",
        ],
        "content": [
            "账号与角色、最小权限与分离",
            "密钥与凭据管理",
        ],
        "labs": [
            "在测试云环境中配置最小权限角色（可用本地模拟）",
            "记录变更与权限验证",
        ],
        "reinforce": [
            "题目：共享责任如何影响安全边界？",
            "练习：设计角色权限方案",
        ],
        "criteria": [
            "权限配置生效并有验证",
            "说明方案合理性",
        ],
    },
    {
        "day": 65,
        "module": "云与容器安全",
        "topic": "网络与存储安全、配置管理",
        "objectives": [
            "掌握网络与存储的基本安全控制",
            "理解配置管理的重要性",
        ],
        "content": [
            "安全组/ACL、对象存储权限",
            "配置版本化与审计",
        ],
        "labs": [
            "配置安全组与存储策略并验证",
            "提交配置与验证截图",
        ],
        "reinforce": [
            "题目：常见误开放导致什么问题？",
            "练习：设计配置管理流程",
        ],
        "criteria": [
            "策略生效、审计可见",
            "提交验证证据",
        ],
    },
    {
        "day": 66,
        "module": "云与容器安全",
        "topic": "容器与镜像安全、最小镜像",
        "objectives": [
            "理解镜像安全与供应链风险",
            "掌握最小镜像原则",
        ],
        "content": [
            "镜像来源与签名、漏洞扫描",
            "运行时权限与隔离",
        ],
        "labs": [
            "对示例镜像进行扫描并记录风险",
            "制作最小镜像并验证运行",
        ],
        "reinforce": [
            "题目：为何避免特权容器？",
            "练习：列出镜像安全清单",
        ],
        "criteria": [
            "扫描与修复建议提交",
            "最小镜像运行正常",
        ],
    },
    {
        "day": 67,
        "module": "云与容器安全",
        "topic": "K8s 入门：RBAC 与网络策略",
        "objectives": [
            "理解 RBAC 与网络策略作用",
            "能配置基础策略并验证",
        ],
        "content": [
            "角色/绑定与权限粒度",
            "NetworkPolicy 的选择与限制",
        ],
        "labs": [
            "在本地 K8s（如 kind/minikube）配置 RBAC 与网络策略",
            "验证跨 Pod 通信的限制",
        ],
        "reinforce": [
            "题目：如何设计最小权限的 RBAC？",
            "练习：编写 NetworkPolicy 示例",
        ],
        "criteria": [
            "策略生效与验证截图",
            "说明安全收益",
        ],
    },
    {
        "day": 68,
        "module": "云与容器安全",
        "topic": "云审计与告警、合规参考",
        "objectives": [
            "能在云环境中进行审计与告警配置",
            "理解合规参考的作用",
        ],
        "content": [
            "审计日志、告警规则与通知",
            "合规框架参考（理论）",
        ],
        "labs": [
            "配置审计与告警并触发验证",
            "记录事件与处置流程",
        ],
        "reinforce": [
            "题目：云审计的关键字段？",
            "练习：设计告警分级",
        ],
        "criteria": [
            "审计与告警可用",
            "提交验证证据",
        ],
    },
    {
        "day": 69,
        "module": "云与容器安全",
        "topic": "攻防边界与最佳实践",
        "objectives": [
            "总结云与容器的攻防边界",
            "形成最佳实践清单",
        ],
        "content": [
            "身份、网络、存储、镜像与运行时",
            "日志与告警联动",
        ],
        "labs": [
            "编写最佳实践清单并在测试环境验证部分",
            "提交验证与截图",
        ],
        "reinforce": [
            "题目：哪个环节最容易忽视？",
            "练习：完善清单",
        ],
        "criteria": [
            "清单明确、验证有效",
            "说明边界限制",
        ],
    },
    {
        "day": 70,
        "module": "云与容器安全",
        "topic": "周综合实验与测评（云/容器）",
        "objectives": [
            "完成云与容器的综合演练",
            "形成周报与改进计划",
        ],
        "content": [
            "汇总策略、日志与验证",
            "评估收益与不足",
        ],
        "labs": [
            "选择一个主题完成综合演练并提交证据",
            "输出周报与计划",
        ],
        "reinforce": [
            "题目：最重要的控制项是什么？",
            "练习：完善策略文档",
        ],
        "criteria": [
            "周报完整、证据充分",
            "提出优化计划",
        ],
    },

    # Week 11：事件响应与取证基础（Day071 ~ Day077）
    {
        "day": 71,
        "module": "事件响应与取证",
        "topic": "响应流程与分级、准备与演练",
        "objectives": [
            "理解响应流程与分级",
            "掌握演练的准备要点",
        ],
        "content": [
            "响应角色与职责",
            "演练计划与检查清单",
        ],
        "labs": [
            "编写一次响应演练计划与检查清单",
            "演练并记录问题",
        ],
        "reinforce": [
            "题目：分级的意义是什么？",
            "练习：完善演练计划",
        ],
        "criteria": [
            "计划与演练记录完整",
            "问题与改进项明确",
        ],
    },
    {
        "day": 72,
        "module": "事件响应与取证",
        "topic": "主机取证基础：镜像与时间线",
        "objectives": [
            "理解主机取证的基本方法",
            "能构建时间线与证据",
        ],
        "content": [
            "镜像与哈希校验（理论与合规）",
            "时间线构建与关键工件",
        ],
        "labs": [
            "对测试主机进行样例取证（合法范围内）",
            "构建时间线并提交证据",
        ],
        "reinforce": [
            "题目：如何保证证据完整性？",
            "练习：设计时间线字段",
        ],
        "criteria": [
            "时间线清晰、证据规范",
            "说明完整性保证方法",
        ],
    },
    {
        "day": 73,
        "module": "事件响应与取证",
        "topic": "网络取证基础：流量与会话",
        "objectives": [
            "理解网络取证的方法",
            "能复原会话并分析",
        ],
        "content": [
            "流量捕获与会话复原",
            "关键字段与时间线",
        ],
        "labs": [
            "捕获样例流量并复原会话",
            "提交分析与结论",
        ],
        "reinforce": [
            "题目：哪些字段最关键？",
            "练习：完善取证报告模板",
        ],
        "criteria": [
            "会话复原正确、分析合理",
            "报告模板完善",
        ],
    },
    {
        "day": 74,
        "module": "事件响应与取证",
        "topic": "日志与告警的证据化",
        "objectives": [
            "将日志与告警转化为证据",
            "保证可审查与复现",
        ],
        "content": [
            "日志字段与证据关联",
            "截图与输出保存规范",
        ],
        "labs": [
            "对告警事件收集日志证据并关联",
            "提交证据清单与结论",
        ],
        "reinforce": [
            "题目：证据保全的要点是什么？",
            "练习：完善证据清单模板",
        ],
        "criteria": [
            "证据清单完整、关联明确",
            "结论可复审",
        ],
    },
    {
        "day": 75,
        "module": "事件响应与取证",
        "topic": "初步分析与报告结构",
        "objectives": [
            "能进行初步分析并撰写报告",
            "形成可执行建议",
        ],
        "content": [
            "分析步骤与结构化报告",
            "建议与处置清单",
        ],
        "labs": [
            "撰写一个示例响应报告并提交",
            "形成建议与处置清单",
        ],
        "reinforce": [
            "题目：如何提高建议的可执行性？",
            "练习：优化报告结构",
        ],
        "criteria": [
            "报告结构清晰、建议可执行",
            "证据完整",
        ],
    },
    {
        "day": 76,
        "module": "事件响应与取证",
        "topic": "演练与复盘、改进清单",
        "objectives": [
            "完成一次响应演练并复盘",
            "形成改进清单",
        ],
        "content": [
            "演练流程与问题记录",
            "改进项与计划",
        ],
        "labs": [
            "完成演练并提交复盘文档",
            "整理改进清单与时间表",
        ],
        "reinforce": [
            "题目：演练中最关键的环节？",
            "练习：制定下一次演练计划",
        ],
        "criteria": [
            "复盘清晰、改进可执行",
            "文档完整",
        ],
    },
    {
        "day": 77,
        "module": "事件响应与取证",
        "topic": "周综合实验与测评（响应/取证）",
        "objectives": [
            "完成响应与取证的综合演练",
            "形成周报与模板库",
        ],
        "content": [
            "汇总时间线、证据与报告",
            "完善模板与流程",
        ],
        "labs": [
            "选择一个主题完成综合演练并提交证据",
            "输出周报与模板",
        ],
        "reinforce": [
            "题目：最难完善的证据项？",
            "练习：改进模板",
        ],
        "criteria": [
            "周报完整、证据充分",
            "模板可复用",
        ],
    },

    # Week 12：综合实战与作品集（Day078 ~ Day084）
    {
        "day": 78,
        "module": "综合实战",
        "topic": "选题与范围界定、目标与度量",
        "objectives": [
            "选择合法授权的实战主题",
            "明确目标与度量指标",
        ],
        "content": [
            "选题原则与边界声明",
            "目标与度量设计",
        ],
        "labs": [
            "制定选题与度量文档并提交",
            "准备证据记录方案",
        ],
        "reinforce": [
            "题目：如何定义可衡量的目标？",
            "练习：完善度量指标",
        ],
        "criteria": [
            "选题合法、目标明确",
            "度量可执行",
        ],
    },
    {
        "day": 79,
        "module": "综合实战",
        "topic": "执行与记录：过程证据链",
        "objectives": [
            "按计划执行并记录证据",
            "保证链条完整",
        ],
        "content": [
            "过程记录模板与截图规范",
            "日志与输出保存",
        ],
        "labs": [
            "执行实战并提交过程证据",
            "记录问题与调整",
        ],
        "reinforce": [
            "题目：证据链的关键节点？",
            "练习：完善记录模板",
        ],
        "criteria": [
            "证据充分、记录完整",
            "调整说明清晰",
        ],
    },
    {
        "day": 80,
        "module": "综合实战",
        "topic": "报告撰写与复现核验",
        "objectives": [
            "撰写完整报告",
            "进行复现核验",
        ],
        "content": [
            "报告结构与复现说明",
            "结论与建议",
        ],
        "labs": [
            "提交报告与复现步骤",
            "核验并记录结果",
        ],
        "reinforce": [
            "题目：如何提高报告可读性？",
            "练习：完善复现说明",
        ],
        "criteria": [
            "报告完整、复现通过",
            "结论清晰",
        ],
    },
    {
        "day": 81,
        "module": "综合实战",
        "topic": "加固建议与改进整理",
        "objectives": [
            "形成加固建议",
            "整理改进项",
        ],
        "content": [
            "建议的优先级与可执行性",
            "改进计划与负责人（理论）",
        ],
        "labs": [
            "输出加固建议与改进清单",
            "提交优先级与时间表",
        ],
        "reinforce": [
            "题目：如何排序优先级？",
            "练习：制定时间表",
        ],
        "criteria": [
            "建议可执行、优先级明确",
            "计划清晰",
        ],
    },
    {
        "day": 82,
        "module": "综合实战",
        "topic": "作品集组装与展示准备",
        "objectives": [
            "整理作品集材料",
            "准备展示与讲解",
        ],
        "content": [
            "作品集结构与要素",
            "讲解提纲与演示素材",
        ],
        "labs": [
            "组装作品集并准备展示",
            "提交提纲与素材",
        ],
        "reinforce": [
            "题目：如何突出关键成果？",
            "练习：优化展示结构",
        ],
        "criteria": [
            "作品集完整、展示有序",
            "提纲清晰",
        ],
    },
    {
        "day": 83,
        "module": "综合实战",
        "topic": "演示彩排与反馈收集",
        "objectives": [
            "完成演示彩排",
            "收集反馈并优化",
        ],
        "content": [
            "彩排流程与时间控制",
            "反馈整理与改进",
        ],
        "labs": [
            "完成彩排并记录反馈",
            "优化作品集与讲解",
        ],
        "reinforce": [
            "题目：如何处理时间控制？",
            "练习：完善讲解稿",
        ],
        "criteria": [
            "彩排完成、改进到位",
            "材料更新",
        ],
    },
    {
        "day": 84,
        "module": "综合实战",
        "topic": "周综合评审：作品集与展示",
        "objectives": [
            "完成作品集评审",
            "定稿展示材料",
        ],
        "content": [
            "评审要点与调整",
            "定稿与提交",
        ],
        "labs": [
            "进行评审并提交定稿",
            "记录改动与建议",
        ],
        "reinforce": [
            "题目：评审中最重要的指标？",
            "练习：完善材料",
        ],
        "criteria": [
            "评审通过、材料定稿",
            "记录完整",
        ],
    },

    # Week 13：查缺补漏与冲刺（Day085 ~ Day090）
    {
        "day": 85,
        "module": "冲刺复盘",
        "topic": "网络与协议复盘、题库巩固",
        "objectives": [
            "复盘网络与协议",
            "完成题库巩固",
        ],
        "content": [
            "关键协议与抓包要点回顾",
            "题库与错题本",
        ],
        "labs": [
            "完成一套题库并记录错题",
            "复现抓包与分析示例",
        ],
        "reinforce": [
            "题目：本模块最易错点？",
            "练习：完善错题本",
        ],
        "criteria": [
            "题库完成、错题记录",
            "抓包复现",
        ],
    },
    {
        "day": 86,
        "module": "冲刺复盘",
        "topic": "Web 与漏洞复盘、题库巩固",
        "objectives": [
            "复盘 Web 安全要点",
            "完成题库巩固",
        ],
        "content": [
            "Top 10 与防护策略",
            "演示与修复要点",
        ],
        "labs": [
            "完成一套题库并记录错题",
            "复现演示与修复样例",
        ],
        "reinforce": [
            "题目：哪个风险最常见？",
            "练习：完善防护清单",
        ],
        "criteria": [
            "题库完成、修复复现",
            "清单完善",
        ],
    },
    {
        "day": 87,
        "module": "冲刺复盘",
        "topic": "日志/防护/响应复盘、题库巩固",
        "objectives": [
            "复盘日志链路与防护策略",
            "完成响应题库",
        ],
        "content": [
            "采集到告警闭环",
            "防护策略与响应流程",
        ],
        "labs": [
            "完成题库并记录错题",
            "演练一次告警触发到处置",
        ],
        "reinforce": [
            "题目：哪条链路最脆弱？",
            "练习：优化处置流程",
        ],
        "criteria": [
            "题库完成、演练通过",
            "流程优化记录",
        ],
    },
    {
        "day": 88,
        "module": "冲刺复盘",
        "topic": "综合场景模拟演练",
        "objectives": [
            "在限定时间内完成综合演练",
            "形成计时与证据记录",
        ],
        "content": [
            "综合演练目标与步骤",
            "计时与评估",
        ],
        "labs": [
            "完成演练并记录时间与证据",
            "提交评估与改进建议",
        ],
        "reinforce": [
            "题目：时间压力下的取舍？",
            "练习：优化策略",
        ],
        "criteria": [
            "演练完成、证据充分",
            "改进建议明确",
        ],
    },
    {
        "day": 89,
        "module": "冲刺复盘",
        "topic": "最终报告与作品集完善",
        "objectives": [
            "完成最终报告与作品集",
            "准备提交与展示",
        ],
        "content": [
            "报告定稿与作品集完善",
            "提交说明与演示准备",
        ],
        "labs": [
            "定稿报告与作品集并提交",
            "准备展示材料",
        ],
        "reinforce": [
            "题目：如何突出关键成果？",
            "练习：优化演示稿",
        ],
        "criteria": [
            "报告与作品集定稿",
            "展示准备完成",
        ],
    },
    {
        "day": 90,
        "module": "冲刺复盘",
        "topic": "总测评与未来计划",
        "objectives": [
            "完成总测评",
            "制定后续认证与专项计划",
        ],
        "content": [
            "测评与反馈",
            "未来学习路径与认证目标（如：Security+、CEH 等理论）",
        ],
        "labs": [
            "完成一次综合测评并提交结果",
            "制定未来计划与时间表",
        ],
        "reinforce": [
            "题目：下一阶段的重点是什么？",
            "练习：拆解目标与里程碑",
        ],
        "criteria": [
            "测评完成、计划明确",
            "记录与证据齐备",
        ],
    },
]

# 已补充 Day01~Day90 的详细条目，生成的每日卡片均为“详细版本”。

TOTAL_DAYS = 90

TEMPLATE_FILLER = {
    "objectives": [
        "完善本日详细学习目标（请参考路线图模块主题）",
    ],
    "content": [
        "补充本日具体学习内容（阅读/视频/标准文档）",
    ],
    "labs": [
        "设计并完成至少 1 项合法授权范围内的动手实践",
    ],
    "reinforce": [
        "编写 3-5 道巩固题或复盘要点",
    ],
    "criteria": [
        "定义可度量的达成判定（如截图、日志、报告摘要）",
    ],
}

HEADER = """\
# Day{day:03d}：{module} - {topic}

- 日期：{date}
- 周次：第{week}周

## 学习目标
{objectives}

## 学习内容
{content}

## 实践任务（合法授权范围内）
{labs}

## 巩固练习（题与复盘）
{reinforce}

## 评估标准（达成判定）
{criteria}

## 学习成果达成情况（由学习者填写）
- 截图与证据：
- 关键命令与输出：
- 结论与反思：
"""


def bullets(items):
    return "\n".join([f"- {i}" for i in items]) if items else "- （待填写）"


def week_number(day):
    # 7 天为一周，向上取整
    return (day - 1) // 7 + 1


def ensure_dir(path):
    if not os.path.exists(path):
        os.makedirs(path)


def build_entry(day):
    # 尝试从 CURRICULUM 获取详细条目；否则生成模板
    entry = next((c for c in CURRICULUM if c["day"] == day), None)
    if entry:
        return {
            "module": entry["module"],
            "topic": entry["topic"],
            "objectives": bullets(entry.get("objectives", [])),
            "content": bullets(entry.get("content", [])),
            "labs": bullets(entry.get("labs", [])),
            "reinforce": bullets(entry.get("reinforce", [])),
            "criteria": bullets(entry.get("criteria", [])),
        }
    else:
        return {
            "module": "（按路线图填充模块）",
            "topic": "（补充具体主题）",
            "objectives": bullets(TEMPLATE_FILLER["objectives"]),
            "content": bullets(TEMPLATE_FILLER["content"]),
            "labs": bullets(TEMPLATE_FILLER["labs"]),
            "reinforce": bullets(TEMPLATE_FILLER["reinforce"]),
            "criteria": bullets(TEMPLATE_FILLER["criteria"]),
        }


def main():
    parser = argparse.ArgumentParser(description="生成每日学习 Markdown 卡片")
    parser.add_argument("-s", "--start", dest="start", default=datetime.date.today().isoformat(), help="开始日期（YYYY-MM-DD）")
    parser.add_argument("-o", "--output", dest="output", default=os.path.join(os.path.dirname(__file__), "..", "daily"), help="输出目录")
    args = parser.parse_args()

    start_date = datetime.date.fromisoformat(args.start)
    out_dir = os.path.abspath(args.output)
    ensure_dir(out_dir)

    for day in range(1, TOTAL_DAYS + 1):
        date = start_date + datetime.timedelta(days=day - 1)
        week = week_number(day)
        entry = build_entry(day)
        content = HEADER.format(
            day=day,
            module=entry["module"],
            topic=entry["topic"],
            date=date.isoformat(),
            week=week,
            objectives=entry["objectives"],
            content=entry["content"],
            labs=entry["labs"],
            reinforce=entry["reinforce"],
            criteria=entry["criteria"],
        )
        fname = os.path.join(out_dir, f"Day{day:03d}.md")
        with open(fname, "w", encoding="utf-8") as f:
            f.write(dedent(content))

    print(f"已生成 {TOTAL_DAYS} 天的详细学习卡片到: {out_dir}")


if __name__ == "__main__":
    main()
