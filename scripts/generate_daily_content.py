#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
生成 90 天的每日学习卡片 Markdown 文件。
每个文件包含：目标、内容、实践任务、巩固、评估标准、学习成果达成情况。
默认输出到 ../daily/ 目录，可通过参数指定开始日期与目录。

使用：
    python scripts/generate_daily_content.py -s 2025-12-25 -o ./daily

注意：本脚本仅生成学习卡片文本，不包含任何非法或未授权的攻击指令。
所有实验应在合法授权与自建靶场范围内进行。
"""

import argparse
import datetime
import os
from textwrap import dedent

# 课程数据：按天详细内容（90 天）
# 为保证“详细完整”，每一天给出模块、主题、目标、内容要点、实践任务、巩固与评估标准。
# 学习成果达成情况留给学习者每日填写。

CURRICULUM = [
    # Week 1
    {
        "day": 1,
        "module": "网络与协议基础",
        "topic": "网络总览与模型",
        "objectives": [
            "理解 OSI 与 TCP/IP 模型的层次与职责",
            "认识常用网络术语（主机、接口、路由、网关、子网等）",
        ],
        "content_basics": """#### 1.1.1 什么是网络模型？
网络模型是计算机网络通信的标准化框架，将复杂的网络通信分解为多个层次，每个层次负责特定的功能。

#### 1.1.2 OSI 七层模型简介
OSI（开放系统互连）是由国际标准化组织（ISO）制定的网络通信标准模型。

**七层分别是**：
1. **物理层**：负责比特流传输，处理电气信号、光信号、无线电波
2. **数据链路层**：负责相邻节点间的数据传输，帧同步、错误检测
3. **网络层**：负责路由选择、IP 地址寻址、跨网络传输
4. **传输层**：负责端到端的可靠传输、流量控制、错误检测
5. **会话层**：负责建立、管理、终止会话连接
6. **表示层**：负责数据格式转换、加密解密、压缩解压
7. **应用层**：负责为应用程序提供网络服务接口

#### 1.1.3 TCP/IP 四层模型简介
TCP/IP 是互联网实际使用的协议栈模型，比 OSI 更简洁实用。

**四层分别是**：
1. **网络接口层**：对应 OSI 的物理层 + 数据链路层，负责物理网络接口
2. **网络层**：对应 OSI 的网络层，负责 IP 寻址和路由
3. **传输层**：对应 OSI 的传输层，负责 TCP/UDP 传输
4. **应用层**：对应 OSI 的会话层 + 表示层 + 应用层，负责应用协议

#### 1.1.4 常用网络术语
- **主机（Host）**：网络中的计算机设备
- **接口（Interface）**：网络设备的连接端口
- **路由（Routing）**：数据包从源到目的地的路径选择
- **网关（Gateway）**：连接不同网络的设备，默认路由指向网关
- **子网（Subnet）**：网络中的子网络，通过子网掩码划分
- **MAC 地址**：物理地址，48 位，通常用冒号分隔的十六进制表示
- **IP 地址**：逻辑地址，IPv4 是 32 位，IPv6 是 128 位""",
        "content_principle": """#### 1.2.1 OSI 与 TCP/IP 的对应关系
```
OSI 七层模型          TCP/IP 四层模型
┌─────────────────┐   ┌─────────────────┐
│ 7. 应用层      │   │ 4. 应用层      │
│ 6. 表示层      │   │   (会话+表示+应用) │
│ 5. 会话层      │   └─────────────────┘
├─────────────────┤   ┌─────────────────┤
│ 4. 传输层      │   │ 3. 传输层      │
├─────────────────┤   │   (TCP/UDP)    │
│ 3. 网络层      │   └─────────────────┘
│   (IP)         │   ┌─────────────────┤
├─────────────────┤   │ 2. 网络层      │
│ 2. 数据链路层  │   │   (IP)         │
│ 1. 物理层      │   └─────────────────┘
└─────────────────┘   ┌─────────────────┤
                      │ 1. 网络接口层  │
                      │   (物理+链路)  │
                      └─────────────────┘
```

#### 1.2.2 数据封装与解封装过程
当你在浏览器输入网址访问网站时，数据包的封装过程如下：

1. **应用层**：HTTP 请求数据
2. **传输层**：添加 TCP/UDP 头部（端口号、序列号等）
3. **网络层**：添加 IP 头部（源/目的 IP 地址）
4. **数据链路层**：添加以太网帧头（源/目的 MAC 地址）
5. **物理层**：转换为电信号或无线电波传输

接收端进行相反的解封装过程。

#### 1.2.3 网络分层的好处
- **模块化**：每一层只负责自己的功能
- **标准化**：不同厂商的设备可以互操作
- **易于维护**：问题定位更容易
- **技术更新**：一层的技术更新不影响其他层""",
        "content_tech": """#### 1.3.1 IP 地址格式
IPv4 地址：192.168.1.1
- 点分十进制表示
- 32 位二进制
- 范围：0.0.0.0 - 255.255.255.255

IPv6 地址：2001:0db8:85a3:0000:0000:8a2e:0370:7334
- 冒号十六进制表示
- 128 位二进制
- 更长的地址空间

#### 1.3.2 子网掩码
- 用于划分网络和主机部分
- 示例：255.255.255.0 表示前 24 位是网络位，后 8 位是主机位
- CIDR 表示法：192.168.1.0/24

#### 1.3.3 MAC 地址格式
- 48 位（6 字节）
- 示例：C8:15:4E:A8:D3:FB
- 前 3 字节是厂商标识，后 3 字节是设备标识
- 全球唯一（理论上）""",
        "content_advanced": """#### 1.4.1 OSI 模型的历史意义
- OSI 模型是理论上的完美模型，但过于复杂
- TCP/IP 模型是实践中的标准，被证明更实用
- 现代网络技术（如 SDN）正在挑战传统分层模型

#### 1.4.2 网络协议栈的演进
- 从 OSI 到 TCP/IP 的转变
- IPv4 到 IPv6 的迁移
- 新兴协议：QUIC, HTTP/3 等

#### 1.4.3 网络虚拟化
- VLAN：虚拟局域网
- VXLAN：扩展 VLAN
- SDN：软件定义网络""",
        "labs_1": "准备学习环境：检查电脑是否联网，打开浏览器访问任意网站确认网络正常",
        "labs_2": """查看本机网络配置：
1. Windows：打开命令提示符，输入 ipconfig /all
2. Linux/Mac：打开终端，输入 ifconfig 或 ip addr show
3. 记录以下信息：
   - 本机 IP 地址
   - 子网掩码
   - 默认网关
   - DNS 服务器
   - MAC 地址""",
        "labs_3": "绘制本地网络拓扑图，标注主机、路由器、互联网的连接关系",
        "reinforce": [
            "用自己的话解释 OSI 七层模型中每一层的职责",
            "计算 192.168.1.0/24 网络中有多少个可用主机地址",
            "解释为什么 TCP/IP 四层模型在实际互联网中更常用",
        ],
        "criteria": [
            "能准确描述 OSI 和 TCP/IP 模型的层次结构",
            "能解释数据封装和解封装的过程",
            "能识别和解释本机网络配置的关键参数",
        ],
    },
    {
        "day": 2,
        "module": "网络与协议基础",
        "topic": "以太网、MAC 与 ARP",
        "objectives": [
            "理解二层寻址（MAC）与 ARP 的工作流程",
            "认识广播域与交换机学习机制（理论）",
        ],
        "content_basics": """#### 2.1.1 什么是以太网？
以太网（Ethernet）是局域网（LAN）中最常用的技术标准。

#### 2.1.2 MAC 地址的概念
- MAC（Media Access Control）地址是网络设备的物理地址
- 48 位（6 字节）长度
- 全球唯一（理论上）
- 示例：C8:15:4E:A8:D3:FB

#### 2.1.3 ARP 协议的作用
- ARP（Address Resolution Protocol）地址解析协议
- 负责将 IP 地址转换为 MAC 地址
- 工作在数据链路层

#### 2.1.4 广播域的概念
- 广播域是指广播帧所能到达的范围
- 在同一个广播域内的设备都能收到广播帧
- 交换机可以划分广播域，路由器隔离广播域""",
        "content_principle": """#### 2.2.1 ARP 工作流程
1. **主机 A** 想与 **主机 B** 通信，已知 B 的 IP 地址 192.168.1.2，但不知道 B 的 MAC 地址
2. **主机 A** 发送 ARP 请求广播：谁的 IP 是 192.168.1.2？我的 MAC 是 AA:AA:AA:AA:AA:AA
3. **主机 B** 收到请求后，发送 ARP 响应单播：我的 IP 是 192.168.1.2，我的 MAC 是 BB:BB:BB:BB:BB:BB
4. **主机 A** 收到响应，将 B 的 MAC 地址缓存到 ARP 表中
5. **后续通信** 使用缓存的 MAC 地址直接发送

#### 2.2.2 ARP 缓存表
- 操作系统维护 ARP 缓存表，存储 IP-MAC 映射关系
- 缓存有生存时间（TTL），过期后重新解析
- 查看命令：
  - Windows：arp -a
  - Linux：arp 或 ip neigh

#### 2.2.3 交换机的工作原理
- 交换机根据 MAC 地址表转发数据帧
- 初始时 MAC 地址表为空，采用洪泛（flooding）方式
- 学习源 MAC 地址，建立地址表
- 根据目的 MAC 地址转发或洪泛""",
        "content_tech": """#### 2.3.1 ARP 报文格式
```
以太网首部 (14 字节)
┌─────────────┬─────────────┬─────┬─────┬─────────────┐
│ 目的 MAC    │ 源 MAC      │类型 │操作 │发送者硬件地址│
│ (6 字节)    │ (6 字节)    │(2)  │(2)  │ (6 字节)    │
├─────────────┼─────────────┼─────┼─────┼─────────────┤
│发送者协议地址│目的硬件地址 │目的协议地址 │填充       │
│ (4 字节)    │ (6 字节)    │ (4 字节)    │ (18 字节)  │
└─────────────┴─────────────┴─────────────┴─────────────┘
```

#### 2.3.2 ARP 操作类型
- **ARP 请求**（操作码 1）：广播询问 IP 对应的 MAC
- **ARP 响应**（操作码 2）：单播回复 MAC 地址
- **RARP 请求**（操作码 3）：询问 MAC 对应的 IP（反向 ARP）
- **RARP 响应**（操作码 4）：回复 IP 地址

#### 2.3.3 以太网帧格式
```
┌─────────────┬─────────────┬─────┬─────────────┬─────────────┐
│ 目的 MAC    │ 源 MAC      │类型 │ 数据        │ CRC 校验    │
│ (6 字节)    │ (6 字节)    │(2)  │ (46-1500)   │ (4 字节)    │
└─────────────┴─────────────┴─────┴─────────────┴─────────────┘
```""",
        "content_advanced": """#### 2.4.1 ARP 安全问题
- **ARP 欺骗（ARP Spoofing）**：恶意主机伪造 ARP 响应，劫持流量
- **ARP 泛洪**：大量伪造 ARP 请求，消耗交换机资源
- **ARP 投毒**：污染 ARP 缓存表

#### 2.4.2 ARP 防护措施
- **静态 ARP 绑定**：手动配置 IP-MAC 映射
- **ARP 检测工具**：如 Arpwatch 监控 ARP 变化
- **交换机安全功能**：端口安全、DHCP Snooping

#### 2.4.3 VLAN 技术
- VLAN（Virtual LAN）虚拟局域网
- 通过交换机端口划分广播域
- 增强网络安全和性能
- 支持跨交换机 VLAN（Trunk）""",
        "labs_1": "检查 ARP 缓存：打开命令行，输入 arp -a 查看当前 ARP 表",
        "labs_2": """观察 ARP 解析过程：
1. 清空 ARP 缓存（需要管理员权限）
   Windows：arp -d *
   Linux：ip neigh flush all
2. Ping 同一网段的其他主机：ping 192.168.1.X
3. 再次查看 ARP 缓存：arp -a
4. 观察新添加的 ARP 条目""",
        "labs_3": "使用 Wireshark 捕获 ARP 流量，分析请求和响应的报文结构",
        "reinforce": [
            "解释 ARP 协议的工作流程，用自己的话描述每一步",
            "什么是广播域？举例说明广播域对网络通信的影响",
            "交换机如何学习和维护 MAC 地址表？",
        ],
        "criteria": [
            "能解释 ARP 协议的基本工作原理",
            "能在 ARP 缓存中识别 IP-MAC 映射关系",
            "理解交换机在二层网络中的作用",
        ],
    },
    {
        "day": 3,
        "module": "网络与协议基础",
        "topic": "IP、ICMP 与路由基础",
        "objectives": [
            "理解 IP 寻址与子网划分",
            "掌握 Ping/Traceroute 的用途与差异",
        ],
        "content_basics": """#### 3.1.1 IP 地址的基本概念
- IP（Internet Protocol）地址是网络层的逻辑地址
- 分为 IPv4 和 IPv6 两个版本
- 用于标识网络中的主机和路由

#### 3.1.2 ICMP 协议简介
- ICMP（Internet Control Message Protocol）互联网控制报文协议
- 用于网络设备的故障诊断和错误报告
- 不传输用户数据，而是传输控制信息

#### 3.1.3 路由的基本概念
- 路由是指数据包从源主机到目的主机的路径选择
- 路由器是实现路由功能的网络设备
- 路由表包含到达目的网络的路径信息""",
        "content_principle": """#### 3.2.1 子网划分原理
- 子网掩码用于划分网络和主机部分
- 网络位相同的 IP 地址在同一个子网
- 子网划分可以减少广播域，提高网络性能

#### 3.2.2 Ping 工作原理
1. 发送 ICMP Echo Request 报文
2. 目的主机回复 ICMP Echo Reply 报文
3. 通过往返时间（RTT）判断网络连通性和质量

#### 3.2.3 Traceroute 工作原理
1. 发送 TTL=1 的 IP 数据包，第一个路由器回复 TTL 超时
2. 逐渐增加 TTL 值，直到到达目的主机
3. 记录每个中间路由器的 IP 地址

#### 3.2.4 路由表工作机制
- 路由表包含目的网络、子网掩码、下一跳、接口等信息
- 路由选择按最长匹配原则（最具体的路由优先）
- 默认路由（0.0.0.0/0）匹配所有未明确路由的流量""",
        "content_tech": """#### 3.3.1 IP 数据包格式
```
┌─────────────┬─────────────┬─────┬─────┬─────────────┐
│ 版本+首部长 │ 服务类型    │总长度│标识 │标志+片偏移│
│ (1 字节)    │ (1 字节)    │(2)  │(2)  │ (2 字节)   │
├─────────────┼─────────────┼─────┼─────┼─────────────┤
│TTL          │ 协议        │首部校验和│源 IP 地址  │
│ (1 字节)    │ (1 字节)    │(2)  │ (4 字节)   │
├─────────────┼─────────────┼─────┼─────┼─────────────┤
│目的 IP 地址 │ 选项        │填充 │ 数据        │
│ (4 字节)    │ (可变)      │(可变)│ (可变)     │
└─────────────┴─────────────┴─────┴─────────────┘
```

#### 3.3.2 ICMP 报文类型
- **Echo Request/Reply**（类型 8/0）：Ping 命令
- **Time Exceeded**（类型 11）：TTL 超时，Traceroute 使用
- **Destination Unreachable**（类型 3）：目的不可达

#### 3.3.3 路由表示例
```
目标网络        子网掩码        网关            接口
0.0.0.0         0.0.0.0         192.168.1.1     以太网
192.168.1.0     255.255.255.0   在链路上       以太网
127.0.0.0       255.0.0.0       在链路上       环回
```""",
        "content_advanced": """#### 3.4.1 CIDR（无类域间路由）
- Classless Inter-Domain Routing
- 使用斜杠表示法：192.168.1.0/24
- 提供更灵活的地址分配

#### 3.4.2 路由协议分类
- **静态路由**：手动配置，适用于小型网络
- **动态路由**：自动学习，适用于大型网络
  - 距离向量：RIP
  - 链路状态：OSPF
  - 路径向量：BGP

#### 3.4.3 ICMP 安全考虑
- ICMP 可能被用于网络扫描和攻击
- 防火墙通常限制 ICMP 流量
- 但完全禁用可能影响网络诊断""",
        "labs_1": "查看本机 IP 配置：Windows 使用 ipconfig，Linux/Mac 使用 ifconfig 或 ip addr",
        "labs_2": """测试网络连通性：
1. Ping 本机环回地址：ping 127.0.0.1
2. Ping 网关地址：ping 192.168.1.1（替换为实际网关）
3. Ping 公共 DNS：ping 8.8.8.8
4. 记录每次 Ping 的结果和往返时间""",
        "labs_3": """使用 Traceroute 分析路径：
1. Windows：tracert 8.8.8.8
2. Linux/Mac：traceroute 8.8.8.8
3. 观察经过的路由器数量和位置
4. 比较到不同目标的路径差异""",
        "reinforce": [
            "解释 IP 地址和 MAC 地址的区别及其各自的作用",
            "计算 192.168.1.0/24 网络的可用主机地址范围",
            "描述 Traceroute 如何确定网络路径",
        ],
        "criteria": [
            "能正确解释路由表各项的含义",
            "能使用 Ping 和 Traceroute 进行基本网络诊断",
            "理解子网划分的基本原理",
        ],
    },
    {
        "day": 4,
        "module": "网络与协议基础",
        "topic": "TCP/UDP 与会话",
        "objectives": [
            "掌握 TCP 三次握手与四次挥手",
            "理解 UDP 的无连接特性与适用场景",
        ],
        "content_basics": """#### 4.1.1 TCP 协议特点
- TCP（Transmission Control Protocol）传输控制协议
- 面向连接的可靠传输协议
- 提供流量控制、拥塞控制、错误检测和纠正
- 适用于要求可靠传输的应用

#### 4.1.2 UDP 协议特点
- UDP（User Datagram Protocol）用户数据报协议
- 无连接的不可靠传输协议
- 传输速度快，开销小
- 适用于实时性要求高的应用

#### 4.1.3 端口的概念
- 端口是传输层用于区分不同应用进程的标识符
- 范围：0-65535
- 知名端口：0-1023（系统服务使用）
- 动态端口：49152-65535（临时分配）""",
        "content_principle": """#### 4.2.1 TCP 三次握手建立连接
1. **客户端** 发送 SYN 报文（同步序列号）
2. **服务器** 回复 SYN+ACK 报文（同步+确认）
3. **客户端** 发送 ACK 报文（确认）
4. 连接建立，开始数据传输

#### 4.2.2 TCP 四次挥手关闭连接
1. **主动关闭方** 发送 FIN 报文（结束）
2. **被动关闭方** 回复 ACK 报文（确认）
3. **被动关闭方** 发送 FIN 报文（结束）
4. **主动关闭方** 回复 ACK 报文（确认）
5. 连接完全关闭

#### 4.2.3 TCP 状态机
- **LISTEN**：等待连接请求
- **SYN_SENT**：已发送 SYN，等待响应
- **SYN_RECV**：已收到 SYN，等待确认
- **ESTABLISHED**：连接已建立
- **FIN_WAIT_1/2**：主动关闭，等待对方响应
- **CLOSE_WAIT**：被动关闭，等待应用层关闭
- **TIME_WAIT**：确保对方收到最后的 ACK

#### 4.2.4 会话标识（五元组）
TCP/UDP 连接的唯一标识：
- 源 IP 地址
- 目的 IP 地址
- 源端口号
- 目的端口号
- 协议类型（TCP/UDP）""",
        "content_tech": """#### 4.3.1 TCP 头部格式
```
┌─────────────┬─────────────┬─────────────┬─────────────┐
│源端口(16)   │目的端口(16) │序列号(32)   │确认号(32)   │
├─────────────┼─────────────┼─────┼─────┼─────────────┤
│首部长度(4)  │保留(6)      │标志 │窗口大小(16) │
├─────────────┼─────────────┼─────┼─────┼─────────────┤
│校验和(16)   │紧急指针(16)│选项 │填充 │ 数据      │
└─────────────┴─────────────┴─────┴─────┴─────────────┘
```

#### 4.3.2 TCP 标志位
- **SYN**：同步，建立连接
- **ACK**：确认，响应序列号
- **FIN**：结束，关闭连接
- **RST**：重置，异常终止连接
- **PSH**：推送，立即发送数据
- **URG**：紧急，紧急数据

#### 4.3.3 UDP 头部格式
```
┌─────────────┬─────────────┬─────────────┬─────────────┐
│源端口(16)   │目的端口(16) │长度(16)     │校验和(16)   │
└─────────────┴─────────────┴─────────────┴─────────────┘
```

#### 4.3.4 TCP 流量控制
- 使用滑动窗口机制
- 接收方通告窗口大小
- 发送方根据窗口大小发送数据
- 避免接收方缓冲区溢出""",
        "content_advanced": """#### 4.4.1 TCP 拥塞控制
- **慢启动**：指数增长拥塞窗口
- **拥塞避免**：线性增长拥塞窗口
- **快速重传**：收到3个重复ACK立即重传
- **快速恢复**：收到重复ACK时减半拥塞窗口

#### 4.4.2 TCP 超时重传
- 基于往返时间（RTT）估算超时时间
- 采用指数退避算法
- Karn 算法：避免重传歧义

#### 4.4.3 TCP 与 UDP 的选择
- **选择 TCP 的情况**：
  - 需要可靠传输（HTTP、FTP、SMTP）
  - 数据完整性重要
  - 网络条件较差
- **选择 UDP 的情况**：
  - 实时性要求高（VoIP、视频流）
  - 允许少量丢包（DNS、DHCP）
  - 网络条件良好""",
        "labs_1": "查看系统端口使用情况：Windows 使用 netstat -ano，Linux/Mac 使用 netstat -tlnp 或 ss -tlnp",
        "labs_2": """观察 TCP 握手过程：
1. 打开 Wireshark，开始捕获
2. 在浏览器中访问一个网站
3. 停止捕获，过滤 TCP 流量
4. 找到 TCP 握手包，分析 SYN、SYN+ACK、ACK 报文""",
        "labs_3": """对比 TCP 和 UDP：
1. 访问网站（TCP）：观察大量 TCP 包
2. 执行 DNS 查询（UDP）：nslookup example.com，观察 UDP 包
3. 比较两种协议的包结构和数量差异""",
        "reinforce": [
            "详细描述 TCP 三次握手的每一步及其作用",
            "解释为什么 TCP 需要四次挥手而不是三次",
            "列举 TCP 和 UDP 的主要区别，并给出各自适用的应用场景",
        ],
        "criteria": [
            "能准确描述 TCP 连接建立和关闭的过程",
            "能解释 TCP 和 UDP 的区别及其适用场景",
            "能在抓包中识别 TCP 状态和关键报文",
        ],
    },
    {
        "day": 5,
        "module": "网络与协议基础",
        "topic": "DNS 工作流",
        "objectives": [
            "理解解析流程与常见记录类型（A/AAAA/CNAME/MX/TXT）",
            "能抓包与解释一次 DNS 解析",
        ],
        "content_basics": """#### 5.1.1 DNS 的作用
- DNS（Domain Name System）域名系统
- 将人类可读的域名转换为 IP 地址
- 提供域名到 IP 的映射服务
- 是互联网的基础服务之一

#### 5.1.2 DNS 层次结构
- **根域名服务器**：最高层，管理顶级域
- **顶级域（TLD）服务器**：管理 .com、.org 等顶级域
- **权威域名服务器**：管理具体域名的记录
- **本地 DNS 服务器**：缓存解析结果

#### 5.1.3 DNS 解析类型
- **递归解析**：客户端要求 DNS 服务器完成完整解析
- **迭代解析**：DNS 服务器指引客户端逐步查询

#### 5.1.4 DNS 记录类型
- **A 记录**：域名到 IPv4 地址
- **AAAA 记录**：域名到 IPv6 地址
- **CNAME 记录**：域名别名
- **MX 记录**：邮件交换记录
- **TXT 记录**：文本记录""",
        "content_principle": """#### 5.2.1 DNS 解析流程
1. **客户端查询**：浏览器请求解析 www.example.com
2. **本地 DNS 查询**：检查本地缓存
3. **根服务器查询**：查询 .com 顶级域服务器
4. **TLD 服务器查询**：返回 example.com 权威服务器
5. **权威服务器查询**：返回 www.example.com 的 A 记录
6. **结果缓存**：本地 DNS 缓存结果，客户端也可能缓存

#### 5.2.2 DNS 缓存机制
- **浏览器缓存**：短时间缓存
- **操作系统缓存**：较长时间缓存
- **本地 DNS 缓存**：根据 TTL 缓存
- **TTL（Time To Live）**：记录生存时间

#### 5.2.3 CNAME 解析过程
1. 查询 www.example.com 的 CNAME 记录
2. 得到别名 web.example.com
3. 继续查询 web.example.com 的 A 记录
4. 得到最终 IP 地址

#### 5.2.4 DNS 递归 vs 迭代
- **递归查询**：客户端要求服务器完成所有解析工作
- **迭代查询**：服务器指引客户端逐步查询各级服务器""",
        "content_tech": """#### 5.3.1 DNS 报文格式
```
DNS 头部 (12 字节)
┌─────────────┬─────────────┬─────────────┬─────────────┐
│标识(16)     │标志(16)     │问题数(16)   │资源记录数(16)│
├─────────────┼─────────────┼─────┼─────┼─────────────┤
│权威记录数(16)│附加记录数(16)│问题 │回答 │ 权威    │
├─────────────┼─────────────┼─────┼─────┼─────────────┤
│附加         │ 查询名称    │查询类型│查询类│ 资源记录 │
└─────────────┴─────────────┴─────┴─────┴─────────────┘
```

#### 5.3.2 DNS 查询类型
- **A (1)**：IPv4 地址记录
- **AAAA (28)**：IPv6 地址记录
- **CNAME (5)**：规范名称记录
- **MX (15)**：邮件交换记录
- **TXT (16)**：文本记录
- **NS (2)**：名称服务器记录
- **PTR (12)**：指针记录（反向解析）

#### 5.3.3 DNS 响应码
- **NOERROR (0)**：成功
- **NXDOMAIN (3)**：域名不存在
- **SERVFAIL (2)**：服务器错误
- **REFUSED (5)**：查询被拒绝

#### 5.3.4 nslookup 命令用法
```bash
nslookup www.example.com        # 查询 A 记录
nslookup -type=MX example.com   # 查询 MX 记录
nslookup -type=TXT example.com  # 查询 TXT 记录
```""",
        "content_advanced": """#### 5.4.1 DNS 安全问题
- **DNS 缓存投毒**：污染 DNS 缓存，返回虚假 IP
- **DNS 欺骗**：伪造 DNS 响应
- **DNS 放大攻击**：利用 DNS 放大流量

#### 5.4.2 DNSSEC 安全扩展
- 为 DNS 数据提供数字签名
- 验证 DNS 响应的真实性
- 防止 DNS 缓存投毒攻击

#### 5.4.3 DNS over HTTPS (DoH)
- 将 DNS 查询封装在 HTTPS 中
- 提高隐私保护
- 避免 ISP 监视 DNS 查询

#### 5.4.4 DNS 解析优化
- **预解析**：浏览器提前解析可能访问的域名
- **CDN 调度**：根据地理位置返回最近的 IP
- **Anycast**：多个服务器使用相同 IP 地址""",
        "labs_1": "查看本机 DNS 配置：Windows 使用 ipconfig /all，Linux/Mac 使用 cat /etc/resolv.conf",
        "labs_2": """使用 nslookup 查询 DNS 记录：
1. 查询 A 记录：nslookup www.baidu.com
2. 查询 MX 记录：nslookup -type=MX baidu.com
3. 查询 NS 记录：nslookup -type=NS baidu.com
4. 记录每次查询的结果和响应时间""",
        "labs_3": """抓取 DNS 查询包：
1. 打开 Wireshark，设置过滤器：udp port 53
2. 清除 DNS 缓存（ipconfig /flushdns）
3. 访问一个新网站，观察 DNS 查询过程
4. 分析查询和响应的报文结构""",
        "reinforce": [
            "描述完整的 DNS 解析流程，包括各级服务器的作用",
            "解释 CNAME 记录的作用及其解析过程",
            "DNS 缓存的层次有哪些？TTL 如何影响缓存？",
        ],
        "criteria": [
            "能使用 nslookup 或 dig 进行各种 DNS 查询",
            "能在抓包中识别 DNS 查询和响应报文",
            "理解 DNS 解析的完整流程和各级服务器作用",
        ],
    },
    {
        "day": 6,
        "module": "网络与协议基础",
        "topic": "HTTP 基础",
        "objectives": [
            "理解请求/响应结构与常见头部",
            "认识明文 HTTP 的安全风险",
        ],
        "content_basics": """#### 6.1.1 HTTP 协议简介
- HTTP（HyperText Transfer Protocol）超文本传输协议
- 应用层协议，用于 Web 浏览器和服务器之间的通信
- 无状态协议，每个请求都是独立的
- 基于 TCP 协议，默认端口 80

#### 6.1.2 HTTP 请求方法
- **GET**：获取资源
- **POST**：提交数据
- **PUT**：更新资源
- **DELETE**：删除资源
- **HEAD**：获取响应头
- **OPTIONS**：查询支持的方法

#### 6.1.3 HTTP 状态码
- **1xx**：信息性状态码（继续处理）
- **2xx**：成功状态码（200 OK）
- **3xx**：重定向状态码（301 永久重定向，302 临时重定向）
- **4xx**：客户端错误（404 未找到，403 禁止访问）
- **5xx**：服务器错误（500 内部错误，502 网关错误）

#### 6.1.4 HTTP 头部字段
- **请求头**：Host、User-Agent、Accept、Cookie 等
- **响应头**：Content-Type、Content-Length、Set-Cookie 等
- **通用头**：Connection、Cache-Control、Date 等""",
        "content_principle": """#### 6.2.1 HTTP 请求格式
```
请求行：GET /index.html HTTP/1.1
请求头：
Host: www.example.com
User-Agent: Mozilla/5.0
Accept: text/html
空行
请求体（可选）
```

#### 6.2.2 HTTP 响应格式
```
状态行：HTTP/1.1 200 OK
响应头：
Content-Type: text/html
Content-Length: 1024
Server: Apache/2.4.1
空行
响应体（HTML 内容）
```

#### 6.2.3 Cookie 和 Session
- **Cookie**：服务器发送给客户端的小型文本文件
- **Session**：服务器端存储的用户会话信息
- **用途**：保持用户登录状态、个性化设置等

#### 6.2.4 HTTP 版本演进
- **HTTP/1.0**：每次请求建立新连接
- **HTTP/1.1**：支持持久连接、管道化请求
- **HTTP/2**：多路复用、头部压缩、二进制协议
- **HTTP/3**：基于 QUIC 协议，改进性能和安全性""",
        "content_tech": """#### 6.3.1 常见请求头
- **Host**：指定请求的主机名和端口
- **User-Agent**：客户端浏览器和操作系统信息
- **Accept**：客户端可接受的媒体类型
- **Accept-Language**：客户端偏好的语言
- **Authorization**：身份验证凭据
- **Referer**：请求来源页面
- **Cookie**：客户端存储的 Cookie 数据

#### 6.3.2 常见响应头
- **Content-Type**：响应内容的媒体类型
- **Content-Length**：响应体的长度
- **Set-Cookie**：设置客户端 Cookie
- **Location**：重定向的目标 URL
- **Cache-Control**：缓存控制指令
- **ETag**：实体标签，用于缓存验证
- **Last-Modified**：资源最后修改时间

#### 6.3.3 HTTP 消息体
- **请求体**：POST、PUT 等方法携带的数据
- **响应体**：服务器返回的资源内容
- **编码**：Content-Encoding（gzip、deflate）
- **分块传输**：Transfer-Encoding: chunked

#### 6.3.4 URL 编码
- 将特殊字符转换为 %XX 格式
- 空格编码为 %20 或 +
- 中文字符需要 UTF-8 编码后转换为 %XX 格式""",
        "content_advanced": """#### 6.4.1 HTTP 安全风险
- **明文传输**：数据未加密，容易被窃听
- **中间人攻击**：攻击者可以修改请求和响应
- **会话劫持**：窃取 Cookie 后冒充用户
- **重放攻击**：重复发送合法请求

#### 6.4.2 HTTPS 升级
- 使用 TLS 加密 HTTP 流量
- 提供数据机密性、完整性和认证
- 默认端口 443
- 证书验证服务器身份

#### 6.4.3 HTTP 缓存机制
- **浏览器缓存**：根据 Cache-Control、Expires 头
- **CDN 缓存**：分布式缓存网络
- **代理缓存**：中间代理服务器缓存

#### 6.4.4 RESTful API 设计
- 使用 HTTP 方法表示操作语义
- 使用状态码表示操作结果
- 使用 URL 表示资源位置
- 无状态设计，易于扩展""",
        "labs_1": "使用浏览器开发者工具查看 HTTP 请求：在 Chrome 中按 F12，查看 Network 标签",
        "labs_2": """分析 HTTP 请求和响应：
1. 打开浏览器开发者工具的 Network 面板
2. 访问一个网站，观察请求列表
3. 点击一个请求，查看请求头、响应头和响应体
4. 记录关键字段：方法、状态码、Content-Type、User-Agent 等""",
        "labs_3": """搭建简单 HTTP 服务器：
1. Python：python -m http.server 8000
2. Node.js：npx http-server
3. 访问 http://localhost:8000，观察请求和响应
4. 使用 curl 测试：curl -v http://localhost:8000""",
        "reinforce": [
            "解释 HTTP 请求和响应的完整结构",
            "列举 5 个重要的 HTTP 状态码及其含义",
            "HTTP Cookie 和 Session 的区别和联系是什么？",
        ],
        "criteria": [
            "能分析 HTTP 请求和响应的各个组成部分",
            "能解释常见 HTTP 头部的含义和作用",
            "理解 HTTP 的无状态性和安全风险",
        ],
    },
    {
        "day": 7,
        "module": "网络与协议基础",
        "topic": "Wireshark 入门与综合分析",
        "objectives": [
            "熟练使用过滤器（显示/捕获）",
            "完成一次综合流量分析与报告",
        ],
        "content": [
            "常用过滤表达式（ip.addr、tcp.port、http）",
            "导出/标注/书签与报告导出",
        ],
        "labs": [
            "捕获包含 DNS、HTTP、TCP 握手的综合流量并标注关键报文",
            "输出一份简短分析报告（含截图）",
        ],
        "reinforce": [
            "练习：为常见分析场景编写 5 条过滤表达式",
            "自测：解释一次异常重传与超时的可能原因",
        ],
        "criteria": [
            "能独立完成抓包过滤与标注",
            "提交一份结构清晰的分析报告",
        ],
    },

    # Week 2
    {
        "day": 8,
        "module": "安全协议与加密",
        "topic": "TLS 概念与握手",
        "objectives": [
            "理解 TLS 握手流程与密码套件的作用",
            "识别握手中的关键消息（ClientHello/ServerHello 等）",
        ],
        "content_basics": """#### 8.1.1 TLS 协议简介
- TLS（Transport Layer Security）传输层安全协议
- SSL（Secure Socket Layer）的后续版本
- 提供网络通信的安全性和数据完整性
- 位于应用层和传输层之间

#### 8.1.2 TLS 的主要功能
- **加密**：使用对称加密保护数据传输
- **认证**：验证通信双方的身份
- **完整性**：确保数据不被篡改
- **前向保密**：防止过去的会话密钥被破解

#### 8.1.3 TLS 版本演进
- **SSL 3.0**：已弃用，存在安全漏洞
- **TLS 1.0**：已弃用，存在安全风险
- **TLS 1.1**：已弃用，改进有限
- **TLS 1.2**：目前广泛使用
- **TLS 1.3**：最新版本，性能更好，安全性更高

#### 8.1.4 TLS 密码套件
- 定义加密算法的组合
- 包含密钥交换、数字签名、对称加密算法
- 示例：TLS_RSA_WITH_AES_128_CBC_SHA256""",
        "content_principle": """#### 8.2.1 TLS 握手流程（TLS 1.2）
1. **ClientHello**：客户端发送支持的 TLS 版本和密码套件
2. **ServerHello**：服务器选择 TLS 版本和密码套件
3. **Certificate**：服务器发送证书链
4. **ServerKeyExchange**（可选）：服务器发送密钥交换参数
5. **ServerHelloDone**：服务器完成握手准备
6. **ClientKeyExchange**：客户端发送预主密钥
7. **ChangeCipherSpec**：双方切换到加密模式
8. **Finished**：验证握手完整性

#### 8.2.2 TLS 1.3 握手优化
1. **ClientHello**：客户端发送支持的参数
2. **ServerHello**：服务器选择参数并发送证书
3. **Encrypted Extensions**：加密的扩展信息
4. **Finished**：完成握手

TLS 1.3 减少了往返次数，提高了性能。

#### 8.2.3 密钥协商过程
- **RSA 密钥交换**：使用服务器公钥加密预主密钥
- **DH 密钥交换**：使用 Diffie-Hellman 算法协商密钥
- **ECDHE**：椭圆曲线 Diffie-Hellman，提供前向保密

#### 8.2.4 会话重用
- **Session ID**：重用之前的会话参数
- **Session Ticket**：服务器签发的会话票据
- 避免重复握手，提高性能""",
        "content_tech": """#### 8.3.1 TLS 记录协议
```
┌─────────────┬─────────────┬─────┬─────┬─────────────┐
│内容类型(1)  │版本(2)      │长度(2)│数据 │MAC(可选)  │
└─────────────┴─────────────┴─────┴─────┴─────────────┘
```

#### 8.3.2 TLS 握手消息类型
- **ClientHello (1)**：客户端问候
- **ServerHello (2)**：服务器问候
- **Certificate (11)**：证书
- **ServerKeyExchange (12)**：服务器密钥交换
- **ClientKeyExchange (16)**：客户端密钥交换
- **Finished (20)**：完成

#### 8.3.3 密码套件组成
- **密钥交换算法**：RSA、DH、ECDH
- **签名算法**：RSA、ECDSA
- **对称加密算法**：AES、ChaCha20
- **哈希算法**：SHA256、SHA384

#### 8.3.4 TLS 扩展
- **SNI (Server Name Indication)**：服务器名称指示
- **ALPN (Application Layer Protocol Negotiation)**：应用层协议协商
- **OCSP Stapling**：在线证书状态协议装订
- **Session Tickets**：会话票据""",
        "content_advanced": """#### 8.4.1 TLS 安全特性
- **前向保密**：使用临时密钥，防止过去会话被破解
- **证书固定**：客户端记住服务器证书，避免中间人攻击
- **HSTS**：强制使用 HTTPS，防止降级攻击

#### 8.4.2 TLS 性能优化
- **会话重用**：避免重复握手
- **False Start**：在握手完成前开始发送数据
- **TLS 1.3 0-RTT**：零往返时间握手
- **OCSP Stapling**：减少证书验证延迟

#### 8.4.3 TLS 调试工具
- **openssl s_client**：测试 TLS 连接
- **ssllabs.com**：在线 TLS 配置检查
- **Wireshark**：抓包分析 TLS 握手
- **tls-debugger**：TLS 协议调试

#### 8.4.4 TLS 常见问题
- **证书过期**：证书超过有效期
- **证书链不完整**：缺少中间证书
- **弱密码套件**：使用不安全的加密算法
- **协议降级**：被迫使用旧版本 TLS""",
        "labs_1": "查看浏览器支持的 TLS 版本：在 Chrome 中访问 chrome://settings/security",
        "labs_2": """使用 openssl 测试 TLS 连接：
1. 安装 openssl（Windows 可从官网下载）
2. 测试连接：openssl s_client -connect www.baidu.com:443
3. 查看证书信息和支持的密码套件
4. 测试不同 TLS 版本：-tls1_2、-tls1_3 参数""",
        "labs_3": """抓取 TLS 握手包：
1. 打开 Wireshark，设置过滤器：tcp port 443
2. 访问 HTTPS 网站，观察握手过程
3. 分析 ClientHello、ServerHello、Certificate 等消息
4. 比较 TLS 1.2 和 TLS 1.3 的握手差异""",
        "reinforce": [
            "详细描述 TLS 握手的完整流程",
            "什么是前向保密？为什么重要？",
            "TLS 密码套件包含哪些组件？各有什么作用？",
        ],
        "criteria": [
            "能识别 TLS 握手中的关键消息",
            "能使用 openssl 分析服务器 TLS 配置",
            "理解密码套件选择对安全性的影响",
        ],
    },
    {
        "day": 9,
        "module": "安全协议与加密",
        "topic": "证书与信任链",
        "objectives": [
            "理解证书、CA、链验证与撤销",
            "会用 OpenSSL 检查证书与链",
        ],
        "content_basics": """#### 9.1.1 数字证书简介
- 数字证书是包含公钥和身份信息的电子文档
- 由可信的第三方（CA）签发
- 用于验证通信双方的身份
- 基于 X.509 标准

#### 9.1.2 证书颁发机构（CA）
- **根 CA**：最高层可信机构，自签名证书
- **中间 CA**：由根 CA 或上级中间 CA 签发
- **商业 CA**：如 DigiCert、Let's Encrypt
- **私有 CA**：企业内部使用

#### 9.1.3 证书信任链
- 证书链：服务器证书 → 中间证书 → 根证书
- 客户端验证整个链的合法性
- 根证书预装在操作系统或浏览器中

#### 9.1.4 证书类型
- **DV 证书**：域名验证，仅验证域名所有权
- **OV 证书**：组织验证，验证域名和组织信息
- **EV 证书**：扩展验证，最严格的验证过程""",
        "content_principle": """#### 9.2.1 X.509 证书结构
```
证书版本
序列号
签名算法
颁发者（Issuer）
有效期（Validity）
主题（Subject）
公钥信息
扩展字段（Extensions）
签名
```

#### 9.2.2 关键证书字段
- **Subject**：证书持有者的身份信息
- **Issuer**：证书颁发者的身份信息
- **Validity**：证书的有效期
- **Public Key**：证书持有者的公钥
- **Signature**：CA 对证书内容的数字签名

#### 9.2.3 证书扩展字段
- **Subject Alternative Name (SAN)**：证书的备用名称
- **Key Usage**：公钥的允许用途
- **Extended Key Usage**：扩展密钥用途
- **Basic Constraints**：基本约束（是否为 CA 证书）

#### 9.2.4 证书验证过程
1. 检查证书是否在有效期内
2. 验证证书签名是否正确
3. 检查证书是否被撤销
4. 验证证书链的完整性
5. 检查主机名是否匹配证书""",
        "content_tech": """#### 9.3.1 OpenSSL 证书查看命令
```bash
# 查看证书文本信息
openssl x509 -in cert.pem -text -noout

# 查看证书指纹
openssl x509 -in cert.pem -fingerprint -sha256

# 验证证书链
openssl verify -CAfile cacert.pem cert.pem

# 检查证书撤销状态
openssl ocsp -issuer cacert.pem -cert cert.pem -url ocsp.example.com
```

#### 9.3.2 证书文件格式
- **PEM**：Base64 编码的文本格式，以 -----BEGIN CERTIFICATE----- 开头
- **DER**：二进制格式
- **PKCS#12**：包含私钥的二进制格式，通常用 .pfx 或 .p12 扩展名

#### 9.3.3 证书吊销机制
- **CRL (Certificate Revocation List)**：证书吊销列表
- **OCSP (Online Certificate Status Protocol)**：在线证书状态协议
- **OCSP Stapling**：服务器预先获取 OCSP 响应并随证书一起发送

#### 9.3.4 证书匹配规则
- **CN (Common Name)**：证书的通用名称（已弃用）
- **SAN (Subject Alternative Name)**：证书的备用名称（推荐）
- 支持多个域名、IP 地址、通配符""",
        "content_advanced": """#### 9.4.1 证书安全问题
- **证书伪造**：攻击者获取虚假证书
- **中间人攻击**：使用伪造证书拦截通信
- **证书固定攻击**：客户端不验证证书
- **证书过期**：证书超过有效期仍被使用

#### 9.4.2 证书透明度（CT）
- 记录所有签发的证书到公开日志
- 允许任何人检查证书是否被正确签发
- 帮助发现恶意证书

#### 9.4.3 ACME 协议
- 自动化证书管理环境
- Let's Encrypt 使用此协议自动签发证书
- 支持证书的自动申请、续期和吊销

#### 9.4.4 证书最佳实践
- 使用 SAN 而非 CN
- 定期轮换证书
- 使用强加密算法
- 实施证书固定（Certificate Pinning）
- 监控证书过期时间""",
        "labs_1": "导出网站证书：在浏览器中点击地址栏锁图标，查看证书详情",
        "labs_2": """使用 OpenSSL 查看证书：
1. 下载网站证书：openssl s_client -connect www.baidu.com:443 -showcerts
2. 保存证书到文件：复制 -----BEGIN CERTIFICATE----- 到 -----END CERTIFICATE----- 部分
3. 查看证书详情：openssl x509 -in cert.pem -text -noout
4. 检查证书链：openssl verify -CAfile cacert.pem cert.pem""",
        "labs_3": """验证证书撤销状态：
1. 查找证书的 OCSP URL
2. 使用 OpenSSL 检查：openssl ocsp -issuer cacert.pem -cert cert.pem -url <ocsp_url>
3. 观察响应：good（有效）、revoked（已吊销）、unknown（未知）
4. 比较 CRL 和 OCSP 的差异""",
        "reinforce": [
            "解释证书信任链的工作原理",
            "证书吊销有哪两种主要机制？各有什么优缺点？",
            "为什么现代证书使用 SAN 而不是 CN？",
        ],
        "criteria": [
            "能使用 OpenSSL 查看和分析证书内容",
            "能验证证书链的完整性和有效性",
            "理解证书吊销机制和检查方法",
        ],
    },
    {
        "day": 10,
        "module": "安全协议与加密",
        "topic": "HTTPS 抓包与安全特性",
        "objectives": [
            "认识 HTTPS 加密不可见正文的特性",
            "理解 HSTS 的作用（理论）",
        ],
        "content_basics": """#### 10.1.1 HTTPS 协议简介
- HTTPS = HTTP + TLS
- 在 HTTP 基础上增加了 TLS 加密层
- 默认端口 443
- 提供安全的 Web 通信

#### 10.1.2 HTTPS 的安全特性
- **机密性**：数据被加密，防止窃听
- **完整性**：数据完整性校验，防止篡改
- **认证**：服务器身份验证，防止冒充
- **不可否认性**：通过数字签名防止否认

#### 10.1.3 HSTS（HTTP Strict Transport Security）
- 强制浏览器使用 HTTPS 访问网站
- 防止 SSL Stripping 攻击
- 通过响应头 `Strict-Transport-Security` 配置

#### 10.1.4 中间人攻击（MITM）
- 攻击者在通信双方之间拦截和修改数据
- HTTPS 通过证书验证防止 MITM 攻击
- 但证书信任库被污染时仍可能受攻击""",
        "content_principle": """#### 10.2.1 HTTPS 通信流程
1. **TCP 连接建立**：三次握手建立 TCP 连接
2. **TLS 握手**：协商加密参数，建立安全通道
3. **HTTP 数据传输**：加密的 HTTP 请求和响应
4. **TCP 连接关闭**：四次挥手关闭连接

#### 10.2.2 HTTPS 抓包特点
- **握手阶段可见**：ClientHello、ServerHello、Certificate 等
- **应用数据加密**：HTTP 正文在 TLS 加密层内
- **元信息可见**：服务器 IP、端口、SNI、证书信息
- **流量特征可见**：包大小、方向、时间间隔

#### 10.2.3 HSTS 工作机制
1. 服务器在 HTTPS 响应中发送 `Strict-Transport-Security` 头
2. 浏览器记录该域名必须使用 HTTPS
3. 将来访问该域名时自动使用 HTTPS
4. 有效期内阻止任何 HTTP 访问

#### 10.2.4 MITM 攻击防范
- 证书链验证
- 证书固定（Certificate Pinning）
- HSTS 强制 HTTPS
- HPKP（已弃用）
- 定期更新证书信任库""",
        "content_tech": """#### 10.3.1 Wireshark HTTPS 过滤器
```bash
# 过滤 HTTPS 流量
tcp.port == 443

# 过滤 TLS 握手
tls.handshake

# 过滤特定握手消息
tls.handshake.type == 1    # ClientHello
tls.handshake.type == 2    # ServerHello
tls.handshake.type == 11   # Certificate

# 过滤加密应用数据
tls.record.content_type == 23   # Application Data
```

#### 10.3.2 HTTPS 流量分析要点
- **SNI (Server Name Indication)**：客户端请求的域名
- **证书链**：服务器证书、中间证书、根证书
- **密码套件**：协商使用的加密算法
- **会话重用**：是否重用之前的 TLS 会话

#### 10.3.3 HSTS 响应头格式
```
Strict-Transport-Security: max-age=31536000; includeSubDomains; preload
```
- max-age：有效期（秒）
- includeSubDomains：包含子域
- preload：加入浏览器预加载列表

#### 10.3.4 curl 测试 HTTPS
```bash
# 查看响应头
curl -I https://example.com

# 查看详细握手信息
curl -v https://example.com

# 忽略证书错误（仅测试）
curl -k https://example.com
```""",
        "content_advanced": """#### 10.4.1 HTTPS 性能影响
- **握手开销**：额外的往返时间
- **加密解密开销**：CPU 计算资源消耗
- **TLS 1.3 优化**：减少握手往返次数
- **会话重用**：避免重复握手

#### 10.4.2 HTTPS 调试技巧
- **SSLKEYLOGFILE**：记录 TLS 密钥用于 Wireshark 解密
- **mitmproxy**：中间人代理进行 HTTPS 调试
- **浏览器开发者工具**：查看证书和安全信息
- **ssllabs.com**：在线 HTTPS 配置评估

#### 10.4.3 HTTPS 混合内容问题
- **混合内容**：HTTPS 页面加载 HTTP 资源
- **主动混合**：页面本身请求 HTTP 资源
- **被动混合**：第三方脚本加载 HTTP 资源
- **解决方案**：统一使用 HTTPS，CSP 策略

#### 10.4.4 HTTPS 证书问题排查
- **证书过期**：检查证书有效期
- **证书链不完整**：确认中间证书
- **主机名不匹配**：检查 CN 和 SAN
- **证书被吊销**：检查 OCSP/CRL 状态""",
        "labs_1": "使用浏览器开发者工具查看 HTTPS 连接：在 Security 标签查看证书和连接信息",
        "labs_2": """抓取 HTTPS 握手包：
1. 打开 Wireshark，设置过滤器：tcp.port == 443
2. 清除浏览器缓存，避免 HSTS 影响
3. 访问 HTTPS 网站，观察握手过程
4. 分析 ClientHello 中的 SNI、支持的密码套件
5. 查看 ServerHello 的选择结果""",
        "labs_3": """比较不同网站的 HTTPS 配置：
1. 访问 github.com 和一个小型网站
2. 比较证书颁发机构（DV vs OV vs EV）
3. 查看 TLS 版本和密码套件差异
4. 检查是否启用 HSTS 和 HPKP
5. 使用 ssllabs.com 进行评分比较""",
        "reinforce": [
            "解释为什么抓包工具看不到 HTTPS 的 HTTP 正文内容",
            "HSTS 头的工作原理和配置参数是什么？",
            "HTTPS 如何防范中间人攻击？",
        ],
        "criteria": [
            "能在 Wireshark 中识别 HTTPS 握手的关键阶段",
            "能分析证书和 TLS 配置的安全性",
            "理解 HSTS 和其他 HTTPS 安全特性的作用",
        ],
    },
    {
        "day": 11,
        "module": "安全协议与加密",
        "topic": "SSH 与密钥认证",
        "objectives": [
            "理解 SSH 工作原理与密钥认证流程",
            "掌握基本安全配置建议",
        ],
        "content": [
            "SSH 协议握手与 HostKey 验证",
            "禁用密码登录、仅允许强密钥、限制用户/来源",
        ],
        "labs": [
            "在自建 Linux 虚拟机上配置 SSH 密钥登录（授权范围）",
            "检查 sshd_config 中的关键安全项并记录",
        ],
        "reinforce": [
            "题目：为何建议禁用 root 直登？",
            "练习：生成 Ed25519 密钥并配置",
        ],
        "criteria": [
            "能完成密钥登录并说明配置项意义",
            "形成 SSH 加固检查清单",
        ],
    },
    {
        "day": 12,
        "module": "安全协议与加密",
        "topic": "加密基础：哈希/对称/非对称",
        "objectives": [
            "区分哈希、对称与非对称加密的用途",
            "理解签名与密钥交换的基本原理",
        ],
        "content": [
            "常见算法：SHA-2/3、AES、RSA、ECDSA、ChaCha20",
            "安全使用注意事项：盐、迭代、随机性",
        ],
        "labs": [
            "用 Python 对文本做哈希与校验",
            "生成密钥对并演示签名与验签",
        ],
        "reinforce": [
            "题目：哈希与加密的区别是什么？",
            "练习：简述一次签名流程",
        ],
        "criteria": [
            "能实现基础哈希与签名演示",
            "能说明各算法适用场景",
        ],
    },
    {
        "day": 13,
        "module": "安全协议与加密",
        "topic": "加密应用与场景",
        "objectives": [
            "理解加密在传输、存储与认证中的应用",
            "识别常见错误配置与风险",
        ],
        "content": [
            "传输层安全、静态数据加密、密码存储最佳实践",
            "密钥管理与轮换",
        ],
        "labs": [
            "对一个示例应用的密码存储进行安全性评估（理论/代码审阅）",
            "提出改进建议并记录",
        ],
        "reinforce": [
            "题目：为什么不能用明文或可逆加密存储密码？",
            "练习：设计一套密码存储策略",
        ],
        "criteria": [
            "能提出合理的密码存储改进建议",
            "形成应用加密检查清单",
        ],
    },
    {
        "day": 14,
        "module": "安全协议与加密",
        "topic": "周综合实验与测评",
        "objectives": [
            "完成 TLS/SSH/加密基础的整体验证",
            "形成一份周度总结报告",
        ],
        "content": [
            "回顾本周知识点与实验记录",
            "整理问题与改进项",
        ],
        "labs": [
            "选择 2-3 个场景进行复现与截图记录",
            "输出周报（含证据与结论）",
        ],
        "reinforce": [
            "题目：选择一项本周内容做 5 分钟讲解提纲",
            "练习：补充错题与易错点",
        ],
        "criteria": [
            "提交结构完整的周报",
            "覆盖关键知识点复现",
        ],
    },

    # Week 3 (sample entries, the rest will follow similar detail)
    {
        "day": 15,
        "module": "操作系统与脚本",
        "topic": "Linux 安全基础",
        "objectives": [
            "理解用户/组、权限、服务与日志基础",
            "会做基础加固（仅自建环境）",
        ],
        "content": [
            "用户/权限模型、sudo、安全日志位置",
            "服务管理与开机项",
        ],
        "labs": [
            "创建受限用户与最小权限配置",
            "查看/分析常见安全日志并记录",
        ],
        "reinforce": [
            "题目：解释 755/644 权限含义",
            "练习：写 5 条加固检查项",
        ],
        "criteria": [
            "完成最小权限配置与日志审阅",
            "形成加固清单",
        ],
    },
    {
        "day": 16,
        "module": "操作系统与脚本",
        "topic": "Windows 安全基础",
        "objectives": [
            "理解本地用户、组与权限模型",
            "掌握常见审计日志位置与查看方法",
            "认识服务与启动项的安全影响",
        ],
        "content": [
            "本地安全策略（secpol.msc）与事件查看器",
            "UAC、远程桌面与防火墙基础配置",
            "常见攻击面（SMB、RDP 等）的最小化暴露原则",
        ],
        "labs": [
            "创建受限用户并配置 UAC 安全级别，记录变更",
            "使用事件查看器定位登录事件与安全日志，并导出样例",
        ],
        "reinforce": [
            "题目：解释为何不建议启用匿名共享",
            "练习：列出 5 条 Windows 主机加固项并说明原因",
        ],
        "criteria": [
            "提交加固变更记录与日志截图",
            "能说明关键安全事件的含义与排查路径",
        ],
    },
    {
        "day": 17,
        "module": "操作系统与脚本",
        "topic": "Shell 脚本入门与批处理",
        "objectives": [
            "掌握基本语法：变量、条件、循环、函数",
            "能编写批量处理与日志整理脚本",
        ],
        "content": [
            "Bash 与 PowerShell 基本语法对照",
            "文本处理（grep/sed/awk）与管道组合",
        ],
        "labs": [
            "编写脚本批量解析日志，统计错误类型与次数",
            "将结果输出为 CSV 并按时间排序",
        ],
        "reinforce": [
            "题目：描述管道与重定向的区别",
            "练习：写出一个带函数与循环的实用脚本",
        ],
        "criteria": [
            "脚本可重复运行并生成正确的输出",
            "提交脚本与运行截图/结果文件",
        ],
    },
    {
        "day": 18,
        "module": "操作系统与脚本",
        "topic": "Python 脚本入门（文本与网络）",
        "objectives": [
            "能进行文件读写与正则匹配",
            "能发起 HTTP 请求并解析响应",
        ],
        "content": [
            "标准库：pathlib、re、json、urllib/requests（任选其一）",
            "基本异常处理与日志记录",
        ],
        "labs": [
            "编写脚本读取日志并用正则提取字段（时间/级别/消息）",
            "请求公开 API 并解析 JSON，输出关键信息",
        ],
        "reinforce": [
            "题目：简述 try/except 的用途与最佳实践",
            "练习：完成一个可配置的日志过滤器",
        ],
        "criteria": [
            "脚本能稳定运行并处理异常",
            "提交源码与示例输出",
        ],
    },
    {
        "day": 19,
        "module": "操作系统与脚本",
        "topic": "Nmap 端口扫描安全使用",
        "objectives": [
            "理解不同扫描方式与适用场景（仅授权环境）",
            "掌握常用参数与输出解析",
        ],
        "content": [
            "TCP SYN、TCP Connect、UDP 扫描差异",
            "服务版本识别（-sV）与脚本（-sC）",
        ],
        "labs": [
            "在自建靶场对目标进行端口扫描并导出结果",
            "编写解析脚本，将 Nmap 输出转换为结构化数据",
        ],
        "reinforce": [
            "题目：解释 -sS 与 -sT 的差异与影响",
            "练习：设计一套稳妥的扫描参数组合",
        ],
        "criteria": [
            "输出包含端口/服务/版本的清单",
            "记录授权范围与安全注意事项",
        ],
    },
    {
        "day": 20,
        "module": "操作系统与脚本",
        "topic": "服务枚举与指纹识别",
        "objectives": [
            "能识别常见服务的特征与版本",
            "能结合脚本实现批量枚举",
        ],
        "content": [
            "Banner 抓取、协议握手与响应解析",
            "组合使用 Nmap + 自编脚本进行指纹识别",
        ],
        "labs": [
            "针对靶场多个主机进行服务枚举并汇总",
            "输出版本矩阵与潜在风险提示（理论）",
        ],
        "reinforce": [
            "题目：为什么 Banner 可能不可靠？",
            "练习：用两种方法交叉验证版本信息",
        ],
        "criteria": [
            "提交服务矩阵与验证方法说明",
            "脚本化输出可复用",
        ],
    },
    {
        "day": 21,
        "module": "操作系统与脚本",
        "topic": "周综合实验与测评（OS+枚举+脚本）",
        "objectives": [
            "完成从主机加固到端口与服务枚举的闭环",
            "形成结构化周报与改进项",
        ],
        "content": [
            "回顾本周练习与脚本库",
            "整理问题、记录风险与建议",
        ],
        "labs": [
            "选择一台 Linux 与一台 Windows 完成加固与审计",
            "对靶场执行枚举并完成报告（含脚本与输出）",
        ],
        "reinforce": [
            "题目：总结本周最有价值的 3 条经验",
            "练习：完善脚本库的 README 与使用说明",
        ],
        "criteria": [
            "提交周报与证据链（截图/日志/脚本）",
            "明确后续优化计划",
        ],
    },

    # Week 4：漏洞扫描、基线与加固（Day022 ~ Day028）
    {
        "day": 22,
        "module": "漏洞扫描与基线",
        "topic": "漏洞类型与编号体系",
        "objectives": [
            "理解 CVE/CWE/CVSS 的含义与用途",
            "能根据 CVSS 评分初步判断风险等级",
        ],
        "content": [
            "常见漏洞类别（配置、逻辑、输入校验等）",
            "CVE 数据库与 CWE 类别，CVSS 各维度解释",
        ],
        "labs": [
            "选择 3 个 CVE 阅读官方描述与缓解建议",
            "为一个示例漏洞计算/解释 CVSS 分值",
        ],
        "reinforce": [
            "题目：CVSS 中的攻击向量与复杂度如何影响评分？",
            "练习：对一个案例做风险陈述",
        ],
        "criteria": [
            "提交分析笔记与评分解释",
            "能正确归类漏洞类型",
        ],
    },
    {
        "day": 23,
        "module": "漏洞扫描与基线",
        "topic": "扫描器安装与合规使用",
        "objectives": [
            "理解扫描器原理与探测方式",
            "能在授权靶场安全配置并运行",
        ],
        "content": [
            "扫描模式（轻量/深度）、认证扫描与无认证",
            "报告结构与误报/漏报的识别",
        ],
        "labs": [
            "在靶场运行一次基线扫描并导出报告",
            "标注 3 个高风险项并查阅修复建议",
        ],
        "reinforce": [
            "题目：如何区分误报与真风险？",
            "练习：编写报告摘要与处置建议",
        ],
        "criteria": [
            "输出扫描报告与关键项说明",
            "记录授权范围与合规声明",
        ],
    },
    {
        "day": 24,
        "module": "漏洞扫描与基线",
        "topic": "系统基线与审计",
        "objectives": [
            "掌握通用系统基线项（口令策略、补丁、服务）",
            "能执行脚本化检查并输出结果",
        ],
        "content": [
            "弱口令与口令策略、补丁与更新、暴露服务清单",
            "常见审计命令与脚本（Linux/Windows）",
        ],
        "labs": [
            "编写脚本检查本机/靶机的关键基线项并输出 CSV",
            "对异常项给出加固建议与记录",
        ],
        "reinforce": [
            "题目：列举 5 条常见基线项",
            "练习：设计检查脚本的可扩展结构",
        ],
        "criteria": [
            "提交检查脚本与输出文件",
            "对异常给出合理建议",
        ],
    },
    {
        "day": 25,
        "module": "漏洞扫描与基线",
        "topic": "Web 中间件暴露面与加固",
        "objectives": [
            "识别常见中间件的默认配置与风险",
            "能给出基础加固建议",
        ],
        "content": [
            "Nginx/Apache/IIS 的目录/头部/日志相关配置",
            "关闭目录列出、隐藏版本、限制方法与来源",
        ],
        "labs": [
            "在靶场中调整 Web 中间件配置并记录前后差异",
            "检查头部与暴露信息的变化（抓包/响应）",
        ],
        "reinforce": [
            "题目：为何建议隐藏版本信息？",
            "练习：给出一个安全的基础配置示例",
        ],
        "criteria": [
            "配置文件与验证截图齐备",
            "能说明加固项的影响",
        ],
    },
    {
        "day": 26,
        "module": "漏洞扫描与基线",
        "topic": "自动化基线检查与报告",
        "objectives": [
            "将基线检查与导出报告脚本化",
            "保证可复用与扩展",
        ],
        "content": [
            "脚本参数化与模块化设计",
            "导出为 CSV/JSON 并生成简要汇总",
        ],
        "labs": [
            "完善基线检查脚本，支持多主机批量输出",
            "生成汇总报告并标注异常项",
        ],
        "reinforce": [
            "题目：如何避免脚本硬编码？",
            "练习：加入日志与错误处理",
        ],
        "criteria": [
            "脚本具备参数与错误处理",
            "汇总报告结构清晰",
        ],
    },
    {
        "day": 27,
        "module": "漏洞扫描与基线",
        "topic": "加固复验与变更记录",
        "objectives": [
            "能复验加固效果并形成变更记录",
            "理解回归与兼容性风险",
        ],
        "content": [
            "复验流程与对比方法",
            "变更记录模板与审批流程（理论）",
        ],
        "labs": [
            "对前日加固项进行复验并记录差异",
            "形成变更记录与回滚策略",
        ],
        "reinforce": [
            "题目：如何处理加固引发的兼容问题？",
            "练习：撰写变更记录示例",
        ],
        "criteria": [
            "提交复验报告与变更记录",
            "能说明风险与回滚方案",
        ],
    },
    {
        "day": 28,
        "module": "漏洞扫描与基线",
        "topic": "周综合实验与测评（扫描+基线+加固）",
        "objectives": [
            "完成一次从扫描到加固的闭环",
            "输出结构化周报与改进清单",
        ],
        "content": [
            "汇总本周的报告与脚本",
            "梳理误报/漏报与处置策略",
        ],
        "labs": [
            "在靶场选择一个目标完成扫描、基线检查与加固复验",
            "提交完整报告与证据链",
        ],
        "reinforce": [
            "题目：本周最易忽视的风险是什么？",
            "练习：完善加固检查清单",
        ],
        "criteria": [
            "周报完整、逻辑清晰、证据充分",
            "提出可执行的改进计划",
        ],
    },

    # Week 5：日志、可观测性、SIEM 入门（Day029 ~ Day035）
    {
        "day": 29,
        "module": "日志与可观测性",
        "topic": "日志类型与字段规范",
        "objectives": [
            "识别不同类型日志及其关键字段",
            "理解规范化与合规要求的意义",
        ],
        "content": [
            "系统/应用/安全/访问日志的字段定义",
            "时间戳、主机名、用户、事件类型与上下文",
        ],
        "labs": [
            "采集两类日志并对字段进行标准化映射",
            "输出统一格式样例（JSON/CSV）",
        ],
        "reinforce": [
            "题目：为何需要统一字段？",
            "练习：设计一份日志规范草案",
        ],
        "criteria": [
            "提交规范草案与样例数据",
            "能说明规范化的好处",
        ],
    },
    {
        "day": 30,
        "module": "日志与可观测性",
        "topic": "收集与传输：Syslog/Filebeat 入门",
        "objectives": [
            "理解收集与传输链路",
            "能配置基础数据管道",
        ],
        "content": [
            "Syslog 协议与 Filebeat 采集配置",
            "缓冲与重试策略、简单过滤",
        ],
        "labs": [
            "搭建本地采集与转发（本机→收集端）",
            "验证数据到达与格式正确",
        ],
        "reinforce": [
            "题目：传输失败如何兜底？",
            "练习：加入简单的过滤规则",
        ],
        "criteria": [
            "数据端到端可见",
            "提交配置文件与验证截图",
        ],
    },
    {
        "day": 31,
        "module": "日志与可观测性",
        "topic": "存储与查询：Elastic/OpenSearch 概览",
        "objectives": [
            "理解索引与映射",
            "能执行基础查询与可视化",
        ],
        "content": [
            "索引设计、字段映射与分片副本",
            "查询 DSL 与聚合",
        ],
        "labs": [
            "创建索引并导入样例日志",
            "编写查询与聚合，制作一个简单图表",
        ],
        "reinforce": [
            "题目：映射不当会带来什么问题？",
            "练习：优化一个查询的性能",
        ],
        "criteria": [
            "索引与查询工作正常",
            "提交查询与图表截图",
        ],
    },
    {
        "day": 32,
        "module": "日志与可观测性",
        "topic": "可视化与告警策略",
        "objectives": [
            "搭建基础仪表盘",
            "设计简单告警规则",
        ],
        "content": [
            "关键指标选择与阈值设定",
            "告警抑制与噪声控制",
        ],
        "labs": [
            "创建一个仪表盘监控 3 项指标",
            "配置 2 条告警并触发验证",
        ],
        "reinforce": [
            "题目：如何减少告警噪声？",
            "练习：编写告警分级策略",
        ],
        "criteria": [
            "仪表盘可用，告警可触发",
            "提交策略说明与验证证据",
        ],
    },
    {
        "day": 33,
        "module": "日志与可观测性",
        "topic": "日志规范与字段统一",
        "objectives": [
            "将不同来源日志统一字段",
            "形成规范文档",
        ],
        "content": [
            "字段映射策略与标准化约定",
            "兼容与扩展考虑",
        ],
        "labs": [
            "将 2 种来源日志映射到统一规范并落地",
            "补充缺失字段与默认值策略",
        ],
        "reinforce": [
            "题目：统一字段对跨系统分析的意义？",
            "练习：为新增系统设计映射方案",
        ],
        "criteria": [
            "提交规范与映射样例",
            "验证查询可跨来源一致",
        ],
    },
    {
        "day": 34,
        "module": "日志与可观测性",
        "topic": "事件响应初步：从日志到推理",
        "objectives": [
            "能从日志中识别异常并初步推理",
            "形成简单处置建议",
        ],
        "content": [
            "常见异常模式与关联分析",
            "从告警到初步处置的流程",
        ],
        "labs": [
            "构造一段异常日志，进行定位与关联分析",
            "输出初步处置建议与证据",
        ],
        "reinforce": [
            "题目：如何避免误判？",
            "练习：完善证据链条",
        ],
        "criteria": [
            "提交分析与建议",
            "证据链条清晰",
        ],
    },
    {
        "day": 35,
        "module": "日志与可观测性",
        "topic": "周综合实验与测评（日志链路+告警）",
        "objectives": [
            "搭建从采集到告警的最小闭环",
            "形成周报与改进项",
        ],
        "content": [
            "回顾数据管道与规范化成果",
            "评估告警质量与噪声",
        ],
        "labs": [
            "演示一次异常的发现与告警触发",
            "提交管道配置与仪表盘截图",
        ],
        "reinforce": [
            "题目：总结本周告警优化策略",
            "练习：完善日志规范",
        ],
        "criteria": [
            "周报完整、证据充分",
            "提出可执行优化",
        ],
    },

    # Week 6：Web 安全（OWASP Top 10）（Day036 ~ Day042）
    {
        "day": 36,
        "module": "Web 安全",
        "topic": "OWASP 与威胁建模基础",
        "objectives": [
            "理解 OWASP Top 10 范畴与意义",
            "掌握简单威胁建模方法",
        ],
        "content": [
            "OWASP Top 10 总览与示例",
            "威胁建模流程与边界设置（仅授权靶场）",
        ],
        "labs": [
            "为一个示例应用做简单威胁建模",
            "输出风险与缓解策略列表",
        ],
        "reinforce": [
            "题目：为何需要威胁建模？",
            "练习：完善模型中的证据项",
        ],
        "criteria": [
            "提交模型与缓解清单",
            "风险陈述清晰",
        ],
    },
    {
        "day": 37,
        "module": "Web 安全",
        "topic": "身份认证与会话安全（CSRF）",
        "objectives": [
            "理解认证与会话的常见风险",
            "认识 CSRF 原理与防护",
        ],
        "content": [
            "认证流程、会话管理、令牌与过期策略",
            "CSRF 与 SameSite/CORS 设置",
        ],
        "labs": [
            "在靶场演示不安全的会话管理（仅演示合法靶场）",
            "配置防护策略并验证效果",
        ],
        "reinforce": [
            "题目：为什么会话固定是风险？",
            "练习：设计合理的会话过期与再认证",
        ],
        "criteria": [
            "提交演示与修复前后对比",
            "能解释各设置的作用",
        ],
    },
    {
        "day": 38,
        "module": "Web 安全",
        "topic": "输入校验与注入（SQLi/XSS）",
        "objectives": [
            "理解注入的根因与防护",
            "能在授权靶场进行演示与修复",
        ],
        "content": [
            "参数化查询、输出编码与白名单校验",
            "反射/存储 XSS 与上下文编码",
        ],
        "labs": [
            "在靶场演示一次 SQLi 与 XSS（严格授权范围）",
            "应用修复并验证不再复现",
        ],
        "reinforce": [
            "题目：为什么黑名单校验不可靠？",
            "练习：编写输入校验策略",
        ],
        "criteria": [
            "提交演示与修复证据",
            "能说明修复原理",
        ],
    },
    {
        "day": 39,
        "module": "Web 安全",
        "topic": "文件上传与路径风险",
        "objectives": [
            "理解上传与路径穿越的风险",
            "会设计安全的上传策略",
        ],
        "content": [
            "白名单扩展名、MIME 验证与存储位置隔离",
            "路径规范化与权限控制",
        ],
        "labs": [
            "在靶场验证不安全上传策略可能的后果（理论演示）",
            "实施安全策略并复验",
        ],
        "reinforce": [
            "题目：为何需要目录隔离？",
            "练习：撰写上传安全检查清单",
        ],
        "criteria": [
            "提交前后对比与检查清单",
            "能说明策略的具体效果",
        ],
    },
    {
        "day": 40,
        "module": "Web 安全",
        "topic": "API 安全与限流鉴权",
        "objectives": [
            "识别 API 常见风险",
            "掌握速率限制、鉴权与授权策略",
        ],
        "content": [
            "鉴权方案（JWT/OAuth2 等）与作用域",
            "速率限制与防刷策略",
        ],
        "labs": [
            "为示例 API 配置限流与鉴权并验证",
            "编写文档说明使用与错误码",
        ],
        "reinforce": [
            "题目：JWT 的风险点在哪？",
            "练习：设计权限模型与作用域",
        ],
        "criteria": [
            "提交配置与验证截图",
            "说明安全收益与边界",
        ],
    },
    {
        "day": 41,
        "module": "Web 安全",
        "topic": "错误处理、日志与 WAF 边界",
        "objectives": [
            "理解错误信息暴露的风险",
            "认识 WAF 的作用与边界",
        ],
        "content": [
            "统一错误处理与安全日志记录",
            "WAF 规则基础与绕过可能（理论）",
        ],
        "labs": [
            "实现统一错误输出并记录安全日志",
            "配置基础 WAF 规则并观察效果",
        ],
        "reinforce": [
            "题目：为什么不能输出堆栈到用户界面？",
            "练习：撰写日志字段清单",
        ],
        "criteria": [
            "错误输出规范化，日志字段完整",
            "能说明 WAF 的边界",
        ],
    },
    {
        "day": 42,
        "module": "Web 安全",
        "topic": "周综合实验与测评（Top 10 选题）",
        "objectives": [
            "完成两个以上 OWASP 风险的演示与修复",
            "形成周报与检查清单",
        ],
        "content": [
            "汇总演示、修复方案与证据",
            "记录误报与边界",
        ],
        "labs": [
            "在靶场选择 2-3 项 Top 10 风险进行演示与修复",
            "输出报告与检查清单",
        ],
        "reinforce": [
            "题目：总结最有效的防护策略",
            "练习：完善项目的安全基线",
        ],
        "criteria": [
            "周报完整、证据充分",
            "提出后续优化计划",
        ],
    },

    # Week 7：网络防护与设备（Day043 ~ Day049）
    {
        "day": 43,
        "module": "网络防护",
        "topic": "防火墙类型与规则设计",
        "objectives": [
            "理解不同类型防火墙的工作方式",
            "能编写最小权限的访问控制规则",
        ],
        "content": [
            "包过滤/状态检测/应用层防火墙",
            "规则设计与顺序、日志与审计",
        ],
        "labs": [
            "在实验环境中编写入站/出站规则并验证",
            "记录命中与阻断的日志",
        ],
        "reinforce": [
            "题目：默认拒绝策略的好处是什么？",
            "练习：为一个服务设计白名单规则",
        ],
        "criteria": [
            "规则生效并有审计记录",
            "说明最小权限原则应用",
        ],
    },
    {
        "day": 44,
        "module": "网络防护",
        "topic": "IDS/IPS 原理与告警分析",
        "objectives": [
            "理解 IDS/IPS 的工作方式与差异",
            "能分析基础告警事件",
        ],
        "content": [
            "特征与行为检测、告警分类",
            "误报与调优",
        ],
        "labs": [
            "部署简易 IDS 并触发样例告警（授权环境）",
            "分析告警并记录调整建议",
        ],
        "reinforce": [
            "题目：如何降低误报？",
            "练习：编写告警调优清单",
        ],
        "criteria": [
            "提交告警截图与分析",
            "提出合理调优建议",
        ],
    },
    {
        "day": 45,
        "module": "网络防护",
        "topic": "网络分段与访问控制、零信任初步",
        "objectives": [
            "理解分段的意义与策略",
            "认识零信任的基本理念",
        ],
        "content": [
            "VLAN/子网分段与 ACL",
            "身份驱动的访问策略（理论）",
        ],
        "labs": [
            "设计一个简易的分段方案并实现基本 ACL",
            "验证跨段访问的限制与日志",
        ],
        "reinforce": [
            "题目：为什么分段能降低风险？",
            "练习：撰写零信任的落地要点",
        ],
        "criteria": [
            "分段与 ACL 生效",
            "提交验证与日志",
        ],
    },
    {
        "day": 46,
        "module": "网络防护",
        "topic": "VPN 与远程接入安全",
        "objectives": [
            "理解隧道与加密的作用",
            "能配置基础安全策略",
        ],
        "content": [
            "常见 VPN 类型与身份认证",
            "最小权限与分离策略",
        ],
        "labs": [
            "为测试环境配置安全的远程接入策略",
            "验证访问范围与日志记录",
        ],
        "reinforce": [
            "题目：远程接入的风险与防范？",
            "练习：设计接入审批与审计流程",
        ],
        "criteria": [
            "策略生效并记录访问日志",
            "说明安全收益与限制",
        ],
    },
    {
        "day": 47,
        "module": "网络防护",
        "topic": "边界与内部防护协同",
        "objectives": [
            "认识边界与内部防护的配合",
            "避免常见误区",
        ],
        "content": [
            "边界策略、内部监控与响应联动",
            "隔离、蜜罐与引诱（理论）",
        ],
        "labs": [
            "编写一个简单的联动流程图与规则清单",
            "模拟一次内部异常并记录响应",
        ],
        "reinforce": [
            "题目：为何仅边界防护不足？",
            "练习：提出内部监控的关键点",
        ],
        "criteria": [
            "流程图与规则清单完整",
            "说明联动的价值",
        ],
    },
    {
        "day": 48,
        "module": "网络防护",
        "topic": "策略编排与变更流程",
        "objectives": [
            "掌握策略编排的基础方法",
            "形成规范的变更流程",
        ],
        "content": [
            "策略模板与审批、回滚计划",
            "变更影响分析与测试",
        ],
        "labs": [
            "编写一份策略变更模板并演练",
            "记录影响分析与测试结果",
        ],
        "reinforce": [
            "题目：如何避免策略冲突？",
            "练习：设计审批与回滚机制",
        ],
        "criteria": [
            "模板完整、演练通过",
            "有影响分析与记录",
        ],
    },
    {
        "day": 49,
        "module": "网络防护",
        "topic": "周综合实验与测评（网络防护）",
        "objectives": [
            "完成防火墙/IDS/分段的综合演练",
            "形成周报与改进项",
        ],
        "content": [
            "汇总策略与日志",
            "评估误报与性能影响",
        ],
        "labs": [
            "对靶场实施综合防护演练并提交证据链",
            "输出报告与建议",
        ],
        "reinforce": [
            "题目：本周最有效的策略是什么？",
            "练习：完善规则与监控",
        ],
        "criteria": [
            "周报完整、证据充分",
            "提出优化计划",
        ],
    },

    # Week 8：渗透测试方法论与合规（Day050 ~ Day056）
    {
        "day": 50,
        "module": "渗透测试方法论",
        "topic": "流程与范围（严格授权）",
        "objectives": [
            "理解渗测流程与范围控制",
            "掌握证据与记录要求",
        ],
        "content": [
            "信息收集、攻击面分析、验证与复现",
            "授权文件与边界声明",
        ],
        "labs": [
            "在靶场制定一次渗测计划与范围",
            "准备证据记录模板",
        ],
        "reinforce": [
            "题目：为何必须有授权？",
            "练习：编写边界声明样例",
        ],
        "criteria": [
            "提交计划与模板",
            "说明合规边界",
        ],
    },
    {
        "day": 51,
        "module": "渗透测试方法论",
        "topic": "靶场搭建与用例设计",
        "objectives": [
            "能搭建基本靶场",
            "设计验证用例",
        ],
        "content": [
            "靶机与防护配置、数据回放（理论）",
            "用例编排与风险分级",
        ],
        "labs": [
            "搭建最小可用靶场并记录配置",
            "设计 5 个用例并定义预期结果",
        ],
        "reinforce": [
            "题目：用例如何覆盖关键面？",
            "练习：优化用例的证据项",
        ],
        "criteria": [
            "靶场可用，用例明确",
            "提交配置与用例文档",
        ],
    },
    {
        "day": 52,
        "module": "渗透测试方法论",
        "topic": "工具链（枚举/字典/弱口令）",
        "objectives": [
            "熟悉工具链的合法使用",
            "能在范围内进行验证",
        ],
        "content": [
            "枚举与目录、字典策略（仅授权）",
            "登录与弱口令验证（靶场）",
        ],
        "labs": [
            "对靶场执行枚举并记录证据",
            "验证弱口令用例并给出加固建议",
        ],
        "reinforce": [
            "题目：字典策略的风险与限制？",
            "练习：设计合理的限速与锁定策略",
        ],
        "criteria": [
            "证据清晰、范围合规",
            "提出修复建议",
        ],
    },
    {
        "day": 53,
        "module": "渗透测试方法论",
        "topic": "验证与复现记录",
        "objectives": [
            "能规范化记录复现步骤与证据",
            "形成可审阅材料",
        ],
        "content": [
            "截图、日志、命令与输出记录",
            "版本与环境说明",
        ],
        "labs": [
            "为一个用例撰写完整复现文档",
            "提交证据与结论",
        ],
        "reinforce": [
            "题目：证据不足会导致什么问题？",
            "练习：完善文档结构",
        ],
        "criteria": [
            "文档完整、可复审",
            "证据链条完整",
        ],
    },
    {
        "day": 54,
        "module": "渗透测试方法论",
        "topic": "报告撰写与评分参考（CVSS）",
        "objectives": [
            "掌握报告结构与评分说明",
            "能给出修复建议",
        ],
        "content": [
            "报告结构：概览、技术细节、影响与建议",
            "CVSS 评分与业务影响",
        ],
        "labs": [
            "撰写一个示例报告并附评分与建议",
            "提交评审版",
        ],
        "reinforce": [
            "题目：如何面向业务方解释风险？",
            "练习：完善建议的可执行性",
        ],
        "criteria": [
            "报告结构清晰、评分合理",
            "建议可落地",
        ],
    },
    {
        "day": 55,
        "module": "渗透测试方法论",
        "topic": "复测与修复跟踪、沟通要点",
        "objectives": [
            "能进行复测并跟踪修复进度",
            "掌握沟通与记录的关键点",
        ],
        "content": [
            "复测流程与版本管理",
            "跨团队沟通要点",
        ],
        "labs": [
            "对一个已修复用例进行复测与记录",
            "形成跟踪表与结案说明",
        ],
        "reinforce": [
            "题目：如何避免复测的偏差？",
            "练习：完善跟踪表字段",
        ],
        "criteria": [
            "复测证据完整",
            "结案记录规范",
        ],
    },
    {
        "day": 56,
        "module": "渗透测试方法论",
        "topic": "周综合实验与测评（方法论）",
        "objectives": [
            "完成方法论闭环演练",
            "形成周报与模板库",
        ],
        "content": [
            "汇总计划、用例、报告与复测记录",
            "完善模板与清单",
        ],
        "labs": [
            "选择一个主题完成闭环演练并提交证据",
            "整理模板库（计划/报告/复测）",
        ],
        "reinforce": [
            "题目：本周流程中最易遗漏的环节？",
            "练习：完善证据模板",
        ],
        "criteria": [
            "周报与证据完整",
            "模板库可复用",
        ],
    },

    # Week 9：内网与横向基础（Day057 ~ Day063）
    {
        "day": 57,
        "module": "内网基础",
        "topic": "AD/域基础与风险面",
        "objectives": [
            "理解域与身份的基本概念",
            "识别常见风险面（理论）",
        ],
        "content": [
            "域结构与组策略",
            "常见暴露点与最小化原则",
        ],
        "labs": [
            "在实验环境中查看示例组策略与权限设置",
            "记录潜在风险点与加固建议",
        ],
        "reinforce": [
            "题目：为何最小权限对域至关重要？",
            "练习：提出 5 条域加固建议",
        ],
        "criteria": [
            "提交风险与建议清单",
            "能说明域结构与影响",
        ],
    },
    {
        "day": 58,
        "module": "内网基础",
        "topic": "凭据与会话管理",
        "objectives": [
            "理解凭据与会话的安全要点",
            "能最小化暴露与泄漏风险",
        ],
        "content": [
            "凭据存储与转移（理论）",
            "会话保护与过期策略",
        ],
        "labs": [
            "检查实验主机的凭据暴露面并记录",
            "制定最小化策略并验证",
        ],
        "reinforce": [
            "题目：为什么要避免共享凭据？",
            "练习：撰写会话保护策略",
        ],
        "criteria": [
            "提出可执行的最小化措施",
            "验证效果与记录",
        ],
    },
    {
        "day": 59,
        "module": "内网基础",
        "topic": "横向常见手段（理论与模拟）",
        "objectives": [
            "认识横向移动的常见方法（理论）",
            "仅做模拟与防护演练",
        ],
        "content": [
            "常见横向路径与防护点（理论）",
            "日志与检测的关注点",
        ],
        "labs": [
            "模拟横向场景的日志与告警（不做未授权操作）",
            "记录检测与处置流程",
        ],
        "reinforce": [
            "题目：横向检测的关键证据是什么？",
            "练习：设计防护策略",
        ],
        "criteria": [
            "提交模拟日志与流程图",
            "说明防护要点",
        ],
    },
    {
        "day": 60,
        "module": "内网基础",
        "topic": "日志追踪与证据链",
        "objectives": [
            "能通过日志构建证据链条",
            "形成追踪报告",
        ],
        "content": [
            "时间线与会话关联",
            "多源日志的整合方法",
        ],
        "labs": [
            "为模拟场景构建一条时间线与证据链",
            "提交追踪报告",
        ],
        "reinforce": [
            "题目：如何避免证据链断裂？",
            "练习：设计日志字段要求",
        ],
        "criteria": [
            "时间线完整、证据清晰",
            "报告可复审",
        ],
    },
    {
        "day": 61,
        "module": "内网基础",
        "topic": "加固与策略优化",
        "objectives": [
            "针对内网风险提出加固措施",
            "优化策略与流程",
        ],
        "content": [
            "权限最小化、隔离与监控",
            "审批与审计流程",
        ],
        "labs": [
            "为实验环境制定加固清单并实施部分",
            "提交验证与记录",
        ],
        "reinforce": [
            "题目：哪些加固最优先？",
            "练习：完善流程文档",
        ],
        "criteria": [
            "清单明确、实施有效",
            "有证据与记录",
        ],
    },
    {
        "day": 62,
        "module": "内网基础",
        "topic": "蓝队视角：检测与处置",
        "objectives": [
            "从蓝队视角设计检测与处置流程",
            "明确触发与响应",
        ],
        "content": [
            "告警分级与处置步骤",
            "证据采集与保全",
        ],
        "labs": [
            "编写一份检测处置流程并演练",
            "记录处置与证据",
        ],
        "reinforce": [
            "题目：如何保证证据可用？",
            "练习：完善流程的触发条件",
        ],
        "criteria": [
            "流程清晰、演练通过",
            "证据规范",
        ],
    },
    {
        "day": 63,
        "module": "内网基础",
        "topic": "周综合实验与测评（内网）",
        "objectives": [
            "完成内网基础与蓝队演练",
            "形成周报与优化计划",
        ],
        "content": [
            "汇总风险、日志与处置",
            "评估优化效果",
        ],
        "labs": [
            "选择一个内网主题完成演练并提交证据",
            "输出周报与计划",
        ],
        "reinforce": [
            "题目：本周最关键的检测点？",
            "练习：完善加固清单",
        ],
        "criteria": [
            "周报完整、证据充分",
            "优化计划明确",
        ],
    },

    # Week 10：云与容器安全（Day064 ~ Day070）
    {
        "day": 64,
        "module": "云与容器安全",
        "topic": "云共享责任模型与账号权限",
        "objectives": [
            "理解共享责任模型",
            "掌握账号与权限的安全实践",
        ],
        "content": [
            "账号与角色、最小权限与分离",
            "密钥与凭据管理",
        ],
        "labs": [
            "在测试云环境中配置最小权限角色（可用本地模拟）",
            "记录变更与权限验证",
        ],
        "reinforce": [
            "题目：共享责任如何影响安全边界？",
            "练习：设计角色权限方案",
        ],
        "criteria": [
            "权限配置生效并有验证",
            "说明方案合理性",
        ],
    },
    {
        "day": 65,
        "module": "云与容器安全",
        "topic": "网络与存储安全、配置管理",
        "objectives": [
            "掌握网络与存储的基本安全控制",
            "理解配置管理的重要性",
        ],
        "content": [
            "安全组/ACL、对象存储权限",
            "配置版本化与审计",
        ],
        "labs": [
            "配置安全组与存储策略并验证",
            "提交配置与验证截图",
        ],
        "reinforce": [
            "题目：常见误开放导致什么问题？",
            "练习：设计配置管理流程",
        ],
        "criteria": [
            "策略生效、审计可见",
            "提交验证证据",
        ],
    },
    {
        "day": 66,
        "module": "云与容器安全",
        "topic": "容器与镜像安全、最小镜像",
        "objectives": [
            "理解镜像安全与供应链风险",
            "掌握最小镜像原则",
        ],
        "content": [
            "镜像来源与签名、漏洞扫描",
            "运行时权限与隔离",
        ],
        "labs": [
            "对示例镜像进行扫描并记录风险",
            "制作最小镜像并验证运行",
        ],
        "reinforce": [
            "题目：为何避免特权容器？",
            "练习：列出镜像安全清单",
        ],
        "criteria": [
            "扫描与修复建议提交",
            "最小镜像运行正常",
        ],
    },
    {
        "day": 67,
        "module": "云与容器安全",
        "topic": "K8s 入门：RBAC 与网络策略",
        "objectives": [
            "理解 RBAC 与网络策略作用",
            "能配置基础策略并验证",
        ],
        "content": [
            "角色/绑定与权限粒度",
            "NetworkPolicy 的选择与限制",
        ],
        "labs": [
            "在本地 K8s（如 kind/minikube）配置 RBAC 与网络策略",
            "验证跨 Pod 通信的限制",
        ],
        "reinforce": [
            "题目：如何设计最小权限的 RBAC？",
            "练习：编写 NetworkPolicy 示例",
        ],
        "criteria": [
            "策略生效与验证截图",
            "说明安全收益",
        ],
    },
    {
        "day": 68,
        "module": "云与容器安全",
        "topic": "云审计与告警、合规参考",
        "objectives": [
            "能在云环境中进行审计与告警配置",
            "理解合规参考的作用",
        ],
        "content": [
            "审计日志、告警规则与通知",
            "合规框架参考（理论）",
        ],
        "labs": [
            "配置审计与告警并触发验证",
            "记录事件与处置流程",
        ],
        "reinforce": [
            "题目：云审计的关键字段？",
            "练习：设计告警分级",
        ],
        "criteria": [
            "审计与告警可用",
            "提交验证证据",
        ],
    },
    {
        "day": 69,
        "module": "云与容器安全",
        "topic": "攻防边界与最佳实践",
        "objectives": [
            "总结云与容器的攻防边界",
            "形成最佳实践清单",
        ],
        "content": [
            "身份、网络、存储、镜像与运行时",
            "日志与告警联动",
        ],
        "labs": [
            "编写最佳实践清单并在测试环境验证部分",
            "提交验证与截图",
        ],
        "reinforce": [
            "题目：哪个环节最容易忽视？",
            "练习：完善清单",
        ],
        "criteria": [
            "清单明确、验证有效",
            "说明边界限制",
        ],
    },
    {
        "day": 70,
        "module": "云与容器安全",
        "topic": "周综合实验与测评（云/容器）",
        "objectives": [
            "完成云与容器的综合演练",
            "形成周报与改进计划",
        ],
        "content": [
            "汇总策略、日志与验证",
            "评估收益与不足",
        ],
        "labs": [
            "选择一个主题完成综合演练并提交证据",
            "输出周报与计划",
        ],
        "reinforce": [
            "题目：最重要的控制项是什么？",
            "练习：完善策略文档",
        ],
        "criteria": [
            "周报完整、证据充分",
            "提出优化计划",
        ],
    },

    # Week 11：事件响应与取证基础（Day071 ~ Day077）
    {
        "day": 71,
        "module": "事件响应与取证",
        "topic": "响应流程与分级、准备与演练",
        "objectives": [
            "理解响应流程与分级",
            "掌握演练的准备要点",
        ],
        "content": [
            "响应角色与职责",
            "演练计划与检查清单",
        ],
        "labs": [
            "编写一次响应演练计划与检查清单",
            "演练并记录问题",
        ],
        "reinforce": [
            "题目：分级的意义是什么？",
            "练习：完善演练计划",
        ],
        "criteria": [
            "计划与演练记录完整",
            "问题与改进项明确",
        ],
    },
    {
        "day": 72,
        "module": "事件响应与取证",
        "topic": "主机取证基础：镜像与时间线",
        "objectives": [
            "理解主机取证的基本方法",
            "能构建时间线与证据",
        ],
        "content": [
            "镜像与哈希校验（理论与合规）",
            "时间线构建与关键工件",
        ],
        "labs": [
            "对测试主机进行样例取证（合法范围内）",
            "构建时间线并提交证据",
        ],
        "reinforce": [
            "题目：如何保证证据完整性？",
            "练习：设计时间线字段",
        ],
        "criteria": [
            "时间线清晰、证据规范",
            "说明完整性保证方法",
        ],
    },
    {
        "day": 73,
        "module": "事件响应与取证",
        "topic": "网络取证基础：流量与会话",
        "objectives": [
            "理解网络取证的方法",
            "能复原会话并分析",
        ],
        "content": [
            "流量捕获与会话复原",
            "关键字段与时间线",
        ],
        "labs": [
            "捕获样例流量并复原会话",
            "提交分析与结论",
        ],
        "reinforce": [
            "题目：哪些字段最关键？",
            "练习：完善取证报告模板",
        ],
        "criteria": [
            "会话复原正确、分析合理",
            "报告模板完善",
        ],
    },
    {
        "day": 74,
        "module": "事件响应与取证",
        "topic": "日志与告警的证据化",
        "objectives": [
            "将日志与告警转化为证据",
            "保证可审查与复现",
        ],
        "content": [
            "日志字段与证据关联",
            "截图与输出保存规范",
        ],
        "labs": [
            "对告警事件收集日志证据并关联",
            "提交证据清单与结论",
        ],
        "reinforce": [
            "题目：证据保全的要点是什么？",
            "练习：完善证据清单模板",
        ],
        "criteria": [
            "证据清单完整、关联明确",
            "结论可复审",
        ],
    },
    {
        "day": 75,
        "module": "事件响应与取证",
        "topic": "初步分析与报告结构",
        "objectives": [
            "能进行初步分析并撰写报告",
            "形成可执行建议",
        ],
        "content": [
            "分析步骤与结构化报告",
            "建议与处置清单",
        ],
        "labs": [
            "撰写一个示例响应报告并提交",
            "形成建议与处置清单",
        ],
        "reinforce": [
            "题目：如何提高建议的可执行性？",
            "练习：优化报告结构",
        ],
        "criteria": [
            "报告结构清晰、建议可执行",
            "证据完整",
        ],
    },
    {
        "day": 76,
        "module": "事件响应与取证",
        "topic": "演练与复盘、改进清单",
        "objectives": [
            "完成一次响应演练并复盘",
            "形成改进清单",
        ],
        "content": [
            "演练流程与问题记录",
            "改进项与计划",
        ],
        "labs": [
            "完成演练并提交复盘文档",
            "整理改进清单与时间表",
        ],
        "reinforce": [
            "题目：演练中最关键的环节？",
            "练习：制定下一次演练计划",
        ],
        "criteria": [
            "复盘清晰、改进可执行",
            "文档完整",
        ],
    },
    {
        "day": 77,
        "module": "事件响应与取证",
        "topic": "周综合实验与测评（响应/取证）",
        "objectives": [
            "完成响应与取证的综合演练",
            "形成周报与模板库",
        ],
        "content": [
            "汇总时间线、证据与报告",
            "完善模板与流程",
        ],
        "labs": [
            "选择一个主题完成综合演练并提交证据",
            "输出周报与模板",
        ],
        "reinforce": [
            "题目：最难完善的证据项？",
            "练习：改进模板",
        ],
        "criteria": [
            "周报完整、证据充分",
            "模板可复用",
        ],
    },

    # Week 12：综合实战与作品集（Day078 ~ Day084）
    {
        "day": 78,
        "module": "综合实战",
        "topic": "选题与范围界定、目标与度量",
        "objectives": [
            "选择合法授权的实战主题",
            "明确目标与度量指标",
        ],
        "content": [
            "选题原则与边界声明",
            "目标与度量设计",
        ],
        "labs": [
            "制定选题与度量文档并提交",
            "准备证据记录方案",
        ],
        "reinforce": [
            "题目：如何定义可衡量的目标？",
            "练习：完善度量指标",
        ],
        "criteria": [
            "选题合法、目标明确",
            "度量可执行",
        ],
    },
    {
        "day": 79,
        "module": "综合实战",
        "topic": "执行与记录：过程证据链",
        "objectives": [
            "按计划执行并记录证据",
            "保证链条完整",
        ],
        "content": [
            "过程记录模板与截图规范",
            "日志与输出保存",
        ],
        "labs": [
            "执行实战并提交过程证据",
            "记录问题与调整",
        ],
        "reinforce": [
            "题目：证据链的关键节点？",
            "练习：完善记录模板",
        ],
        "criteria": [
            "证据充分、记录完整",
            "调整说明清晰",
        ],
    },
    {
        "day": 80,
        "module": "综合实战",
        "topic": "报告撰写与复现核验",
        "objectives": [
            "撰写完整报告",
            "进行复现核验",
        ],
        "content": [
            "报告结构与复现说明",
            "结论与建议",
        ],
        "labs": [
            "提交报告与复现步骤",
            "核验并记录结果",
        ],
        "reinforce": [
            "题目：如何提高报告可读性？",
            "练习：完善复现说明",
        ],
        "criteria": [
            "报告完整、复现通过",
            "结论清晰",
        ],
    },
    {
        "day": 81,
        "module": "综合实战",
        "topic": "加固建议与改进整理",
        "objectives": [
            "形成加固建议",
            "整理改进项",
        ],
        "content": [
            "建议的优先级与可执行性",
            "改进计划与负责人（理论）",
        ],
        "labs": [
            "输出加固建议与改进清单",
            "提交优先级与时间表",
        ],
        "reinforce": [
            "题目：如何排序优先级？",
            "练习：制定时间表",
        ],
        "criteria": [
            "建议可执行、优先级明确",
            "计划清晰",
        ],
    },
    {
        "day": 82,
        "module": "综合实战",
        "topic": "作品集组装与展示准备",
        "objectives": [
            "整理作品集材料",
            "准备展示与讲解",
        ],
        "content": [
            "作品集结构与要素",
            "讲解提纲与演示素材",
        ],
        "labs": [
            "组装作品集并准备展示",
            "提交提纲与素材",
        ],
        "reinforce": [
            "题目：如何突出关键成果？",
            "练习：优化展示结构",
        ],
        "criteria": [
            "作品集完整、展示有序",
            "提纲清晰",
        ],
    },
    {
        "day": 83,
        "module": "综合实战",
        "topic": "演示彩排与反馈收集",
        "objectives": [
            "完成演示彩排",
            "收集反馈并优化",
        ],
        "content": [
            "彩排流程与时间控制",
            "反馈整理与改进",
        ],
        "labs": [
            "完成彩排并记录反馈",
            "优化作品集与讲解",
        ],
        "reinforce": [
            "题目：如何处理时间控制？",
            "练习：完善讲解稿",
        ],
        "criteria": [
            "彩排完成、改进到位",
            "材料更新",
        ],
    },
    {
        "day": 84,
        "module": "综合实战",
        "topic": "周综合评审：作品集与展示",
        "objectives": [
            "完成作品集评审",
            "定稿展示材料",
        ],
        "content": [
            "评审要点与调整",
            "定稿与提交",
        ],
        "labs": [
            "进行评审并提交定稿",
            "记录改动与建议",
        ],
        "reinforce": [
            "题目：评审中最重要的指标？",
            "练习：完善材料",
        ],
        "criteria": [
            "评审通过、材料定稿",
            "记录完整",
        ],
    },

    # Week 13：查缺补漏与冲刺（Day085 ~ Day090）
    {
        "day": 85,
        "module": "冲刺复盘",
        "topic": "网络与协议复盘、题库巩固",
        "objectives": [
            "复盘网络与协议",
            "完成题库巩固",
        ],
        "content": [
            "关键协议与抓包要点回顾",
            "题库与错题本",
        ],
        "labs": [
            "完成一套题库并记录错题",
            "复现抓包与分析示例",
        ],
        "reinforce": [
            "题目：本模块最易错点？",
            "练习：完善错题本",
        ],
        "criteria": [
            "题库完成、错题记录",
            "抓包复现",
        ],
    },
    {
        "day": 86,
        "module": "冲刺复盘",
        "topic": "Web 与漏洞复盘、题库巩固",
        "objectives": [
            "复盘 Web 安全要点",
            "完成题库巩固",
        ],
        "content": [
            "Top 10 与防护策略",
            "演示与修复要点",
        ],
        "labs": [
            "完成一套题库并记录错题",
            "复现演示与修复样例",
        ],
        "reinforce": [
            "题目：哪个风险最常见？",
            "练习：完善防护清单",
        ],
        "criteria": [
            "题库完成、修复复现",
            "清单完善",
        ],
    },
    {
        "day": 87,
        "module": "冲刺复盘",
        "topic": "日志/防护/响应复盘、题库巩固",
        "objectives": [
            "复盘日志链路与防护策略",
            "完成响应题库",
        ],
        "content": [
            "采集到告警闭环",
            "防护策略与响应流程",
        ],
        "labs": [
            "完成题库并记录错题",
            "演练一次告警触发到处置",
        ],
        "reinforce": [
            "题目：哪条链路最脆弱？",
            "练习：优化处置流程",
        ],
        "criteria": [
            "题库完成、演练通过",
            "流程优化记录",
        ],
    },
    {
        "day": 88,
        "module": "冲刺复盘",
        "topic": "综合场景模拟演练",
        "objectives": [
            "在限定时间内完成综合演练",
            "形成计时与证据记录",
        ],
        "content": [
            "综合演练目标与步骤",
            "计时与评估",
        ],
        "labs": [
            "完成演练并记录时间与证据",
            "提交评估与改进建议",
        ],
        "reinforce": [
            "题目：时间压力下的取舍？",
            "练习：优化策略",
        ],
        "criteria": [
            "演练完成、证据充分",
            "改进建议明确",
        ],
    },
    {
        "day": 89,
        "module": "冲刺复盘",
        "topic": "最终报告与作品集完善",
        "objectives": [
            "完成最终报告与作品集",
            "准备提交与展示",
        ],
        "content": [
            "报告定稿与作品集完善",
            "提交说明与演示准备",
        ],
        "labs": [
            "定稿报告与作品集并提交",
            "准备展示材料",
        ],
        "reinforce": [
            "题目：如何突出关键成果？",
            "练习：优化演示稿",
        ],
        "criteria": [
            "报告与作品集定稿",
            "展示准备完成",
        ],
    },
    {
        "day": 90,
        "module": "冲刺复盘",
        "topic": "总测评与未来计划",
        "objectives": [
            "完成总测评",
            "制定后续认证与专项计划",
        ],
        "content": [
            "测评与反馈",
            "未来学习路径与认证目标（如：Security+、CEH 等理论）",
        ],
        "labs": [
            "完成一次综合测评并提交结果",
            "制定未来计划与时间表",
        ],
        "reinforce": [
            "题目：下一阶段的重点是什么？",
            "练习：拆解目标与里程碑",
        ],
        "criteria": [
            "测评完成、计划明确",
            "记录与证据齐备",
        ],
    },
]

# 已补充 Day01~Day90 的详细条目，生成的每日卡片均为“详细版本”。

TOTAL_DAYS = 90

TEMPLATE_FILLER = {
    "objectives": [
        "完善本日详细学习目标（请参考路线图模块主题）",
    ],
    "content": [
        "补充本日具体学习内容（阅读/视频/标准文档）",
    ],
    "labs": [
        "设计并完成至少 1 项合法授权范围内的动手实践",
    ],
    "reinforce": [
        "编写 3-5 道巩固题或复盘要点",
    ],
    "criteria": [
        "定义可度量的达成判定（如截图、日志、报告摘要）",
    ],
}

HEADER = '''---
title: Day{day:03d}：{module} - {topic}
tags:
  - 网络
  - 安全
  - 学习计划
categories:
  - 网络安全
abbrlink: {abbrlink:05x}
date: {date}
updated: {date}
---

# Day{day:03d}：{module} - {topic}

- **日期**：{date}
- **周次**：第 {week} 周
- **模块**：{module}
- **主题**：{topic}
- **预计学习时间**：___ 小时

---

## 🎯 学习目标

学完今天你应该能做到：

{objectives}

<!--more-->

## 📚 完整学习内容（必读）

本节包含今天需要学习的全部知识点，请认真阅读并理解。

### 一、概念理解

{content_basics}

### 二、原理讲解

{content_principle}

### 三、技术细节

{content_tech}

### 四、进阶知识（选学）

如果你学有余力，可以深入了解以下内容：

{content_advanced}

### 五、本日知识点速查表

| 序号 | 核心概念 | 关键点 | 备注 |
|------|----------|--------|------|
| 1 | | | |
| 2 | | | |
| 3 | | | |
| 4 | | | |
| 5 | | | |

---

## 🗺️ 知识图谱

### 今日内容在整体知识体系中的位置

```
网络安全学习路径
├── 第 {week} 周：{module}
│   └── Day{day:03d}：{topic}
│       ├── 核心概念
│       ├── 实践技能
│       └── 关联知识点
└── 后续衔接
    └── Day{next_day:03d}：___
```

### 今日关键词

`{topic}` · `{keyword}`

---

## 🔧 实践任务（合法授权范围内）

> ⚠️ **安全提示**：所有任务必须在合法授权的实验环境中进行，禁止对未授权目标进行任何测试。

请按顺序完成以下任务：

### 任务 1：环境准备（5 分钟）

{labs_1}

**操作步骤**：
1. 打开终端/命令行
2. 输入命令：___
3. 观察输出结果
4. 截图保存

### 任务 2：核心实验（30 分钟）

{labs_2}

**操作步骤**：
1. 第一步：___
2. 第二步：___
3. 第三步：___
4. 第四步：___
5. 第五步：___

**预期结果**：
- 结果 1：___
- 结果 2：___

### 任务 3：进阶挑战（选做，15 分钟）

{labs_3}

**提示**：
- 提示 1：___
- 提示 2：___

---

## 📝 巩固练习（题目与复盘）

完成以下练习来检验你的学习效果。

### 练习 1：概念理解（5 分钟）

{reinforce_1}

**参考答案**（完成后对照）：
___
___

### 练习 2：实操应用（10 分钟）

{reinforce_2}

**参考答案**（完成后对照）：
___
___

### 练习 3：深度思考（10 分钟）

{reinforce_3}

**参考答案**（完成后对照）：
___
___

---

## ✅ 评估标准（达成判定）

请对照以下标准检查你的学习成果：

{criteria}

### 自检清单

完成学习后，请检查以下项目：

- [ ] **概念理解**：能用自己的话解释今天学到的核心概念
- [ ] **实际应用**：能给出实际应用场景的例子
- [ ] **动手能力**：能独立完成实践任务不需要提示
- [ ] **时间管理**：能在有限时间内完成今日学习内容
- [ ] **知识迁移**：能将在本文学到的知识应用到其他场景

### 学习进度自评

| 评估项目 | 1-5 星 | 备注 |
|----------|--------|------|
| 概念理解 | ⭐⭐⭐⭐⭐ | |
| 动手能力 | ⭐⭐⭐⭐⭐ | |
| 时间控制 | ⭐⭐⭐⭐⭐ | |
| 学习兴趣 | ⭐⭐⭐⭐⭐ | |

---

## 📊 学习成果记录（由学习者填写）

### 学习信息

| 项目 | 内容 |
|------|------|
| 学习日期 | {date} |
| 学习时长 | ___ 小时 |
| 完成情况 | ⬜ 已完成 / ⬜ 部分完成 / ⬜ 未完成 |

### 实践任务完成记录

| 任务 | 完成状态 | 关键证据/截图 | 用时 |
|------|----------|---------------|------|
| 任务 1 | ⬜ 已完成 / ⬜ 部分 / ⬜ 未做 | | ___ 分钟 |
| 任务 2 | ⬜ 已完成 / ⬜ 部分 / ⬜ 未做 | | ___ 分钟 |
| 任务 3 | ⬜ 已完成 / ⬜ 部分 / ⬜ 未做 | | ___ 分钟 |

### 命令/代码记录

```bash
# 记录你今天使用的命令
___
___

# 记录重要的输出结果
___
```

### 今日总结与反思

**今日收获**（用 3-5 句话总结今天学到了什么）：

_

**遇到的问题与解决**：

_

**明日待深化的问题**：

_

---

## 💡 知识卡片速查

### 核心概念速记

| 概念 | 定义 | 举例 |
|------|------|------|
| | | |
| | | |
| | | |

### 常用命令速查

| 场景 | 命令 | 说明 |
|------|------|------|
| | | |
| | | |
| | | |

### 常见错误与解决

| 错误现象 | 可能原因 | 解决方法 |
|----------|----------|----------|
| | | |
| | | |

---

## ❓ 常见问题与解答

**Q1：___？**

A1：___

**Q2：___？**

A2：___

**Q3：___？**

A3：___

---

## 🚀 下一步学习预告

**明日主题预告**：Day{next_day:03d} - ___

**学习重点预告**：
- ___
- ___
- ___

**今日学习为明日做铺垫**：
- 理解了 ___，明天将学习 ___
- 掌握了 ___，明天将应用 ___

---

## 📖 参考资料

- 📖 官方文档：___
- 🎥 视频教程：___
- 🛠️ 实践靶场：___
- 📚 参考书籍：___
- 🔗 相关链接：___

---

> 💬 **学习提示**：
> 1. 建议按照文档顺序学习，不要跳跃
> 2. 每个知识点理解后再进行下一步
> 3. 实践任务一定要亲手做，不要只看
> 4. 遇到问题先思考，再查阅资料，最后再问
> 5. 坚持每天完成学习任务并记录成果，90 天后你会感谢现在的自己！
>
> ```bash
> git add daily/Day{day:03d}.md
> git commit -m "Day{day:03d}: 完成学习与记录"
> ```

'''


def bullets(items):
    return "\n".join([f"- {i}" for i in items]) if items else "- （待填写）"


def week_number(day):
    # 7 天为一周，向上取整
    return (day - 1) // 7 + 1


def ensure_dir(path):
    if not os.path.exists(path):
        os.makedirs(path)


def build_entry(day):
    # 尝试从 CURRICULUM 获取详细条目；否则生成模板
    entry = next((c for c in CURRICULUM if c["day"] == day), None)
    if entry:
        return {
            "module": entry["module"],
            "topic": entry["topic"],
            "objectives": bullets(entry.get("objectives", [])),
            "content_basics": entry.get("content_basics", "（待完善）"),
            "content_principle": entry.get("content_principle", "（待完善）"),
            "content_tech": entry.get("content_tech", "（待完善）"),
            "content_advanced": entry.get("content_advanced", "（待完善）"),
            "labs_1": entry.get("labs_1", "（待完善）"),
            "labs_2": entry.get("labs_2", "（待完善）"),
            "labs_3": entry.get("labs_3", "（待完善）"),
            "reinforce": entry.get("reinforce", []),
            "criteria": bullets(entry.get("criteria", [])),
        }
    else:
        return {
            "module": "（按路线图填充模块）",
            "topic": "（补充具体主题）",
            "objectives": bullets(TEMPLATE_FILLER["objectives"]),
            "content_basics": "（待完善）",
            "content_principle": "（待完善）",
            "content_tech": "（待完善）",
            "content_advanced": "（待完善）",
            "labs_1": "（待完善）",
            "labs_2": "（待完善）",
            "labs_3": "（待完善）",
            "reinforce": TEMPLATE_FILLER["reinforce"],
            "criteria": bullets(TEMPLATE_FILLER["criteria"]),
        }


def main():
    parser = argparse.ArgumentParser(description="生成每日学习 Markdown 卡片")
    parser.add_argument("-s", "--start", dest="start", default=datetime.date.today().isoformat(), help="开始日期（YYYY-MM-DD）")
    parser.add_argument("-o", "--output", dest="output", default=os.path.join(os.path.dirname(__file__), "..", "daily"), help="输出目录")
    args = parser.parse_args()

    start_date = datetime.date.fromisoformat(args.start)
    out_dir = os.path.abspath(args.output)
    ensure_dir(out_dir)

    # 关键词列表（按主题循环）
    keywords = ["网络", "协议", "安全", "加密", "操作系统", "脚本", "漏洞", "日志", "Web", "防护", "渗透", "内网", "云", "容器", "响应", "取证", "实战"]

    for day in range(1, TOTAL_DAYS + 1):
        date = start_date + datetime.timedelta(days=day - 1)
        week = week_number(day)
        next_day = day + 1
        entry = build_entry(day)
        
        # 解析强化练习内容
        reinforce_list = entry.get("reinforce", [])
        reinforce_1 = reinforce_list[0] if len(reinforce_list) > 0 else "（待完善）"
        reinforce_2 = reinforce_list[1] if len(reinforce_list) > 1 else "（待完善）"
        reinforce_3 = reinforce_list[2] if len(reinforce_list) > 2 else "（待完善）"

        content = HEADER.format(
            day=day,
            module=entry["module"],
            topic=entry["topic"],
            date=date.isoformat(),
            week=week,
            next_day=next_day,
            objectives=entry["objectives"],
            content_basics=entry["content_basics"],
            content_principle=entry["content_principle"],
            content_tech=entry["content_tech"],
            content_advanced=entry["content_advanced"],
            labs_1=entry["labs_1"],
            labs_2=entry["labs_2"],
            labs_3=entry["labs_3"],
            reinforce_1=reinforce_1,
            reinforce_2=reinforce_2,
            reinforce_3=reinforce_3,
            criteria=entry["criteria"],
            abbrlink=hash(f"Day{day:03d}{entry['module']}{entry['topic']}") & 0xFFFFF,
            keyword=keywords[(day - 1) % len(keywords)],
        )
        fname = os.path.join(out_dir, f"Day{day:03d}.md")
        with open(fname, "w", encoding="utf-8") as f:
            f.write(dedent(content))

    print(f"已生成 {TOTAL_DAYS} 天的详细学习卡片到: {out_dir}")


if __name__ == "__main__":
    main()
