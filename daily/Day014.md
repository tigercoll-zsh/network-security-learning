---
title: Day014：安全协议与加密 - 周综合实验与测评
tags:
  - 网络
  - 安全
  - 学习计划
categories:
  - 网络安全
abbrlink: 1e85f
date: 2026-02-05
updated: 2026-02-05
---

# Day014：安全协议与加密 - 周综合实验与测评

- **日期**：2026-02-05
- **周次**：第 2 周
- **模块**：安全协议与加密
- **主题**：周综合实验与测评
- **预计学习时间**：2.5 小时

---

## 🎯 学习目标

学完今天你应该能做到：

- 综合运用本周所学（TLS, SSH, 证书, 加密算法）
- 分析一个不安全的网络架构并提出加固方案
- **具备识别系统级安全漏洞（如弱加密、未授权访问）的能力**
- **制定基础的安全加固策略（Hardening）**
- 完成第二周的自我评估与复盘

<!--more-->

## 📚 完整学习内容（必读）

本节包含今天需要学习的全部知识点，请认真阅读并理解。

### 一、本周知识大串讲

我们在这一周里，给裸奔的网络数据穿上了铠甲：

1.  **Day 008 (TLS 握手)**：理解了 HTTPS 是如何通过协商建立安全通道的（ClientHello -> ServerHello）。
2.  **Day 009 (证书)**：理解了“身份证”体系，根证书如何通过信任链验证服务器身份。
3.  **Day 010 (HTTPS 实战)**：通过抓包看到了加密后的乱码，学习了 HSTS 防止降级攻击。
4.  **Day 011 (SSH)**：学习了服务器管理的加密通道，掌握了密钥免密登录。
5.  **Day 012 (加密基础)**：区分了哈希（不可逆）、对称（快）、非对称（安全交换）算法。
6.  **Day 013 (应用场景)**：避开了 Base64 误区，学会了用 Bcrypt 存密码。

### 二、综合场景分析

#### 场景描述
你入职了一家初创公司，发现他们的 Web 架构存在以下严重问题：
1.  **传输层**：用户登录页面是 HTTP 的，没有任何加密。
2.  **数据层**：数据库里用户密码是明文存储的，且数据库端口对外网开放。
3.  **管理层**：管理员远程管理服务器用的是 Telnet，或者 SSH 用的是默认端口且允许 `root` 使用弱密码 `123456` 登录。
4.  **应用层**：开发人员把 AES 密钥写死在了前端 JS 代码里，用于“加密”敏感数据。

#### 加固方案（你的任务）
请针对以上问题，提出具体的整改措施：

1.  **针对 HTTP (传输层)**：
    -   申请并部署 SSL 证书（如 Let's Encrypt），开启全站 HTTPS。
    -   配置 Web 服务器（Nginx/Apache）强制跳转 HTTPS。
    -   开启 **HSTS**，防止 SSL 剥离攻击。
2.  **针对密码存储 (数据层)**：
    -   **立即清洗数据**：通知用户重置密码。
    -   **加固存储**：改用 **Bcrypt** 或 **Argon2** 慢哈希算法存储密码，并为每个用户生成独立的随机 **Salt**。
    -   **网络隔离**：数据库端口不应通过公网访问，应仅允许内网应用服务器连接，或通过 SSH 隧道/VPN 访问。
3.  **针对远程管理 (管理层)**：
    -   **淘汰 Telnet**：全面使用 SSH。
    -   **SSH 加固**：
        -   禁用密码登录 (`PasswordAuthentication no`)，强制使用密钥认证。
        -   禁用 root 直登 (`PermitRootLogin no`)。
        -   修改默认端口（可选，防扫描）。
        -   配置防火墙（如 `iptables` 或云安全组），只允许特定 IP 访问管理端口。
4.  **针对密钥硬编码 (应用层)**：
    -   **前端无秘密**：前端代码对用户是透明的，任何写在前端的密钥都等于公开。
    -   **架构调整**：将加密逻辑移至后端服务器。
    -   **密钥管理**：后端密钥应保存在环境变量或专业的 **KMS** 中，严禁提交到代码仓库（Git）。

### 三、实战演练：模拟 SSL 中间人攻击与防御验证

*注意：本实验仅在本地环境进行原理验证，严禁用于真实网络。*

#### 目标
理解 HTTPS 是如何被中间人拦截的，以及为什么“伪造根证书”是攻击的关键。

#### 步骤简述
1.  **工具准备**：安装 `Fiddler Classic` 或 `mitmproxy`。
2.  **攻击模拟**（安装伪造证书）：
    -   工具会生成一个“FiddlerRoot”证书。
    -   你需要手动把它安装到操作系统的“受信任的根证书颁发机构”里。（**这一步模拟了黑客诱导用户安装恶意证书，或者企业强制安装监控证书的场景**）。
3.  **抓包验证**：
    -   开启 Fiddler 的 HTTPS 解密功能。
    -   浏览器访问 HTTPS 网站（如 `https://www.baidu.com`）。
4.  **观察结果**：
    -   浏览器地址栏的小锁依然存在（因为系统信任了 Fiddler 的伪造根证书）。
    -   但在 Fiddler 里，你可以清晰地看到原本应该是乱码的 HTTPS 请求和响应内容（明文）。
5.  **防御思考**：
    -   如果用户没有安装这个伪造证书，浏览器会怎么反应？（会报“证书无效”，拦截连接）。
    -   这就是为什么**保护好系统信任的根证书库**如此重要。
6.  **清理**：实验结束后，务必**删除**该伪造根证书，否则不仅不安全，还可能导致网络问题。

### 四、进阶知识（选学）

#### 零信任架构 (Zero Trust)
- 传统安全是“城堡-护城河”模式（内网是安全的，外网是危险的）。
- 零信任是“永不信任，始终验证”。
- 即使你在内网，访问数据库也要经过严格的 mTLS（双向认证）和动态授权。

### 五、本日知识点速查表

| 序号 | 核心概念 | 关键点 | 备注 |
|------|----------|--------|------|
| 1 | 纵深防御 | 多层保护 | 没有银弹 |
| 2 | 最小权限 | 够用就行 | 限制 root |
| 3 | 信任锚点 | 根证书 | 安全的基石 |

---

## 🗺️ 知识图谱

### 今日内容在整体知识体系中的位置

```
网络安全学习路径
├── 第 1 周：网络与协议基础
└── 第 2 周：安全协议与加密 (已完成)
    ├── TLS/SSL
    ├── PKI 体系
    ├── SSH
    └── 加密算法应用
    └── **安全加固 (Hardening)**
```

### 今日关键词

`Review` · `Hardening` · `Zero Trust` · **`Security Audit`** · **`Best Practices`**

---

## 🔧 实践任务（合法授权范围内）

> ⚠️ **安全提示**：所有任务必须在合法授权的实验环境中进行，禁止对未授权目标进行任何测试。

请按顺序完成以下任务：

### 任务 1：复盘检查（15 分钟）

检查自己的学习环境，清理之前的实验残留。
1.  删除测试用的 SSH 密钥（如果不需要了）。
2.  检查是否遗留了 SSLKEYLOGFILE 环境变量（建议删除，以免长期暴露密钥）。
3.  整理本周的学习笔记。

### 任务 2：核心实验（30 分钟）

编写一份简单的 **Checklist**（检查清单），用于检查 Linux 服务器的基础安全性。
*格式示例*：
- [ ] SSH 端口是否修改？
- [ ] 是否禁用了密码登录？
- [ ] 防火墙 (ufw/iptables) 是否只开了必要端口？
- [ ] 系统和软件是否更新到最新？

### 任务 3：进阶挑战（选做，15 分钟）

尝试使用 `nmap` 扫描本机或授权测试机开放的端口和加密算法强度。
`nmap --script ssl-enum-ciphers -p 443 <target>`
*观察能否扫出支持的 TLS 版本和密码套件评级 (A/B/C/F)*。

---

## 📝 巩固练习（题目与复盘）

完成以下练习来检验你的学习效果。

### 练习 1：概念理解（5 分钟）

题目：如果你发现一台服务器的 SSH 端口对外开放且允许密码爆破，你会怎么做？

**参考答案**（完成后对照）：
1.  **短期止血**：配置防火墙只允许特定 IP 访问 22 端口，或安装 Fail2Ban 自动封禁恶意 IP。
2.  **长期加固**：配置 SSH 密钥认证，禁用密码登录，修改默认端口。

### 练习 2：实操应用（10 分钟）

练习：本周学习中，哪种加密算法最适合用于生成“数字指纹”？

**参考答案**（完成后对照）：
**哈希算法**（如 SHA-256）。因为它具有“输入微小变化导致输出巨大变化”（雪崩效应）和“不可逆”的特性，非常适合用于校验文件完整性和生成指纹。

### 练习 3：深度思考（10 分钟）

为什么说“人是安全系统中最薄弱的环节”？

**参考答案**（完成后对照）：
即使加密算法再完美（AES/RSA 目前无法暴力破解），如果管理员把密码写在便利贴上贴在屏幕旁，或者中了钓鱼邮件泄露了私钥，整个加密体系瞬间瓦解。技术可以解决数学问题，但解决不了社会工程学问题。

---

## ✅ 评估标准（达成判定）

请对照以下标准检查你的学习成果：

- [x] 能流畅说出 HTTPS 和 SSH 的工作原理
- [x] 能独立完成服务器 SSH 的安全加固
- [x] 知道如何避开常见的加密误区（Base64, 弱口令）
- [x] **能识别并解释常见的网络架构安全漏洞**
- [x] **理解中间人攻击的实施条件和防御手段**

### 自检清单

完成学习后，请检查以下项目：

- [ ] **概念理解**：第二周的知识点是否形成了闭环？（加密->证书->HTTPS->应用）
- [ ] **实际应用**：是否有信心对简单的 Web 服务进行安全检查？
- [ ] **动手能力**：工具（Wireshark, OpenSSL, SSH, Nmap）是否用顺手了？
- [ ] **安全意识**：是否养成了“默认不信任”和“纵深防御”的思维习惯？
- [ ] **时间管理**：是否跟上了学习进度？

### 学习进度自评

| 评估项目 | 1-5 星 | 备注 |
|----------|--------|------|
| 概念理解 | ⭐⭐⭐⭐⭐ | 加密世界很深奥，但**原理搞懂了吗？** |
| 动手能力 | ⭐⭐⭐⭐⭐ | 甚至想去考个证。**实操遇到困难了吗？** |
| 学习兴趣 | ⭐⭐⭐⭐⭐ | 期待下周的 Linux 实战。**准备好面对命令行了吗？** |

---

## 📊 学习成果记录（由学习者填写）

### 学习信息

| 项目 | 内容 |
|------|------|
| 学习日期 | 2026-02-05 |
| 学习时长 | ___ 小时 |
| 完成情况 | ⬜ 已完成 / ⬜ 部分完成 / ⬜ 未完成 |

### 实践任务完成记录

| 任务 | 完成状态 | 关键证据/截图 | 用时 |
|------|----------|---------------|------|
| 任务 1 | ⬜ 已完成 / ⬜ 部分 / ⬜ 未做 | 记录：清理完成 | ___ 分钟 |
| 任务 2 | ⬜ 已完成 / ⬜ 部分 / ⬜ 未做 | 记录：Checklist | ___ 分钟 |
| 任务 3 | ⬜ 已完成 / ⬜ 部分 / ⬜ 未做 | 截图：Nmap 结果 | ___ 分钟 |

### 命令/代码记录

```bash
# 记录你今天使用的命令
nmap --script ssl-enum-ciphers ...
```

### 今日总结与反思

**今日收获**（用 3-5 句话总结今天学到了什么）：

_例如：本周的学习让我对网络传输安全有了全新的认识。以前只知道它是黑盒子，现在能看到里面的握手、证书、加密细节。虽然数学原理很难，但工程应用（配置、工具）已经掌握了基本套路。_

**遇到的问题与解决**：

_例如：对于非对称加密的数学原理（大数分解、椭圆曲线）还是有点懵，不过不影响我会用 OpenSSL 生成密钥。_

**明日待深化的问题**：

_例如：下周要开始 Linux 系统安全了，我要先把常用的 Linux 命令（ls, cd, grep, chmod）再复习一遍。_

---

## 💡 知识卡片速查

### 核心概念速记

| 概念 | 定义 | 举例 |
|------|------|------|
| **纵深防御** | 层层设卡 | 就像剥洋葱 |
| **Fail2Ban** | 防爆破工具 | 输错3次封IP |
| **Checklist** | 检查清单 | 飞行员起飞前必做 |

### 常用命令速查

| 场景 | 命令 | 说明 |
|------|------|------|
| 扫描 SSL | `nmap --script ssl-enum-ciphers` | 检查 SSL 安全性 |
| SSH 加固 | `vi /etc/ssh/sshd_config` | 修改配置 |

---

## 🚀 下一步学习预告

**明日主题预告**：Day015 - Linux 系统安全：用户与权限管理（第三周开始）

**学习重点预告**：
- Linux 的用户 (User) 和组 (Group)
- 著名的 `rwx` 权限位 (777, 755)
- SUID/SGID 提权风险

**今日学习为明日做铺垫**：
- 本周的 SSH 实验其实已经用到了 Linux 命令行，下周我们将深入操作系统内部，从“网络黑客”变身“系统黑客”。

---

## 📖 参考资料

- 📖 官方文档：[Linux Security Hardening Guide](https://www.cyberciti.biz/tips/linux-security.html)
- 🎥 视频教程：B站搜索 "Linux 安全加固"
- 🛠️ 实践工具：Nmap, Fail2Ban

---

> 💬 **学习提示**：
> 1. 建议按照文档顺序学习，不要跳跃
> 2. 每个知识点理解后再进行下一步
> 3. 实践任务一定要亲手做，不要只看
> 4. 遇到问题先思考，再查阅资料，最后再问
> 5. 坚持每天完成学习任务并记录成果，90 天后你会感谢现在的自己！
>
> ```bash
> git add daily/Day014.md
> git commit -m "Day014: 完成学习与记录"
> ```
