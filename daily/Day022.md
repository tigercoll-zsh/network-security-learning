---
title: Day022：XSS 跨站脚本 - 原理与反射型 XSS
tags:
  - 网络安全
  - XSS
  - Web安全
categories:
  - 90天安全突击
stage: 筑基
abbrlink: d022
date: 2026-02-13
updated: 2026-01-28
---

# Day022：XSS 跨站脚本 - 原理与反射型 XSS

## 基本信息

| 项目 | 内容 |
|------|------|
| **所属阶段** | 筑基（第一阶段） |
| **所属周次** | Week 4：XSS 与文件上传 |
| **今日主题** | XSS 原理与反射型 XSS 实战 |
| **预计时间** | 2.5 小时 |
| **难度等级** | 入门 |

---

## 今日痛点场景

> **场景**：你在测试一个网站的搜索功能，输入了 `<script>alert(1)</script>`，结果页面真的弹窗了！
>
> **问题**：这是什么漏洞？能干什么？为什么我的代码会被执行？
>
> **今天的任务**：理解 XSS 的本质，掌握反射型 XSS 的检测和利用。

---

## 今日目标

- [ ] 理解 XSS 的本质——数据被当作代码执行
- [ ] 掌握反射型 XSS 的检测方法
- [ ] 成功在 DVWA 中弹窗
- [ ] 理解 XSS 的真正危害

**闯关条件**：在 DVWA 反射型 XSS 模块成功弹出 `document.cookie`。

---

## 实战任务（先动手！）

### 任务 1：第一次弹窗（15 分钟）

**环境**：DVWA - XSS (Reflected) - Low

**操作步骤**：
1. 打开 DVWA，设置 Security Level 为 Low
2. 进入 XSS (Reflected) 模块
3. 在输入框输入你的名字，观察结果
4. 现在输入：`<script>alert(1)</script>`
5. 点击 Submit

**记录**：
```
正常输入显示：________________
XSS payload 结果：________________
```

**成功标志**：看到弹窗显示 `1`。

---

### 任务 2：窃取 Cookie（20 分钟）

**目标**：证明 XSS 能偷东西

**操作步骤**：
1. 在同一个模块，输入：`<script>alert(document.cookie)</script>`
2. 观察弹窗内容

**记录**：
```
弹窗显示的内容：________________
这些内容是什么？________________
```

**思考**：如果这个 Cookie 是你的登录凭证，被别人拿到会怎样？

---

### 任务 3：观察 URL（10 分钟）

反射型 XSS 的特点是 payload 在 URL 里。

**操作步骤**：
1. 执行弹窗后，查看浏览器地址栏
2. 观察 URL 中是否包含你输入的内容

**记录**：
```
URL 结构：________________
payload 在 URL 的哪个位置：________________
```

**关键理解**：受害者必须点击包含 payload 的 URL 才会中招。

---

## 今日闯关检查

| 检查项 | 分数 |
|--------|------|
| 理解 XSS 的本质 | 20 分 |
| 成功执行 alert(1) | 20 分 |
| 成功弹出 document.cookie | 25 分 |
| 理解反射型 XSS 的触发方式 | 20 分 |
| 能说出 XSS 的危害 | 15 分 |

**60 分及格，80 分优秀，100 分满分**

你的得分：____

---

## 底层补课

### XSS 是什么？

**XSS** = Cross-Site Scripting（跨站脚本）

**本质**：用户输入的数据被浏览器当作代码执行了。

**类比**：
- 你给餐厅服务员说"我要一份宫保鸡丁"（正常数据）
- 黑客说"我要一份宫保鸡丁，顺便把厨房钥匙给我"（恶意代码）
- 餐厅不检查就照做了（漏洞）

### 为什么叫"跨站"？

历史原因。早期攻击常涉及跨域，虽然现在很多 XSS 不跨域，但名字保留了下来。

### XSS 三种类型

| 类型 | 特点 | 危害程度 |
|------|------|----------|
| **反射型** | Payload 在 URL 里，一次性 | 中 |
| **存储型** | Payload 存入数据库，持久性 | 高 |
| **DOM 型** | 纯前端，不经过服务器 | 中 |

今天先学反射型，后面几天学其他类型。

### 反射型 XSS 原理

```
1. 黑客构造恶意 URL：
   http://example.com/search?q=<script>恶意代码</script>

2. 黑客诱骗受害者点击这个链接

3. 服务器把 q 参数的值原样输出到页面：
   <p>你搜索的是：<script>恶意代码</script></p>

4. 受害者浏览器解析页面，执行了恶意代码

5. 恶意代码窃取 Cookie 发送给黑客
```

### XSS 能干什么？

| 攻击方式 | 说明 |
|----------|------|
| **窃取 Cookie** | 盗取登录凭证，劫持会话 |
| **钓鱼攻击** | 伪造登录框骗取密码 |
| **键盘记录** | 记录用户在页面上的输入 |
| **网页篡改** | 修改页面内容 |
| **挂马** | 让用户下载恶意软件 |

---

## 避坑指南

| 坑点 | 症状 | 解决方案 |
|------|------|----------|
| 弹窗不出来 | 没有反应 | 检查是否被过滤，换个 payload |
| URL 编码问题 | payload 被转义 | 手动 URL 编码特殊字符 |
| 浏览器拦截 | Chrome 阻止弹窗 | 用 Firefox 或禁用 XSS Auditor |

---

## 知识卡片速查

### 基础 Payload

```html
<!-- 最基础的弹窗 -->
<script>alert(1)</script>

<!-- 弹出 Cookie -->
<script>alert(document.cookie)</script>

<!-- 弹出域名 -->
<script>alert(document.domain)</script>
```

### 检测步骤

```
1. 找输入点（搜索框、URL参数、表单）
2. 输入特殊字符测试：'"<>
3. 查看页面源码，观察输入是否被原样输出
4. 如果被输出，尝试构造闭合标签
5. 执行 payload
```

---

## 常见问题

**Q1：XSS 和 SQL 注入有什么区别？**

A1：
- SQL 注入攻击的是**服务器/数据库**
- XSS 攻击的是**用户的浏览器**
- SQL 注入的恶意代码在服务器执行
- XSS 的恶意代码在用户浏览器执行

**Q2：为什么我的 payload 没有执行？**

A2：可能的原因：
1. 被过滤了（检查源码）
2. 被 HTML 实体编码了（`<` 变成 `&lt;`）
3. 浏览器 XSS 保护拦截了
4. 语法错误

**Q3：反射型 XSS 实际利用困难吗？**

A3：需要诱骗用户点击链接，所以比存储型难利用。通常结合钓鱼邮件使用。

---

## 明日预告

**Day 023：XSS 跨站脚本 - 存储型与 DOM 型**

明天你将：
- 学习危害更大的存储型 XSS
- 理解 DOM 型 XSS 的特殊之处
- 对比三种 XSS 的区别

---

## 学习记录

| 项目 | 内容 |
|------|------|
| 实际学习日期 | |
| 弹窗成功次数 | |
| 今日收获 | |

---

> **导师点评**：
>
> 今天你第一次让自己的代码在浏览器里执行了——虽然只是一个弹窗。
>
> 别小看这个弹窗。`alert(1)` 能执行，说明任何 JavaScript 都能执行。
>
> 能执行 JavaScript，就能偷 Cookie、能改页面、能记录键盘——这才是 XSS 的真正威力。
>
> 记住：**弹窗只是证明漏洞存在，真正的攻击从这里才刚刚开始**。

```bash
echo "Day 022 Complete! XSS 入门了！"
```
