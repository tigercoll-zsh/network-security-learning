# Day019：操作系统与脚本 - Nmap 端口扫描安全使用（傻瓜版能照做）

- 日期：2026-01-12
- 周次：第3周

## 学习目标

学完今天你应该能做到：

- 明确知道一句底线：**扫描是有“扰动”的行为，只能在自建/明确授权目标上做**
- 能解释 `-sS` 和 `-sT` 的差异（别背，理解就行）
- 能做一次最小扫描并导出结果，然后把结果整理成表（给 Day020 用）

## 学习内容

### 0️⃣ 合法授权提醒（必须写在报告里）

你每次扫描都要记录：

- 目标是谁（IP/主机名）
- 为什么你有权限（自建/授权范围）
- 扫描窗口（时间）

### 1️⃣ -sS vs -sT：新手最常问的一个点

- `-sS`（SYN scan）：
	- 发送 SYN 探测，不完成完整三次握手
	- 需要更高权限（很多系统需要管理员/root）
	- 通常更快、更“轻”一些
- `-sT`（TCP connect scan）：
	- 直接用系统 API 完整建立 TCP 连接
	- 不需要特殊权限
	- 更容易在日志里留下“连接痕迹”

> 你在 Windows 上没有管理员权限时，`-sT` 往往更稳。

### 2️⃣ 你今天优先掌握的 4 个参数

- `-p`：端口范围
- `-sT`：Connect 扫描（更通用）
- `-sV`：服务版本探测
- `-oN/-oX`：输出到文件（报告证据）

## 实践任务（合法授权范围内）

> 如果你没有靶场/虚拟机：你可以先对 **本机或你自己的一台 VM** 做扫描。

### 任务 1（必做）：确认你有一个“授权目标”

三选一：

- A. 扫描你自己的 VM（推荐）
- B. 扫描你自己的 Windows 本机（`127.0.0.1`）
- C. 扫描你路由器/NAS（必须你自己有权限；仍要谨慎）

把目标写在成果区：`Target=`。

### 任务 2（必做）：最小扫描（Top 1000 TCP）并导出结果

```text
nmap -sT -sV --top-ports 1000 -oN scripts/day019_nmap.txt <target>
```

> 说明：这里用 `text` 代码块是因为不同机器的安装路径不同；你实际跑时替换 `<target>`。

### 任务 3（必做）：把输出整理成“端口→服务→版本”表

你只要在 `day019_nmap.txt` 里找到类似这些行：

```text
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 9.x
80/tcp open  http    nginx 1.x
```

然后整理成 3 列：

- Port
- Service
- Version

（Day020 我会教你用脚本把它自动化。）

## 巩固练习（题与复盘）

### 题 1：解释 -sS 与 -sT 的差异与影响

**思路**：握手有没有完成 + 权限要求 + 留痕。

### 题 2：设计一套稳妥的扫描参数组合

**思路**：少量端口 + 合理时延 + 导出输出 + 记录授权。

## 评估标准（达成判定）

- 报告里写清授权范围（目标/窗口/理由）
- 至少导出一份扫描结果文件
- 能读懂输出中的“open/closed/filtered”并写一句解释

## 学习成果达成情况（由学习者填写）

### 截图与证据

- [ ] `day019_nmap.txt` 文件存在证据
- [ ] 输出中至少 1 个开放端口的截图

### 关键记录（必须填）

- Target：
- 授权说明：
- 扫描时间：

### 结论与反思

- 我发现了哪些开放端口：
- 我下一步要做的枚举验证是：

## 集中参考答案（含思路）

### 题 1 参考答案

- `-sS` 是 SYN 探测，通常不完成三次握手，可能更快且需要更高权限。
- `-sT` 是完整 TCP connect，通用但更容易留下连接日志。

### 题 2 参考答案（示例）

- `nmap -sT -sV --top-ports 100 -oN out.txt <target>`（先小范围）
- 如果确认授权且环境可控，再扩大范围与增加 `-p-`。

## 学习成果示例填写（可照抄）

- Target：`127.0.0.1`（本机自查）
- 我导出了 `scripts/day019_nmap.txt`，发现开放端口主要与远程管理/本地服务有关；下一步要验证这些服务是否真的需要对外。
