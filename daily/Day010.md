---
title: Day010：侦察 - Nmap 主机发现
tags:
  - 网络安全
  - Nmap
  - 主机发现
categories:
  - 90天安全突击
stage: 筑基
abbrlink: d010
date: 2026-02-01
updated: 2026-01-28
---

# Day010：侦察 - Nmap 主机发现

## 基本信息

| 项目 | 内容 |
|------|------|
| **所属阶段** | 筑基（第一阶段） |
| **所属周次** | Week 2：侦察——信息收集 |
| **今日主题** | 使用 Nmap 发现网络中的存活主机 |
| **预计时间** | 2 小时 |
| **难度等级** | 入门 |

---

## 今日痛点场景

> **场景**：你拿到了一个网段 192.168.1.0/24，但不知道里面有多少台机器在线。
>
> **问题**：怎么快速找出所有存活的主机？
>
> **今天的任务**：用 Nmap 扫描整个网段，找出所有活着的机器。

---

## 今日目标

- [ ] 安装并启动 Nmap
- [ ] 使用 Ping 扫描发现主机
- [ ] 使用 ARP 扫描（本地网络更准确）
- [ ] 了解主机发现的原理

**闯关条件**：扫描出本地网络中至少 3 台存活主机。

---

## 实战任务（先动手！）

### 任务 1：Nmap 基础扫描（10 分钟）

**检查 Nmap 是否安装**：
```bash
nmap --version
```

**最简单的扫描**（扫描单个主机）：
```bash
nmap 192.168.1.1
```

**扫描整个网段**：
```bash
nmap 192.168.1.0/24
```

---

### 任务 2：Ping 扫描（主机发现）（20 分钟）

**只做主机发现，不扫端口**：
```bash
nmap -sn 192.168.1.0/24
```

`-sn` = Ping Scan，不扫端口，只看谁在线。

**结果示例**：
```
Nmap scan report for 192.168.1.1
Host is up (0.0010s latency).
Nmap scan report for 192.168.1.100
Host is up (0.0023s latency).
...
Nmap done: 256 IP addresses (5 hosts up)
```

---

### 任务 3：ARP 扫描（本地网络更准）（15 分钟）

**使用 ARP 请求**（需要 root 权限）：
```bash
sudo nmap -sn -PR 192.168.1.0/24
```

**为什么 ARP 更准**：
- ICMP Ping 可能被防火墙拦截
- ARP 请求在同一局域网内几乎不会被拦

**或使用 arp-scan**：
```bash
sudo arp-scan -l
```

---

### 任务 4：保存扫描结果（10 分钟）

**输出到文件**：
```bash
nmap -sn 192.168.1.0/24 -oN hosts.txt
```

**输出格式**：
| 参数 | 格式 |
|------|------|
| `-oN` | 普通文本 |
| `-oX` | XML 格式 |
| `-oG` | Grep 友好格式 |
| `-oA` | 所有格式 |

---

### 任务 5：扫描你的实验环境（15 分钟）

1. 找出你的 Kali IP 地址：`ip addr`
2. 确定你的网段（如 192.168.56.0/24）
3. 执行主机发现扫描
4. 记录发现的主机

```bash
nmap -sn 192.168.56.0/24
```

---

## 今日闯关检查

| 检查项 | 状态 |
|--------|------|
| Nmap 安装成功 | |
| 能执行 Ping 扫描 | |
| 发现至少 3 台存活主机 | |
| 理解 -sn 参数含义 | |
| 会保存扫描结果 | |

---

## 底层补课

### Nmap 是什么？

**定义**：Network Mapper，最著名的网络扫描工具。

**功能**：
- 主机发现（Host Discovery）
- 端口扫描（Port Scanning）
- 服务识别（Service Detection）
- 操作系统识别（OS Detection）
- 漏洞扫描（NSE 脚本）

### 主机发现的原理

| 方法 | 原理 | 优缺点 |
|------|------|--------|
| ICMP Echo | 发 Ping，等 Pong | 可能被防火墙拦 |
| TCP SYN | 发 SYN 到常见端口 | 更隐蔽 |
| TCP ACK | 发 ACK 包 | 绕过某些防火墙 |
| ARP | 广播 ARP 请求 | 本地网络最准 |

### Nmap 扫描阶段

```
目标指定 -> 主机发现 -> 端口扫描 -> 服务识别 -> 脚本扫描
```

今天只学第一步和第二步。

---

## 避坑指南

| 坑点 | 症状 | 解决方案 |
|------|------|----------|
| 扫不到主机 | 0 hosts up | 换用 ARP 扫描 |
| 权限不足 | Operation not permitted | 加 sudo |
| 扫描太慢 | 卡住 | 用 -T4 加速 |
| 扫错网段 | 结果全空 | 确认 IP 和子网掩码 |

---

## 知识卡片速查

### Nmap 主机发现速查

```bash
# Ping 扫描（最常用）
nmap -sn 192.168.1.0/24

# ARP 扫描（本地网络）
sudo nmap -sn -PR 192.168.1.0/24

# 跳过主机发现（强制扫描）
nmap -Pn 192.168.1.1

# 快速扫描
nmap -sn -T4 192.168.1.0/24

# 扫描多个网段
nmap -sn 192.168.1.0/24 192.168.2.0/24

# 扫描 IP 范围
nmap -sn 192.168.1.1-100

# 从文件读取目标
nmap -sn -iL targets.txt
```

---

## 常见问题

**Q1：-sn 和 -sP 有什么区别？**

A1：一样的，-sP 是旧版写法，-sn 是新版。

**Q2：为什么有些主机 Ping 不通但实际在线？**

A2：可能开了防火墙禁 ICMP。用 TCP 扫描或 ARP 扫描试试。

**Q3：扫描别人的网络合法吗？**

A3：未经授权扫描他人网络是违法的。只能扫：
- 自己的设备
- 获得授权的目标
- 公开的练习靶场

---

## 明日预告

**Day 011：Nmap 端口扫描**

明天你将：
- 学习 TCP 端口扫描原理
- 掌握 SYN 扫描、全连接扫描
- 识别开放的服务端口

---

## 学习记录

| 项目 | 内容 |
|------|------|
| 实际学习日期 | |
| 今日收获 | |

---

> **导师点评**：
>
> 今天你拿起了 Nmap——黑客和安全工程师的瑞士军刀。
>
> 主机发现只是第一步：先找到活着的目标，才能继续深入。
>
> 记住：**不知道目标在哪，就没法攻击**。明天我们继续——端口扫描。

```bash
echo "Day 010 Complete! Nmap 入门成功！"
```
