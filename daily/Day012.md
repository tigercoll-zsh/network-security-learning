---
title: Day012：侦察 - 漏洞初判
tags:
  - 网络安全
  - 漏洞
  - CVE
categories:
  - 90天安全突击
stage: 筑基
abbrlink: d012
date: 2026-02-03
updated: 2026-01-28
---

# Day012：侦察 - 漏洞初判

## 基本信息

| 项目 | 内容 |
|------|------|
| **所属阶段** | 筑基（第一阶段） |
| **所属周次** | Week 2：侦察——信息收集 |
| **今日主题** | 根据扫描结果判断可能存在的漏洞 |
| **预计时间** | 2 小时 |
| **难度等级** | 进阶 |

---

## 今日痛点场景

> **场景**：你扫描出目标运行了 `vsftpd 2.3.4`，但不知道这个版本有没有漏洞。
>
> **问题**：怎么知道一个软件版本是否存在已知漏洞？
>
> **今天的任务**：学会查 CVE 漏洞库，用 Nmap 脚本检测漏洞，判断攻击可能性。

---

## 今日目标

- [ ] 理解 CVE 漏洞编号系统
- [ ] 学会查询漏洞数据库
- [ ] 使用 Nmap NSE 脚本检测漏洞
- [ ] 初步判断目标的攻击面

**闯关条件**：找到 Metasploitable2 中至少 3 个已知漏洞的服务。

---

## 实战任务（先动手！）

### 任务 1：回顾扫描结果（10 分钟）

假设你在 Day011 扫描到了以下服务：

```
21/tcp   open  ftp         vsftpd 2.3.4
22/tcp   open  ssh         OpenSSH 4.7p1
139/tcp  open  netbios-ssn Samba smbd 3.X
445/tcp  open  netbios-ssn Samba smbd 3.0.20
3306/tcp open  mysql       MySQL 5.0.51a
```

这些老版本很可能有漏洞，让我们来查一查。

---

### 任务 2：搜索 CVE 漏洞库（30 分钟）

**CVE 搜索网站**：
- https://cve.mitre.org/
- https://nvd.nist.gov/
- https://www.cvedetails.com/
- https://www.exploit-db.com/

**搜索 vsftpd 2.3.4**：

1. 访问 https://www.exploit-db.com/
2. 搜索 "vsftpd 2.3.4"
3. 发现著名的后门漏洞（CVE-2011-2523）

**关键信息**：
- CVE 编号
- 影响版本
- 漏洞类型（远程代码执行、提权、信息泄露）
- 是否有公开 Exploit

---

### 任务 3：Nmap NSE 漏洞脚本（30 分钟）

**查看可用的漏洞脚本**：
```bash
ls /usr/share/nmap/scripts/ | grep vuln
```

**运行漏洞检测脚本**：
```bash
sudo nmap --script vuln 192.168.56.102
```

**针对特定服务**：
```bash
# FTP 漏洞检测
sudo nmap --script ftp-vsftpd-backdoor -p 21 192.168.56.102

# SMB 漏洞检测
sudo nmap --script smb-vuln* -p 139,445 192.168.56.102

# HTTP 漏洞检测
sudo nmap --script http-vuln* -p 80 192.168.56.102
```

---

### 任务 4：searchsploit 本地搜索（15 分钟）

Kali 自带 searchsploit，可离线搜索 Exploit-DB：

```bash
# 搜索 vsftpd
searchsploit vsftpd

# 搜索 Samba 3.0
searchsploit samba 3.0

# 搜索 OpenSSH 4.7
searchsploit openssh 4.7

# 查看 exploit 详情
searchsploit -x exploits/unix/remote/17491.rb
```

---

### 任务 5：整理漏洞清单（15 分钟）

创建一个表格，记录发现的潜在漏洞：

| 服务 | 版本 | CVE 编号 | 漏洞类型 | 严重性 |
|------|------|----------|----------|--------|
| vsftpd | 2.3.4 | CVE-2011-2523 | 后门 | 严重 |
| Samba | 3.0.20 | CVE-2007-2447 | 远程命令执行 | 严重 |
| MySQL | 5.0.51a | 多个 | 认证绕过 | 高 |

---

## 今日闯关检查

| 检查项 | 状态 |
|--------|------|
| 理解 CVE 编号含义 | |
| 成功在漏洞库找到漏洞信息 | |
| 使用 Nmap 脚本检测漏洞 | |
| 使用 searchsploit 搜索 | |
| 整理出漏洞清单 | |

---

## 底层补课

### 什么是 CVE？

**CVE** = Common Vulnerabilities and Exposures（通用漏洞和披露）

**格式**：CVE-年份-编号
- 例：CVE-2021-44228（Log4Shell）

**作用**：全球统一的漏洞编号系统，方便交流和查找。

### 漏洞严重性评分 CVSS

| 评分 | 严重性 |
|------|--------|
| 0.0 | 无 |
| 0.1-3.9 | 低 |
| 4.0-6.9 | 中 |
| 7.0-8.9 | 高 |
| 9.0-10.0 | 严重 |

### 常见漏洞类型

| 类型 | 英文 | 危害 |
|------|------|------|
| 远程代码执行 | RCE | 最严重，可完全控制 |
| 权限提升 | Privilege Escalation | 普通用户变 root |
| 信息泄露 | Information Disclosure | 泄露敏感数据 |
| 拒绝服务 | DoS | 让服务崩溃 |
| 认证绕过 | Authentication Bypass | 绕过登录 |

---

## 避坑指南

| 坑点 | 症状 | 解决方案 |
|------|------|----------|
| 找不到漏洞 | 搜索无结果 | 换关键词，版本号可能不精确 |
| 脚本运行失败 | 报错 | 检查目标是否可达 |
| 误报 | 漏洞不存在 | Nmap 脚本可能误判，需验证 |

---

## 知识卡片速查

### 漏洞搜索速查

```bash
# searchsploit 搜索
searchsploit vsftpd
searchsploit -m 17491  # 复制 exploit 到当前目录

# Nmap 漏洞脚本
nmap --script vuln 192.168.56.102
nmap --script "*vuln*" 192.168.56.102

# 更新 searchsploit 数据库
searchsploit -u
```

### 常用漏洞资源

| 网站 | 地址 | 特点 |
|------|------|------|
| CVE | cve.mitre.org | 官方编号 |
| NVD | nvd.nist.gov | 详细分析 |
| Exploit-DB | exploit-db.com | 有 PoC 代码 |
| Vulhub | vulhub.org | 漏洞复现环境 |

---

## 常见问题

**Q1：找到漏洞就一定能利用吗？**

A1：不一定。漏洞可能：
- 需要特定配置
- 需要认证
- 已经被补丁修复
- Exploit 不稳定

**Q2：Nmap 脚本检测准确吗？**

A2：不完全准确，可能有误报或漏报。最终要手动验证。

**Q3：如何判断漏洞是否值得尝试？**

A3：优先级：
1. RCE > 其他类型
2. 有现成 Exploit > 需要自己写
3. 严重性高 > 低

---

## 明日预告

**Day 013：侦察报告撰写**

明天你将：
- 学习如何整理侦察信息
- 撰写专业的渗透测试报告
- 为攻击阶段做准备

---

## 学习记录

| 项目 | 内容 |
|------|------|
| 实际学习日期 | |
| 今日收获 | |

---

> **导师点评**：
>
> 今天你学会了从版本号看漏洞——这是渗透测试最关键的一步。
>
> 扫描只是收集数据，漏洞判断才是把数据变成攻击路径。
>
> Metasploitable2 浑身是洞，每个漏洞都值得你去尝试利用。
>
> 记住：**信息收集做得好，攻击才能精准高效**。

```bash
echo "Day 012 Complete! 我会查漏洞了！"
```
