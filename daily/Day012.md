---
title: Day012：安全协议与加密 - 加密基础：哈希/对称/非对称
tags:
  - 网络
  - 安全
  - 学习计划
categories:
  - 网络安全
abbrlink: cde58
date: 2026-02-03
updated: 2026-02-03
---

# Day012：安全协议与加密 - 加密基础：哈希/对称/非对称

- **日期**：2026-02-03
- **周次**：第 2 周
- **模块**：安全协议与加密
- **主题**：加密基础：哈希/对称/非对称
- **预计学习时间**：2 小时

---

## 🎯 学习目标

学完今天你应该能做到：

- 彻底区分哈希（Hash）、对称加密和非对称加密的区别
- 理解“数字签名”和“验签”的原理
- 知道常见算法（SHA256, AES, RSA）的应用场景
- **识别弱加密算法（如 MD5, DES）并理解其风险**
- **掌握密码存储的最佳实践（加盐哈希）**

<!--more-->

## 📚 完整学习内容（必读）

本节包含今天需要学习的全部知识点，请认真阅读并理解。

### 一、概念理解

#### 12.1.1 密码学三剑客

1.  **哈希 (Hash)**：
    - **特点**：单向的，不可逆。
    - **比喻**：把这头猪做成香肠。你不能把香肠还原成猪。
    - **作用**：验证完整性（有没有被改过）。
    - **常见算法**：MD5 (已死), SHA-1 (濒死), SHA-256 (推荐)。

2.  **对称加密 (Symmetric Encryption)**：
    - **特点**：加密和解密用**同一把钥匙**。
    - **比喻**：家里的门锁，进出都用同一把钥匙。
    - **作用**：保密数据。
    - **常见算法**：DES (已死), AES (推荐), ChaCha20。

3.  **非对称加密 (Asymmetric Encryption)**：
    - **特点**：**两把钥匙**（公钥和私钥）。公钥加密，私钥解密；或者私钥签名，公钥验签。
    - **比喻**：投递箱（公钥是投递口，谁都能投；私钥是钥匙，只有你能开箱）。
    - **作用**：密钥交换、身份认证（数字签名）。
    - **常见算法**：RSA, ECC (椭圆曲线)。

### 二、原理讲解

#### 12.2.1 哈希碰撞
- 哈希函数将任意长度输入变成固定长度输出（如 SHA256 输出 64 个字符）。
- **碰撞**：两个不同的文件，算出来的哈希值一模一样。
- MD5 被淘汰就是因为太容易制造碰撞了。

#### 12.2.2 数字签名 (Digital Signature)
数字签名是为了解决“信是谁写的”和“信有没有被改过”的问题。

**流程**：
1.  **签名（发送方 A）**：
    - 先把信件内容做一次 **Hash**（摘要）。
    - 用 A 的 **私钥** 对摘要进行加密。这就是“签名”。
    - 把信件原文 + 签名一起发出去。
2.  **验签（接收方 B）**：
    - B 收到后，把信件原文做一次 **Hash**，得到摘要 X。
    - B 用 A 的 **公钥** 解密签名，得到摘要 Y。
    - 比较 X 和 Y。如果相等，证明：
        - 1. 信确实是 A 写的（因为只有 A 有私钥）。
        - 2. 信没有被改过（因为哈希值对上了）。

### 三、技术细节

#### 12.3.1 加密强度
- **AES-128 vs AES-256**：指密钥长度。目前 128 位已经足够安全，256 位更安全但慢一点点。
- **RSA-2048 vs RSA-4096**：RSA 1024 位已不安全，起步就是 2048。

#### 12.3.2 盐 (Salt)
- 存密码时，直接存 Hash 是不安全的（黑客可以用彩虹表查）。
- **加盐**：`Hash("password123" + "随机字符串")`。这样即使两个用户密码一样，数据库里的 Hash 也不一样。

### 四、进阶知识（选学）

#### 12.4.1 混合加密
- 现实中通常结合使用。
- 比如 HTTPS：用**非对称加密**（慢、安全）协商出密钥，然后用**对称加密**（快）传输真正的网页数据。

### 五、本日知识点速查表

| 序号 | 核心概念 | 关键点 | 备注 |
|------|----------|--------|------|
| 1 | Hash | 不可逆 | SHA-256 |
| 2 | 对称加密 | 同一密钥 | AES |
| 3 | 非对称加密 | 公钥/私钥 | RSA |
| 4 | 签名 | 私钥加密摘要 | 证明身份 |

---

## 🗺️ 知识图谱

### 今日内容在整体知识体系中的位置

```
网络安全学习路径
├── 第 2 周：安全协议与加密
│   ├── Day011：SSH 安全与密钥管理
│   └── Day012：加密基础与算法安全
│       ├── 核心概念：Hash/Symmetric/Asymmetric、**Salt**
│       ├── 实践技能：OpenSSL 运算、**弱算法识别**
│       └── 关联知识点：PKI、**彩虹表**
└── 后续衔接
    └── Day013：加密应用与场景
```

### 今日关键词

`SHA256` · `AES` · `RSA` · `Signature` · **`彩虹表`** · **`加盐`**

---

## 🔧 实践任务（合法授权范围内）

> ⚠️ **安全提示**：所有任务必须在合法授权的实验环境中进行，禁止对未授权目标进行任何测试。

请按顺序完成以下任务：

### 任务 1：环境准备与哈希碰撞体验（10 分钟）

在命令行体验 Hash 计算，并尝试理解哈希碰撞（虽然这里很难手动制造碰撞，但可以观察微小变化带来的巨大差异）。

**操作步骤**：
1.  打开终端。
2.  创建两个文件：
    - `echo "password123" > pass1.txt`
    - `echo "password123 " > pass2.txt` (注意多了一个空格)
3.  计算 MD5 (Linux/Mac: `md5sum`, Windows: `Get-FileHash -Algorithm MD5`)。
4.  计算 SHA256 (Linux/Mac: `sha256sum`, Windows: `Get-FileHash`)。
5.  **思考**：两个文件只差一个空格，哈希值为什么完全不同（雪崩效应）？如果黑客拿到了 `pass1.txt` 的哈希值，他能反推出 "password123" 吗？（提示：彩虹表）。

### 任务 2：核心实验：对称加密体验与密钥管理思考（30 分钟）

使用 OpenSSL 体验对称加密 (AES)，并思考密钥如何保存。

**操作步骤**：
1.  **加密**：
    ```bash
    openssl enc -aes-256-cbc -salt -in pass1.txt -out secret.enc
    ```
    *会提示输入密码，输一个比如 123456*
2.  **查看密文**：`cat secret.enc` (一堆乱码)。
3.  **解密**：
    ```bash
    openssl enc -aes-256-cbc -d -in secret.enc -out secret.dec
    ```
    *输入刚才的密码。*
4.  **验证**：`cat secret.dec` 应该和原文一样。
5.  **思考**：如果你的服务器上存了大量用户的 AES 加密数据，密钥放在哪里最安全？（配置文件？环境变量？还是专用的密钥管理服务 KMS？）

### 任务 3：进阶挑战：RSA 签名与验签（15 分钟）

体验 RSA 签名与验签，理解“防篡改”和“身份认证”。

**操作步骤**：
1.  生成私钥：`openssl genrsa -out private.pem 2048`
2.  提取公钥：`openssl rsa -in private.pem -pubout -out public.pem`
3.  **签名**（用私钥）：
    ```bash
    openssl dgst -sha256 -sign private.pem -out sign.sha256 pass1.txt
    ```
4.  **篡改**：尝试修改 `pass1.txt` 的内容。
5.  **验签**（用公钥）：
    ```bash
    openssl dgst -sha256 -verify public.pem -signature sign.sha256 pass1.txt
    ```
    *如果文件未修改，输出 "Verified OK"；如果被修改，验签失败。*

---

## 📝 巩固练习（题目与复盘）

完成以下练习来检验你的学习效果。

### 练习 1：概念理解（5 分钟）

哈希与加密的区别是什么？请从可逆性、长度和用途三个方面回答。

**参考答案**（完成后对照）：
- **可逆性**：加密是可逆的（有密钥能解回来）；哈希是不可逆的（无法还原）。
- **长度**：加密后的长度随原文长度增加；哈希后的长度是固定的（如 256 位）。
- **用途**：加密为了保密；哈希为了校验完整性。

### 练习 2：安全场景辨析（10 分钟）

请思考并回答：
1.  **场景 A**：你的数据库中明文存储了用户的密码。如果数据库泄露，会发生什么？
2.  **场景 B**：你使用 MD5 对用户密码进行哈希存储。黑客拿到了数据库，他能还原出密码吗？怎么做？
3.  **场景 C**：为了防止彩虹表攻击，你应该如何改进密码存储方案？

**参考答案**（完成后对照）：
1.  **场景 A**：黑客可以直接获得所有用户的密码，导致严重的账户被盗事件（撞库攻击）。
2.  **场景 B**：能（很大程度上）。黑客可以使用**彩虹表**（预先计算好的哈希值数据库）或暴力破解工具，快速查出常见密码对应的 MD5 原文。
3.  **场景 C**：使用**加盐 (Salting)** 技术。在密码后面拼接一个随机字符串再进行哈希，使得彩虹表失效。

### 练习 3：实操应用（10 分钟）

如果 Alice 要发一封机密邮件给 Bob，并证明是自己发的，她应该怎么做？

**参考答案**（完成后对照）：
1.  **保密**：Alice 用 **Bob 的公钥** 加密邮件内容。（只有 Bob 的私钥能解开，保证别人看不懂）。
2.  **证明身份（签名）**：Alice 用 **Alice 的私钥** 对邮件摘要进行加密签名。（Bob 用 Alice 的公钥验签，证明是 Alice 发的）。
3.  Bob 收到后：先用 Alice 公钥验签，确认来源；再用 Bob 私钥解密，看到内容。

### 练习 4：深度思考（10 分钟）

为什么 HTTPS 握手时不全程使用非对称加密？

**参考答案**（完成后对照）：
**效率问题**。非对称加密（如 RSA）涉及大数幂运算，计算量极大，速度比对称加密（如 AES）慢几百到几千倍。如果全程用 RSA，服务器 CPU 会爆炸，网页加载会非常慢。所以只在握手阶段用一次非对称加密来安全交换密钥，后面大数据传输都用对称加密。

---

## ✅ 评估标准（达成判定）

请对照以下标准检查你的学习成果：

- [x] 能解释为什么哈希不可逆
- [x] 成功完成了一次 AES 加解密操作
- [x] 明白签名是用私钥签，公钥验
- [x] **能区分强加密算法和弱加密算法（如知道 MD5 已不安全）**
- [x] **理解“加盐”对密码存储安全的重要性**

### 自检清单

完成学习后，请检查以下项目：

- [ ] **概念理解**：能画出数字签名的流程图，并解释彩虹表攻击原理
- [ ] **实际应用**：知道保存用户密码要加盐 Hash
- [ ] **动手能力**：熟练使用 openssl 进行加解密，并观察哈希碰撞（虽然难复现，但理解原理）
- [ ] **安全意识**：能识别代码中使用了不安全的加密算法
- [ ] **时间管理**：能在 2 小时内完成今日学习内容

### 学习进度自评

| 评估项目 | 1-5 星 | 备注 |
|----------|--------|------|
| 概念理解 | ⭐⭐⭐⭐⭐ | 猪变香肠的比喻很形象。**理解彩虹表了吗？** |
| 动手能力 | ⭐⭐⭐⭐⭐ | 感觉像特工一样。**会用 OpenSSL 了吗？** |
| 学习兴趣 | ⭐⭐⭐⭐⭐ | 密码学真好玩。**对破解密码感兴趣吗？** |

---

## 📊 学习成果记录（由学习者填写）

### 学习信息

| 项目 | 内容 |
|------|------|
| 学习日期 | 2026-02-03 |
| 学习时长 | ___ 小时 |
| 完成情况 | ⬜ 已完成 / ⬜ 部分完成 / ⬜ 未完成 |

### 实践任务完成记录

| 任务 | 完成状态 | 关键证据/截图 | 用时 |
|------|----------|---------------|------|
| 任务 1 | ⬜ 已完成 / ⬜ 部分 / ⬜ 未做 | 记录：两个文件的 Hash | ___ 分钟 |
| 任务 2 | ⬜ 已完成 / ⬜ 部分 / ⬜ 未做 | 截图：加解密过程 | ___ 分钟 |
| 任务 3 | ⬜ 已完成 / ⬜ 部分 / ⬜ 未做 | 记录：Verified OK | ___ 分钟 |

### 命令/代码记录

```bash
# 记录你今天使用的命令
openssl enc -aes-256-cbc ...
```

### 今日总结与反思

**今日收获**（用 3-5 句话总结今天学到了什么）：

_例如：今天彻底分清了哈希和加密。原来数字签名就是“私钥加密摘要”，太精妙了。以后写代码存密码知道一定要加盐了。_

**遇到的问题与解决**：

_例如：Windows 上没有 sha256sum 命令，查了下可以用 CertUtil 或 PowerShell 的 Get-FileHash 代替。_

**明日待深化的问题**：

_例如：这些加密算法在实际 Web 开发或运维中具体是怎么配置的？（明日主题）_

---

## 💡 知识卡片速查

### 核心概念速记

| 概念 | 定义 | 举例 |
|------|------|------|
| **Hash** | 摘要算法 | 指纹 |
| **Salt** | 盐 | 随机佐料，防彩虹表 |
| **RSA** | 非对称 | 慢，安全，换密钥 |
| **AES** | 对称 | 快，传数据 |

### 常用命令速查

| 场景 | 命令 | 说明 |
|------|------|------|
| 计算 Hash | `md5sum file` | 查验完整性 |
| AES 加密 | `openssl enc -aes-256-cbc` | 文件加密 |
| 签名 | `openssl dgst -sign` | 电子签名 |

---

## 🚀 下一步学习预告

**明日主题预告**：Day013 - 安全协议与加密：加密应用与场景

**学习重点预告**：
- 常见的弱加密配置风险
- 数据库密码存储最佳实践
- 云上加密服务简介

**今日学习为明日做铺垫**：
- 懂了算法原理，明天看看它们在真实系统中是怎么被用（或者被滥用）的。

---

## 📖 参考资料

- 📖 官方文档：[OpenSSL Cookbook](https://www.feistyduck.com/books/openssl-cookbook/)
- 🎥 视频教程：B站搜索 "密码学基础"
- 🛠️ 实践工具：OpenSSL

---

> 💬 **学习提示**：
> 1. 建议按照文档顺序学习，不要跳跃
> 2. 每个知识点理解后再进行下一步
> 3. 实践任务一定要亲手做，不要只看
> 4. 遇到问题先思考，再查阅资料，最后再问
> 5. 坚持每天完成学习任务并记录成果，90 天后你会感谢现在的自己！
>
> ```bash
> git add daily/Day012.md
> git commit -m "Day012: 完成学习与记录"
> ```
