---
title: Day013：安全协议与加密 - 加密应用与场景
tags:
  - 网络
  - 安全
  - 学习计划
categories:
  - 网络安全
abbrlink: dd631
date: 2026-02-04
updated: 2026-02-04
---

# Day013：安全协议与加密 - 加密应用与场景

- **日期**：2026-02-04
- **周次**：第 2 周
- **模块**：安全协议与加密
- **主题**：加密应用与场景
- **预计学习时间**：2 小时

---

## 🎯 学习目标

学完今天你应该能做到：

- 理解加密技术在存储、传输和认证中的具体落地场景
- 识别开发中常见的弱加密配置（如 ECB 模式、硬编码密钥）
- 掌握安全的密码存储策略
- **了解数据生命周期中的安全风险（Data at Rest/Transit/Use）**
- **掌握 JWT 的安全使用和常见漏洞防御**

<!--more-->

## 📚 完整学习内容（必读）

本节包含今天需要学习的全部知识点，请认真阅读并理解。

### 一、概念理解

#### 13.1.1 数据状态与加密
数据在生命周期中有三种状态，都需要保护：
1.  **传输中 (Data in Transit)**：在网线、光纤里跑的数据。
    - *保护*：TLS/SSL, SSH, VPN。
2.  **存储中 (Data at Rest)**：躺在硬盘、数据库、U盘里的数据。
    - *保护*：全盘加密 (BitLocker), 数据库加密 (TDE), 文件加密 (AES)。
3.  **使用中 (Data in Use)**：正在内存里被 CPU 计算的数据。
    - *保护*：机密计算 (Confidential Computing), SGX 飞地。

#### 13.1.2 常见的弱加密风险
- **使用过时的算法**：MD5, SHA1, DES, RC4。
- **密钥硬编码**：把 AES 密钥写死在代码里（反编译就能看到）。
- **ECB 模式**：AES 的 ECB 模式相同的明文块会生成相同的密文块，能看出一张加密图片的轮廓（企鹅图）。应使用 **CBC** 或 **GCM** 模式。
- **随机数不随机**：使用 `rand()` 而不是加密级安全的 `SecureRandom`。

### 二、原理讲解

#### 13.2.1 密码存储的最佳实践
千万不要明文存密码！
- **错误**：`DB.save(username, password)` -> 数据库泄漏 = 裸奔。
- **初级**：`DB.save(username, MD5(password))` -> 彩虹表秒破。
- **中级**：`DB.save(username, SHA256(password + salt))` -> 安全，但计算太快，防不住 GPU 暴力破解。
- **高级 (推荐)**：使用 **Bcrypt**, **Argon2**, **PBKDF2**。
    - **特点**：故意设计得很慢（计算哈希需要几百毫秒），极大增加黑客爆破成本。

#### 13.2.2 密钥管理服务 (KMS)
- 在云环境（AWS/阿里云）中，不要自己生成和保存密钥文件。
- 使用 **KMS (Key Management Service)**。
- **优点**：
  - 密钥永不离开硬件安全模块 (HSM)。
  - 有审计日志（谁在什么时候用了密钥）。
  - 自动轮换。

### 三、技术细节

#### 13.3.1 Base64 不是加密！
- **误区**：很多新手以为 Base64 是加密。
- **真相**：Base64 只是**编码**，为了把二进制数据变成可打印字符。
- **破解**：`base64 -d` 即可还原，没有任何机密性可言。

#### 13.3.2 JWT (JSON Web Token) 安全
- JWT 经常用于 API 认证。
- 它的签名部分使用了哈希（HS256）或非对称加密（RS256）。
- **风险**：
  - **None 算法攻击**：黑客把 header 里的 `alg` 改成 `none`，去掉签名，后端如果不严谨可能直接放行。
  - **密钥泄露**：HS256 用的密钥太短，被暴力破解。

### 四、进阶知识（选学）

#### 13.4.1 同态加密 (Homomorphic Encryption)
- 允许在密文上直接进行计算，解密后的结果和在明文上计算一样。
- **场景**：把医疗数据加密后发给 AI 公司训练模型，AI 公司看不到数据内容，但能算出模型参数。

### 五、本日知识点速查表

| 序号 | 核心概念 | 关键点 | 备注 |
|------|----------|--------|------|
| 1 | 传输加密 | TLS/VPN | 防窃听 |
| 2 | 存储加密 | 数据库/磁盘 | 防拖库 |
| 3 | Base64 | 编码 | 不是加密 |
| 4 | Bcrypt | 慢哈希 | 存密码专用 |

---

## 🗺️ 知识图谱

### 今日内容在整体知识体系中的位置

```
网络安全学习路径
├── 第 2 周：安全协议与加密
│   ├── Day012：加密基础
│   └── Day013：加密应用与场景
│       ├── 核心概念：Data at Rest/Transit
│       ├── 实践技能：Base64 编解码、密码存储策略
│       └── 关联知识点：OWASP Top 10
```

### 今日关键词

`Bcrypt` · `Base64` · `KMS` · `Data at Rest`

---

## 🔧 实践任务（合法授权范围内）

> ⚠️ **安全提示**：所有任务必须在合法授权的实验环境中进行，禁止对未授权目标进行任何测试。

请按顺序完成以下任务：

### 任务 1：环境准备（5 分钟）

体验 Base64 编解码。

**操作步骤**：
1. 打开终端。
2. 编码：`echo "admin:123456" | base64`
3. 记录输出的字符串（如 `YWRtaW46MTIzNDU2Cg==`）。
4. 解码：`echo "YWRtaW46MTIzNDU2Cg==" | base64 -d`
5. 结论：这能叫加密吗？任何拿到这个字符串的人都能还原。

### 任务 2：核心实验（30 分钟）

模拟“加盐哈希”存储密码。

**操作步骤**：
1. 假设密码是 `123456`。
2. **不加盐**：`echo -n "123456" | sha256sum` -> 记录结果 A。
3. **加盐**：假设盐是随机串 `Nx8z`。
   `echo -n "123456Nx8z" | sha256sum` -> 记录结果 B。
4. **验证**：下次用户登录输入 `123456`，系统取出盐 `Nx8z`，拼起来算 Hash，如果等于 B，则登录成功。
5. **思考**：如果两个用户密码都是 `123456`，但盐不一样，数据库里的 Hash 还会一样吗？

### 任务 3：进阶挑战（选做，15 分钟）

Python 体验 Bcrypt（需要安装 Python 环境）。

**操作步骤**：
1. 安装：`pip install bcrypt`
2. 编写脚本 `test_bcrypt.py`：
   ```python
   import bcrypt
   password = b"secret_password"
   # 生成 Salt 并 Hash
   hashed = bcrypt.hashpw(password, bcrypt.gensalt())
   print(f"Hashed: {hashed}")
   # 验证
   check = bcrypt.checkpw(password, hashed)
   print(f"Match: {check}")
   ```
3. 运行几次，观察每次生成的 `hashed` 值是否一样？（应该不一样，因为内置了随机盐）。

---

## 📝 巩固练习（题目与复盘）

完成以下练习来检验你的学习效果。

### 练习 1：概念理解（5 分钟）

题目：为什么不能用明文或可逆加密存储密码？

**参考答案**（完成后对照）：
- **明文**：如果数据库被黑客拖库（窃取），黑客直接获得所有用户密码，可以拿去撞库（尝试登录其他网站）。
- **可逆加密**（如 AES）：密钥通常也保存在服务器上。一旦服务器被攻陷，密钥和密文同时泄露，黑客解密后依然得到明文密码。
- **正确做法**：单向哈希（Hash），最好是慢哈希（Bcrypt）。

### 练习 2：实操应用（10 分钟）

练习：你的团队要开发一个 App，涉及用户身份证号存储，应该怎么设计？

**参考答案**（完成后对照）：
身份证号属于 PII（个人敏感信息），必须加密存储。
1.  **数据库层**：使用 AES-256 加密存入字段（如 `AES(身份证, Key)`）。
2.  **密钥管理**：Key 不能写死在代码里，应该从环境变量读取或使用 KMS 服务。
3.  **展示层**：前端展示时进行脱敏（如 `320***********1234`）。
4.  **传输层**：必须全程 HTTPS。

### 练习 3：深度思考（10 分钟）

HTTPS 只能保护传输过程，如果服务器上有恶意软件，HTTPS 有用吗？

**参考答案**（完成后对照）：
**没用**。HTTPS 就像运钞车，保证钱在路上不被抢。但如果终点站（服务器）里有内鬼（恶意软件/WebShell），钱刚卸车就被偷了，运钞车再坚固也没用。这就是为什么我们需要“纵深防御”（传输加密 + 主机安全 + WAF + 审计）。

---

## ✅ 评估标准（达成判定）

请对照以下标准检查你的学习成果：

- [x] 能一眼认出 Base64 编码
- [x] 知道密码应该用 Bcrypt/Argon2 存储
- [x] 理解 Salt 的作用

### 自检清单

完成学习后，请检查以下项目：

- [ ] **概念理解**：能解释传输加密和存储加密的区别
- [ ] **实际应用**：能指出代码中硬编码密钥的风险
- [ ] **动手能力**：跑通了 Base64 和 Hash 实验
- [ ] **时间管理**：能在 2 小时内完成今日学习内容

### 学习进度自评

| 评估项目 | 1-5 星 | 备注 |
|----------|--------|------|
| 概念理解 | ⭐⭐⭐⭐⭐ | Base64 不是加密！记住了 |
| 动手能力 | ⭐⭐⭐⭐⭐ | Python 脚本跑通了 |
| 学习兴趣 | ⭐⭐⭐⭐⭐ | 原来存密码这么多学问 |

---

## 📊 学习成果记录（由学习者填写）

### 学习信息

| 项目 | 内容 |
|------|------|
| 学习日期 | 2026-02-04 |
| 学习时长 | ___ 小时 |
| 完成情况 | ⬜ 已完成 / ⬜ 部分完成 / ⬜ 未完成 |

### 实践任务完成记录

| 任务 | 完成状态 | 关键证据/截图 | 用时 |
|------|----------|---------------|------|
| 任务 1 | ⬜ 已完成 / ⬜ 部分 / ⬜ 未做 | 记录：Base64 串 | ___ 分钟 |
| 任务 2 | ⬜ 已完成 / ⬜ 部分 / ⬜ 未做 | 记录：加盐前后的 Hash | ___ 分钟 |
| 任务 3 | ⬜ 已完成 / ⬜ 部分 / ⬜ 未做 | 记录：Bcrypt 输出 | ___ 分钟 |

### 命令/代码记录

```bash
# 记录你今天使用的命令
echo "test" | base64
```

### 今日总结与反思

**今日收获**（用 3-5 句话总结今天学到了什么）：

_例如：今天纠正了一个大误区，以前总觉得 Base64 是加密，现在知道那只是编码。还学会了密码必须加盐哈希存储，最好用 Bcrypt。以后做开发会更注意敏感数据的保护。_

**遇到的问题与解决**：

_例如：Python 安装 bcrypt 库时报错缺少编译环境，后来直接用了在线的 bcrypt 计算器体验了一下原理。_

**明日待深化的问题**：

_例如：这周学了好多协议和加密知识，明天通过一个综合实验把它们串起来。（明日周测）_

---

## 💡 知识卡片速查

### 核心概念速记

| 概念 | 定义 | 举例 |
|------|------|------|
| **Base64** | 编码 | `aGVsbG8=` |
| **AES-ECB** | 弱加密模式 | 相同的输入=相同的输出 |
| **Bcrypt** | 慢哈希 | 密码存储神器 |
| **KMS** | 密钥管理服务 | 云端管家 |

### 常用命令速查

| 场景 | 命令 | 说明 |
|------|------|------|
| Base64 编码 | `base64` | 编码 |
| Base64 解码 | `base64 -d` | 解码 |

---

## 🚀 下一步学习预告

**明日主题预告**：Day014 - 安全协议与加密：周综合实验与测评

**学习重点预告**：
- 复习 TLS, SSH, 证书, 加密
- 综合场景分析：如何为一个不安全的网站加固？
- 第二周总结

**今日学习为明日做铺垫**：
- 所有的知识点将在明天汇聚成一个完整的安全方案。

---

## 📖 参考资料

- 📖 官方文档：[OWASP Password Storage Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Password_Storage_Cheat_Sheet.html)
- 🎥 视频教程：B站搜索 "密码存储安全"
- 🛠️ 实践工具：CyberChef (在线加解密神器)

---

> 💬 **学习提示**：
> 1. 建议按照文档顺序学习，不要跳跃
> 2. 每个知识点理解后再进行下一步
> 3. 实践任务一定要亲手做，不要只看
> 4. 遇到问题先思考，再查阅资料，最后再问
> 5. 坚持每天完成学习任务并记录成果，90 天后你会感谢现在的自己！
>
> ```bash
> git add daily/Day013.md
> git commit -m "Day013: 完成学习与记录"
> ```
