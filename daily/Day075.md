---
title: Day075：红蓝对抗 - 从攻击者视角理解防御
tags:
  - 网络安全
  - 渗透测试
  - 红蓝对抗
categories:
  - 90天安全突击
stage: 实战演练
abbrlink: f6b06
date: 2026-01-28
updated: 2026-01-28
---

# Day075：红蓝对抗 - 从攻击者视角理解防御

## 📋 基本信息

| 项目 | 内容 |
|------|------|
| **所属阶段** | 🏆 实战演练（第三阶段） |
| **所属周次** | Week 13：红蓝对抗与防御 |
| **今日主题** | 从攻击者视角理解防御 |
| **预计时间** | 3 小时 |
| **难度等级** | ⭐⭐⭐⭐ 中高级 |

---

## 🔥 今日痛点场景

> **场景**：你花了两周学会了各种内网渗透技术，但在实战中发现防御方总能发现你的行动。你需要了解防御方是如何检测攻击的。
>
> **问题**：蓝队是怎么发现红队的？他们关注什么？
>
> **今天的任务**：换位思考，从防御者视角理解攻击检测点。

---

## 🎯 今日目标

- [ ] 理解红蓝对抗的核心逻辑
- [ ] 了解防御方的检测维度
- [ ] 学会分析自己攻击行为的暴露点
- [ ] 掌握基本的规避思路

**闯关条件**：能够分析一次攻击行为会留下哪些可检测痕迹。

---

## ⚔️ 实战任务（先动手！）

### 任务 1：理解红蓝对抗（20 分钟）

**红蓝对抗模型**：

```
┌─────────────────────────────────────────────────────────┐
│                     攻击者 (红队)                        │
│ ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐     │
│ │ 信息收集 │→ │ 初始访问 │→ │ 横向移动 │→ │ 目标达成 │     │
│ └─────────┘  └─────────┘  └─────────┘  └─────────┘     │
│      ↓            ↓            ↓            ↓          │
│ ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐     │
│ │ 边界监控 │  │ 入侵检测 │  │ 行为分析 │  │ 数据防护 │     │
│ └─────────┘  └─────────┘  └─────────┘  └─────────┘     │
│                     防御者 (蓝队)                        │
└─────────────────────────────────────────────────────────┘
```

**核心对抗点**：

| 攻击阶段 | 攻击行为 | 防御检测点 |
|----------|----------|------------|
| 信息收集 | 端口扫描 | 防火墙日志、IDS |
| 初始访问 | 漏洞利用 | WAF、入侵检测 |
| 横向移动 | PTH/Kerberos | 行为分析、SIEM |
| 权限维持 | 后门植入 | EDR、完整性检测 |

---

### 任务 2：分析攻击暴露点（40 分钟）

**场景**：分析一次典型的内网渗透会留下哪些痕迹。

**攻击行为分析表**：

| 攻击动作 | 产生的日志/痕迹 | 检测方法 |
|----------|-----------------|----------|
| Nmap 扫描 | 大量 SYN 包、防火墙日志 | 流量分析、阈值告警 |
| Web 漏洞利用 | WAF 日志、异常请求 | 特征匹配、行为分析 |
| Mimikatz | lsass 访问日志 (4656) | Sysmon、EDR |
| PTH | 登录事件 (4624 Type 3) | 异常登录检测 |
| DCSync | 复制请求日志 (4662) | AD 审计策略 |
| 持久化 | 注册表/计划任务变更 | 完整性监控 |

**实操**：查看 Windows 安全日志中的关键事件

```cmd
:: 查看登录事件
wevtutil qe Security /q:"*[System[(EventID=4624)]]" /c:10 /f:text

:: 查看进程创建事件（需要开启审计）
wevtutil qe Security /q:"*[System[(EventID=4688)]]" /c:10 /f:text

:: 查看特权使用
wevtutil qe Security /q:"*[System[(EventID=4672)]]" /c:10 /f:text
```

---

### 任务 3：蓝队检测技术概览（40 分钟）

**防御层次模型**：

```
┌────────────────────────────────────────┐
│            应用层防护                   │
│  WAF / RASP / 代码审计                 │
├────────────────────────────────────────┤
│            主机层防护                   │
│  EDR / AV / HIDS / 完整性监控          │
├────────────────────────────────────────┤
│            网络层防护                   │
│  防火墙 / IDS/IPS / 流量分析           │
├────────────────────────────────────────┤
│            日志与分析                   │
│  SIEM / 日志聚合 / 威胁狩猎            │
└────────────────────────────────────────┘
```

**主要检测技术**：

| 技术 | 工作原理 | 检测内容 |
|------|----------|----------|
| IDS/IPS | 特征匹配 + 行为分析 | 已知攻击、异常流量 |
| EDR | 端点行为监控 | 进程注入、凭据窃取 |
| SIEM | 日志关联分析 | 攻击链、异常模式 |
| UEBA | 用户行为基线 | 异常登录、权限滥用 |

---

### 任务 4：红队视角的规避思考（30 分钟）

**规避原则**：

| 原则 | 说明 | 示例 |
|------|------|------|
| 低调慢行 | 减少异常流量 | 降低扫描速度 |
| 模拟正常 | 混入正常行为 | 使用合法工具 |
| 减少落地 | 内存执行为主 | PowerShell 无文件 |
| 清理痕迹 | 删除日志记录 | 清除命令历史 |

**常见规避技术**：

```
攻击行为           →    规避思路
─────────────────────────────────
端口扫描           →    慢速扫描、分散时间
漏洞利用           →    编码绑定、加密通信
凭据获取           →    LOLBAS、内存执行
横向移动           →    使用合法管理工具
持久化             →    隐蔽位置、伪装文件名
```

---

## ✅ 今日闯关检查

| 检查项 | 状态 |
|--------|------|
| 理解红蓝对抗模型 | ⬜ |
| 能分析攻击暴露点 | ⬜ |
| 了解蓝队检测技术 | ⬜ |
| 掌握基本规避思路 | ⬜ |

---

## 📖 底层补课（做完实验再看）

### 为什么要学防御？

| 角度 | 收益 |
|------|------|
| 红队 | 了解检测点才能绑定规避 |
| 蓝队 | 了解攻击手法才能有效防御 |
| 面试 | 甲方更看重攻防结合能力 |

### ATT&CK 框架

MITRE ATT&CK 是攻防知识库：
- 记录真实攻击技术
- 映射检测策略
- 红蓝双方共同语言

**建议**：花时间浏览 https://attack.mitre.org/

---

## ⚠️ 避坑指南

| 坑点 | 症状 | 解决方案 |
|------|------|----------|
| 只会攻不懂防 | 面试被问住 | 系统学习防御知识 |
| 规避变成目的 | 过度追求隐蔽 | 平衡效率和隐蔽 |
| 忽视日志 | 不知道留了什么痕迹 | 主动分析自己的日志 |

---

## 💡 知识卡片速查

### 关键事件 ID

| 事件 ID | 含义 | 关联攻击 |
|---------|------|----------|
| 4624 | 登录成功 | 横向移动 |
| 4625 | 登录失败 | 暴力破解 |
| 4648 | 显式凭据登录 | PTH |
| 4662 | 对象操作 | DCSync |
| 4688 | 进程创建 | 恶意执行 |
| 4697 | 服务安装 | 持久化 |

---

## 🚀 明日预告

**Day 076：红蓝对抗 - 日志分析基础**

明天你将：
- 学习 Windows/Linux 日志结构
- 使用工具分析日志
- 从日志中发现攻击痕迹

---

## 📊 学习记录（学习者填写）

| 项目 | 内容 |
|------|------|
| 实际学习日期 | ____年__月__日 |
| 实际用时 | ____ 小时 |
| 遇到的问题 | |
| 解决方法 | |
| 今日收获 | |
| 自评分数 | ⭐⭐⭐⭐⭐ (1-5星) |

---

> 💬 **导师点评**：
>
> 真正的高手一定是攻防兼备的。
>
> 你学了两周的内网渗透，现在要站在防御者角度重新审视这些技术。
>
> 知道蓝队怎么抓你，你才能更隐蔽；知道红队怎么打，你才能更好地防。
>
> 这周的内容可能没有之前那么「刺激」，但对职业发展非常重要。

```bash
echo "Day 075 Complete! 红蓝对抗开始！"
```
