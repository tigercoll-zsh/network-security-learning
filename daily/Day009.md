---
title: Day009：侦察 - WHOIS 与 DNS 信息收集
tags:
  - 网络安全
  - WHOIS
  - DNS
categories:
  - 90天安全突击
stage: 筑基
abbrlink: d009
date: 2026-01-31
updated: 2026-01-28
---

# Day009：侦察 - WHOIS 与 DNS 信息收集

## 基本信息

| 项目 | 内容 |
|------|------|
| **所属阶段** | 筑基（第一阶段） |
| **所属周次** | Week 2：侦察——信息收集 |
| **今日主题** | 查询域名注册信息和 DNS 记录 |
| **预计时间** | 2 小时 |
| **难度等级** | 入门 |

---

## 今日痛点场景

> **场景**：你知道目标域名是 example.com，但不知道这个域名属于谁、服务器在哪、有哪些子域名。
>
> **问题**：怎么从一个域名挖出更多信息？
>
> **今天的任务**：通过 WHOIS 和 DNS 查询，找到域名注册人信息、邮箱服务器、子域名列表。

---

## 今日目标

- [ ] 使用 WHOIS 查询域名注册信息
- [ ] 使用 nslookup/dig 查询 DNS 记录
- [ ] 枚举子域名
- [ ] 了解 DNS 记录类型（A、CNAME、MX、TXT）

**闯关条件**：找到一个目标域名的 MX 记录和至少 3 个子域名。

---

## 实战任务（先动手！）

### 任务 1：WHOIS 查询（15 分钟）

**命令行方式**：
```bash
whois example.com
```

**在线方式**：
- https://whois.domaintools.com/
- https://who.is/

**关注信息**：
- Registrar（注册商）
- Creation Date（注册时间）
- Registrant Email（注册人邮箱）
- Name Server（DNS 服务器）

---

### 任务 2：DNS 记录查询（20 分钟）

**使用 nslookup（Windows/Linux）**：
```bash
nslookup example.com
nslookup -type=MX example.com
nslookup -type=TXT example.com
nslookup -type=NS example.com
```

**使用 dig（Linux/Mac，更强大）**：
```bash
dig example.com A
dig example.com MX
dig example.com TXT
dig example.com ANY
```

**在线工具**：
- https://mxtoolbox.com/
- https://dnschecker.org/

---

### 任务 3：子域名枚举（30 分钟）

**方法 1：DNS 暴力枚举**

使用 `dnsrecon`（Kali 自带）：
```bash
dnsrecon -d example.com -t brt
```

使用 `sublist3r`：
```bash
sublist3r -d example.com
```

**方法 2：在线子域名查询**
- https://crt.sh/ （证书透明度日志）
- https://dnsdumpster.com/
- https://securitytrails.com/

**方法 3：搜索引擎**
```
site:*.example.com
```

---

### 任务 4：实战练习（15 分钟）

选择一个你感兴趣的网站（如 github.com），完成以下信息收集：

1. WHOIS 注册信息
2. A 记录（IP 地址）
3. MX 记录（邮件服务器）
4. NS 记录（DNS 服务器）
5. 至少 5 个子域名

---

## 今日闯关检查

| 检查项 | 状态 |
|--------|------|
| 成功查询 WHOIS 信息 | |
| 找到目标的 A 记录 | |
| 找到目标的 MX 记录 | |
| 枚举出至少 3 个子域名 | |
| 了解常见 DNS 记录类型 | |

---

## 底层补课

### 什么是 WHOIS？

**定义**：查询域名注册信息的协议。

**能查到什么**：
- 域名所有者
- 注册商
- 注册/过期时间
- DNS 服务器

**注意**：很多域名开启了隐私保护，查不到真实信息。

### DNS 记录类型

| 记录类型 | 作用 | 示例 |
|----------|------|------|
| A | 域名 -> IPv4 | www.example.com -> 93.184.216.34 |
| AAAA | 域名 -> IPv6 | www.example.com -> 2606:2800:... |
| CNAME | 别名 | cdn.example.com -> example.cdn.net |
| MX | 邮件服务器 | example.com -> mail.example.com |
| NS | DNS 服务器 | example.com -> ns1.example.com |
| TXT | 文本记录 | 用于 SPF、DKIM 验证 |
| SOA | 授权起始 | DNS 区域信息 |

### 子域名为什么重要？

1. **攻击面扩大**：主站防护强，子站可能有漏洞
2. **内部系统暴露**：dev.example.com、test.example.com
3. **老旧系统**：old.example.com 可能没维护

---

## 避坑指南

| 坑点 | 症状 | 解决方案 |
|------|------|----------|
| WHOIS 查不到 | 隐私保护 | 尝试历史 WHOIS 记录 |
| dig 命令不存在 | Windows 没有 | 用 nslookup 或装 dig |
| 子域名太少 | 只找到几个 | 多用几个工具交叉验证 |

---

## 知识卡片速查

### DNS 查询速查

```bash
# 查 A 记录
dig example.com A +short

# 查 MX 记录
dig example.com MX +short

# 查所有记录
dig example.com ANY

# 查 NS 记录
dig example.com NS +short

# 反向 DNS
dig -x 8.8.8.8
```

### 子域名枚举工具

| 工具 | 特点 |
|------|------|
| sublist3r | 聚合多个数据源 |
| amass | 最强大，功能最全 |
| dnsrecon | Kali 自带 |
| crt.sh | 证书透明度查询 |

---

## 常见问题

**Q1：WHOIS 隐私保护怎么绕过？**

A1：很难绕过，但可以：
- 查历史 WHOIS（whoishistory.com）
- 查关联域名
- 通过证书信息推断

**Q2：DNS 记录会变吗？**

A2：会。DNS 有缓存时间（TTL），过期后会更新。可以通过 `dig +trace` 追踪完整解析过程。

**Q3：怎么知道目标有多少子域名？**

A3：没有确定的方法，只能尽可能多地收集。使用多个工具、查证书日志、爆破常见子域名。

---

## 明日预告

**Day 010：Nmap 主机发现**

明天你将：
- 学习 Nmap 基础用法
- 发现网络中的存活主机
- 了解 ICMP、ARP 扫描原理

---

## 学习记录

| 项目 | 内容 |
|------|------|
| 实际学习日期 | |
| 今日收获 | |

---

> **导师点评**：
>
> 今天你学会了从一个域名挖出一堆信息。
>
> WHOIS 告诉你"谁在背后"，DNS 告诉你"东西在哪"，子域名告诉你"还有多少攻击面"。
>
> 记住：**好的渗透测试，80% 是信息收集**。

```bash
echo "Day 009 Complete! 我会挖 DNS 信息了！"
```
