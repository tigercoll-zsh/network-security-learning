# Day020：操作系统与脚本 - 服务枚举与指纹识别（傻瓜版能照做）

- 日期：2026-01-13
- 周次：第 3 周

## 学习目标

学完今天你应该能做到：

- 能解释“枚举”在做什么：**确认服务是什么+版本是什么+响应特征是什么**
- 知道 Banner 不可靠，并能用“两种方法交叉验证”
- 用最小脚本把扫描结果整理成“服务矩阵”（host×port×service×version）

## 学习内容

### 1️⃣ Banner 为什么不可靠（你必须牢记）

- 服务可以伪装 Banner（故意写个假的）
- 反向代理/负载均衡会改变响应
- 安全加固会隐藏版本

因此：**Banner 只能当线索，必须验证。**

### 2️⃣ 两种交叉验证思路（够用版）

- 方法 A：`nmap -sV` 的探测结果
- 方法 B：自己用客户端握手验证
  - HTTP：`curl.exe -I http://host:port/`
  - TLS：`curl.exe -Iv https://host:port/`
  - SSH：`ssh -vvv`（只在授权环境，且注意日志脱敏）

## 实践任务（合法授权范围内）

> 今天我们只做“最小可复现”：对一个你有权限的目标。

### 任务 1（必做）：基于 Day019 结果做 1 次交叉验证

如果你在 `day019_nmap.txt` 里发现了 HTTP（80/8080）之类端口：

```powershell
curl.exe -I --silent --show-error http://<target>:<port>/
```

如果是 HTTPS（443）：

```powershell
curl.exe -Iv --silent --show-error https://<target>:<port>/
```

你要记录 2 件事：

- 响应头里有没有 `Server:`（很多情况下会被隐藏）
- TLS 证书/握手是否正常

### 任务 2（可选加分）：写一个最小 Python 脚本抓取 HTTP Banner

新建：`scripts/day020_probe_http.py`

- 输入：host、port
- 输出：状态码、Server 头、首行响应（如有）

（本周提交我会把脚本加上。）

## 巩固练习（题与复盘）

### 题 1：为什么 Banner 可能不可靠？

**思路**：伪装/代理/隐藏三种原因。

### 题 2：用两种方法交叉验证版本信息

**思路**：一条写 nmap，一条写 curl/自写脚本。

## 评估标准（达成判定）

- 你能写出至少 1 个端口的交叉验证证据（nmap + curl）
- 你能输出 1 行“服务矩阵”记录（host/port/service/version/证据）

## 学习成果达成情况（由学习者填写）

### 截图与证据

- [ ] nmap 的某端口行截图
- [ ] curl 验证输出截图

### 关键记录

- Host/Port：
- nmap 识别：
- curl/脚本证据：
- 结论：

### 结论与反思

- 我以前太相信 Banner；现在知道必须交叉验证。

## 集中参考答案（含思路）

### 题 1 参考答案

- Banner 可能被伪造、可能经过代理/负载均衡被改写，也可能因为加固隐藏版本信息。

### 题 2 参考答案（示例）

- 方法 1：`nmap -sV` 看服务识别。
- 方法 2：对 HTTP 用 `curl -I` 看响应头，对 TLS 用 `curl -Iv` 看握手/证书，或用自写脚本发协议请求验证。

## 学习成果示例填写（可照抄）

- 我用 `nmap -sV` 识别到 80/tcp 可能是 nginx，但 `curl -I` 看不到 `Server:`，说明目标可能隐藏了 Banner；因此版本信息只能当线索。
